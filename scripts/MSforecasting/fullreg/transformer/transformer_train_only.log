python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆè’¸å‘å™¨æ±½æ¸© --target_cols 1æ•ˆè’¸å‘å™¨æ±½æ¸© --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆè’¸å‘å™¨æ±½æ¸©', target_cols='1æ•ˆè’¸å‘å™¨æ±½æ¸©', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-06 21:02:18.755007: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-06 21:02:18.755081: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-06 21:02:18.756738: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-06 21:02:18.768383: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-06 21:02:20.041422: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0206
	speed: 0.162712s/iter; left time: 15485.150664s
	iters: 764, epoch: 1 | train_loss : 0.0099
	speed: 0.180519s/iter; left time: 17110.891584s
	iters: 1146, epoch: 1 | train_loss : 0.0195
	speed: 0.196125s/iter; left time: 18515.224692s
	iters: 1528, epoch: 1 | train_loss : 0.0028
	speed: 0.160473s/iter; left time: 15088.176793s
	iters: 1910, epoch: 1 | train_loss : 0.0027
	speed: 0.133002s/iter; left time: 12454.461587s
data: {'predict': array([164.65754574, 164.69942037, 164.72856564, ..., 147.87524177,
       147.98235972, 148.0717516 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:24:38] [32mIntermediate result: 0.038850829005241394  (Index 0)[0m
Epoch: 1 | cost time: 1331.993542432785 | valid_loss: 0.038850829005241394 | valid_loss_true: 2.3348967894548407
Pretest loss in this epoch: 5.7353421876514
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0024
	speed: 2.815241s/iter; left time: 262543.747778s
	iters: 764, epoch: 2 | train_loss : 0.0047
	speed: 0.143934s/iter; left time: 13368.019248s
	iters: 1146, epoch: 2 | train_loss : 0.0025
	speed: 0.134731s/iter; left time: 12461.797569s
	iters: 1528, epoch: 2 | train_loss : 0.0024
	speed: 0.128314s/iter; left time: 11819.290744s
	iters: 1910, epoch: 2 | train_loss : 0.0019
	speed: 0.152001s/iter; left time: 13943.060222s
data: {'predict': array([163.9083632 , 163.96542677, 164.00637061, ..., 148.38960931,
       148.51992811, 148.59975251]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 21:51:53] [32mIntermediate result: 0.03025122918188572  (Index 1)[0m
Epoch: 2 | cost time: 1635.066336631775 | valid_loss: 0.03025122918188572 | valid_loss_true: 1.899513183159361
Pretest loss in this epoch: 4.241354227818551
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0019
	speed: 3.688224s/iter; left time: 336908.183745s
	iters: 764, epoch: 3 | train_loss : 0.0016
	speed: 0.122900s/iter; left time: 11179.609950s
	iters: 1146, epoch: 3 | train_loss : 0.0024
	speed: 0.091658s/iter; left time: 8302.684423s
	iters: 1528, epoch: 3 | train_loss : 0.0016
	speed: 0.115743s/iter; left time: 10440.134723s
	iters: 1910, epoch: 3 | train_loss : 0.0013
	speed: 0.179358s/iter; left time: 16109.719755s
data: {'predict': array([163.14982191, 163.18472967, 163.20802501, ..., 148.24706744,
       148.37622415, 148.44265494]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 22:28:59] [32mIntermediate result: 0.02526574209332466  (Index 2)[0m
Epoch: 3 | cost time: 2225.8600244522095 | valid_loss: 0.02526574209332466 | valid_loss_true: 1.6052565026245802
Pretest loss in this epoch: 3.9920653765386254
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0009
	speed: 5.372890s/iter; left time: 480529.792826s
	iters: 764, epoch: 4 | train_loss : 0.0061
	speed: 0.139179s/iter; left time: 12394.478186s
	iters: 1146, epoch: 4 | train_loss : 0.0012
	speed: 0.142120s/iter; left time: 12602.108246s
	iters: 1528, epoch: 4 | train_loss : 0.0016
	speed: 0.123655s/iter; left time: 10917.496228s
	iters: 1910, epoch: 4 | train_loss : 0.0052
	speed: 0.167964s/iter; left time: 14765.364803s
data: {'predict': array([162.87991018, 162.89377062, 162.89847256, ..., 148.95686593,
       149.08101466, 149.13919801]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 23:10:10] [32mIntermediate result: 0.024631306529045105  (Index 3)[0m
Epoch: 4 | cost time: 2470.8883802890778 | valid_loss: 0.024631306529045105 | valid_loss_true: 1.5411169497351709
Pretest loss in this epoch: 3.9438100709621975
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0011
	speed: 5.912157s/iter; left time: 517461.566940s
	iters: 764, epoch: 5 | train_loss : 0.0024
	speed: 0.162813s/iter; left time: 14188.018102s
	iters: 1146, epoch: 5 | train_loss : 0.0012
	speed: 0.153138s/iter; left time: 13286.392777s
	iters: 1528, epoch: 5 | train_loss : 0.0020
	speed: 0.134020s/iter; left time: 11576.535488s
	iters: 1910, epoch: 5 | train_loss : 0.0111
	speed: 0.141849s/iter; left time: 12198.611139s
data: {'predict': array([162.88889944, 162.88621987, 162.87279381, ..., 148.87248343,
       148.98907014, 149.0416419 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 23:42:41] [32mIntermediate result: 0.02500602789223194  (Index 4)[0m
Epoch: 5 | cost time: 1950.4729738235474 | valid_loss: 0.02500602789223194 | valid_loss_true: 1.5188195051421418
Pretest loss in this epoch: 4.025794546647054
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0010
	speed: 4.462990s/iter; left time: 382094.397752s
	iters: 764, epoch: 6 | train_loss : 0.0012
	speed: 0.149020s/iter; left time: 12701.274792s
	iters: 1146, epoch: 6 | train_loss : 0.0013
	speed: 0.100231s/iter; left time: 8504.580884s
	iters: 1528, epoch: 6 | train_loss : 0.0010
	speed: 0.102167s/iter; left time: 8629.824786s
	iters: 1910, epoch: 6 | train_loss : 0.0099
	speed: 0.086343s/iter; left time: 7260.223072s
data: {'predict': array([164.01570116, 164.02162724, 164.01271978, ..., 148.96271727,
       149.09770275, 149.1582695 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-06 23:59:33] [32mIntermediate result: 0.03196082264184952  (Index 5)[0m
Epoch: 6 | cost time: 1012.4371337890625 | valid_loss: 0.03196082264184952 | valid_loss_true: 1.872597291758955
Pretest loss in this epoch: 4.373704078439398
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0086
	speed: 2.231215s/iter; left time: 186759.387120s
	iters: 764, epoch: 7 | train_loss : 0.0010
	speed: 0.158848s/iter; left time: 13235.360672s
	iters: 1146, epoch: 7 | train_loss : 0.0065
	speed: 0.161014s/iter; left time: 13354.314432s
	iters: 1528, epoch: 7 | train_loss : 0.0015
	speed: 0.146765s/iter; left time: 12116.443781s
	iters: 1910, epoch: 7 | train_loss : 0.0009
	speed: 0.147167s/iter; left time: 12093.409439s
data: {'predict': array([163.44758989, 163.44435185, 163.42466969, ..., 149.30281118,
       149.42577808, 149.47861921]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 00:28:54] [32mIntermediate result: 0.027675071731209755  (Index 6)[0m
Epoch: 7 | cost time: 1761.3707056045532 | valid_loss: 0.027675071731209755 | valid_loss_true: 1.6568390035392973
Pretest loss in this epoch: 3.926065848929085
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0006
	speed: 3.949288s/iter; left time: 323020.146789s
	iters: 764, epoch: 8 | train_loss : 0.0008
	speed: 0.099217s/iter; left time: 8077.224553s
	iters: 1146, epoch: 8 | train_loss : 0.0009
	speed: 0.104533s/iter; left time: 8470.111213s
	iters: 1528, epoch: 8 | train_loss : 0.0007
	speed: 0.113437s/iter; left time: 9148.261019s
	iters: 1910, epoch: 8 | train_loss : 0.0031
	speed: 0.114871s/iter; left time: 9220.007657s
data: {'predict': array([163.32476966, 163.32370348, 163.3041962 , ..., 148.83873213,
       148.96726407, 149.02241528]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 00:57:24] [32mIntermediate result: 0.02573585882782936  (Index 7)[0m
Epoch: 8 | cost time: 1709.9363660812378 | valid_loss: 0.02573585882782936 | valid_loss_true: 1.5878215688657396
Pretest loss in this epoch: 3.882961151630307
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0010
	speed: 4.104069s/iter; left time: 327837.161027s
	iters: 764, epoch: 9 | train_loss : 0.0020
	speed: 0.154565s/iter; left time: 12287.754433s
	iters: 1146, epoch: 9 | train_loss : 0.0010
	speed: 0.134825s/iter; left time: 10666.924684s
	iters: 1528, epoch: 9 | train_loss : 0.0009
	speed: 0.106720s/iter; left time: 8402.580382s
	iters: 1910, epoch: 9 | train_loss : 0.0009
	speed: 0.110505s/iter; left time: 8658.416444s
data: {'predict': array([162.98122898, 162.98158719, 162.96082193, ..., 148.38535867,
       148.50971612, 148.56430744]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:14:40] [32mIntermediate result: 0.02458949200809002  (Index 8)[0m
Epoch: 9 | cost time: 1035.74578499794 | valid_loss: 0.02458949200809002 | valid_loss_true: 1.5209716917302247
Pretest loss in this epoch: 3.852365843510174
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0021
	speed: 2.159847s/iter; left time: 168403.304061s
	iters: 764, epoch: 10 | train_loss : 0.0010
	speed: 0.121961s/iter; left time: 9462.745957s
	iters: 1146, epoch: 10 | train_loss : 0.0045
	speed: 0.112520s/iter; left time: 8687.242207s
	iters: 1528, epoch: 10 | train_loss : 0.0010
	speed: 0.084625s/iter; left time: 6501.207801s
	iters: 1910, epoch: 10 | train_loss : 0.0026
	speed: 0.087694s/iter; left time: 6703.513017s
data: {'predict': array([163.01545414, 163.01659367, 162.99809053, ..., 148.8284736 ,
       148.95036586, 149.00196592]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:29:54] [32mIntermediate result: 0.024316158145666122  (Index 9)[0m
Epoch: 10 | cost time: 913.5709631443024 | valid_loss: 0.024316158145666122 | valid_loss_true: 1.5159595170176028
Pretest loss in this epoch: 4.4368448047251245
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0009
	speed: 1.975047s/iter; left time: 150220.108302s
	iters: 764, epoch: 11 | train_loss : 0.0016
	speed: 0.122577s/iter; left time: 9276.276541s
	iters: 1146, epoch: 11 | train_loss : 0.0007
	speed: 0.083237s/iter; left time: 6267.319917s
	iters: 1528, epoch: 11 | train_loss : 0.0010
	speed: 0.078061s/iter; left time: 5847.791891s
	iters: 1910, epoch: 11 | train_loss : 0.0009
	speed: 0.095488s/iter; left time: 7116.852898s
data: {'predict': array([162.93127896, 162.92904223, 162.90601484, ..., 148.47656278,
       148.60141949, 148.65443268]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:43:24] [32mIntermediate result: 0.024295365437865257  (Index 10)[0m
Epoch: 11 | cost time: 809.8659069538116 | valid_loss: 0.024295365437865257 | valid_loss_true: 1.5080441569492344
Pretest loss in this epoch: 3.8138993789721587
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0027
	speed: 1.741766s/iter; left time: 129148.502181s
	iters: 764, epoch: 12 | train_loss : 0.0011
	speed: 0.118461s/iter; left time: 8738.430708s
	iters: 1146, epoch: 12 | train_loss : 0.0011
	speed: 0.120456s/iter; left time: 8839.532407s
	iters: 1528, epoch: 12 | train_loss : 0.0031
	speed: 0.084231s/iter; left time: 6149.032076s
	iters: 1910, epoch: 12 | train_loss : 0.0013
	speed: 0.084490s/iter; left time: 6135.675286s
data: {'predict': array([163.17007947, 163.16998921, 163.14790955, ..., 148.8874298 ,
       149.01300152, 149.06460723]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 01:59:31] [32mIntermediate result: 0.02516300417482853  (Index 11)[0m
Epoch: 12 | cost time: 967.4952168464661 | valid_loss: 0.02516300417482853 | valid_loss_true: 1.5434578876213827
Pretest loss in this epoch: 3.890925059434413
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0011
	speed: 2.124981s/iter; left time: 153502.285060s
	iters: 764, epoch: 13 | train_loss : 0.0011
	speed: 0.090246s/iter; left time: 6484.634911s
	iters: 1146, epoch: 13 | train_loss : 0.0011
	speed: 0.094176s/iter; left time: 6731.028959s
	iters: 1528, epoch: 13 | train_loss : 0.0009
	speed: 0.097635s/iter; left time: 6940.936963s
	iters: 1910, epoch: 13 | train_loss : 0.0011
	speed: 0.097697s/iter; left time: 6908.041964s
data: {'predict': array([163.07880483, 163.07896561, 163.05641773, ..., 148.69445841,
       148.81450317, 148.86343495]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:11:48] [32mIntermediate result: 0.024668842554092407  (Index 12)[0m
Epoch: 13 | cost time: 736.88889503479 | valid_loss: 0.024668842554092407 | valid_loss_true: 1.5236358980419005
Pretest loss in this epoch: 3.8450443477219642
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0028
	speed: 1.552279s/iter; left time: 109165.583656s
	iters: 764, epoch: 14 | train_loss : 0.0016
	speed: 0.121854s/iter; left time: 8522.977877s
	iters: 1146, epoch: 14 | train_loss : 0.0008
	speed: 0.113019s/iter; left time: 7861.828819s
	iters: 1528, epoch: 14 | train_loss : 0.0013
	speed: 0.089676s/iter; left time: 6203.783353s
	iters: 1910, epoch: 14 | train_loss : 0.0041
	speed: 0.096432s/iter; left time: 6634.311255s
data: {'predict': array([163.04045031, 163.04352476, 163.02396672, ..., 148.72705891,
       148.84863808, 148.89530632]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:24:29] [32mIntermediate result: 0.02440861612558365  (Index 13)[0m
Epoch: 14 | cost time: 760.9326875209808 | valid_loss: 0.02440861612558365 | valid_loss_true: 1.5180437054609273
Pretest loss in this epoch: 3.9975335060170036
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0010
	speed: 1.565363s/iter; left time: 107094.303937s
	iters: 764, epoch: 15 | train_loss : 0.0010
	speed: 0.119769s/iter; left time: 8148.231656s
	iters: 1146, epoch: 15 | train_loss : 0.0009
	speed: 0.118079s/iter; left time: 7988.170206s
	iters: 1528, epoch: 15 | train_loss : 0.0030
	speed: 0.082543s/iter; left time: 5552.600173s
	iters: 1910, epoch: 15 | train_loss : 0.0008
	speed: 0.089505s/iter; left time: 5986.747670s
data: {'predict': array([163.33964833, 163.34148736, 163.32008183, ..., 148.9468937 ,
       149.06772399, 149.11489149]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:35:36] [32mIntermediate result: 0.02589915320277214  (Index 14)[0m
Epoch: 15 | cost time: 667.6059949398041 | valid_loss: 0.02589915320277214 | valid_loss_true: 1.5850229928221002
Pretest loss in this epoch: 4.0061142806295384
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0009
	speed: 1.354184s/iter; left time: 90058.649600s
	iters: 764, epoch: 16 | train_loss : 0.0035
	speed: 0.125685s/iter; left time: 8310.532323s
	iters: 1146, epoch: 16 | train_loss : 0.0010
	speed: 0.123610s/iter; left time: 8126.140542s
	iters: 1528, epoch: 16 | train_loss : 0.0008
	speed: 0.116619s/iter; left time: 7621.974666s
	iters: 1910, epoch: 16 | train_loss : 0.0008
	speed: 0.113755s/iter; left time: 7391.339378s
data: {'predict': array([163.21412879, 163.21632603, 163.19500511, ..., 148.64237743,
       148.76373659, 148.80994931]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:45:31] [32mIntermediate result: 0.025175945833325386  (Index 15)[0m
Epoch: 16 | cost time: 594.5555274486542 | valid_loss: 0.025175945833325386 | valid_loss_true: 1.5476617581160896
Pretest loss in this epoch: 3.926734542268665
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0009
	speed: 1.055815s/iter; left time: 68198.248390s
	iters: 764, epoch: 17 | train_loss : 0.0009
	speed: 0.111019s/iter; left time: 7128.642473s
	iters: 1146, epoch: 17 | train_loss : 0.0007
	speed: 0.108404s/iter; left time: 6919.335792s
	iters: 1528, epoch: 17 | train_loss : 0.0010
	speed: 0.119442s/iter; left time: 7578.247571s
	iters: 1910, epoch: 17 | train_loss : 0.0008
	speed: 0.131967s/iter; left time: 8322.492420s
data: {'predict': array([163.11150406, 163.11460954, 163.09391197, ..., 149.18850775,
       149.3048547 , 149.34864735]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 02:57:11] [32mIntermediate result: 0.025060540065169334  (Index 16)[0m
Epoch: 17 | cost time: 699.5730226039886 | valid_loss: 0.025060540065169334 | valid_loss_true: 1.5369973289992573
Pretest loss in this epoch: 4.005491427241119
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0007
	speed: 1.361655s/iter; left time: 85351.254093s
	iters: 764, epoch: 18 | train_loss : 0.0006
	speed: 0.119544s/iter; left time: 7447.601459s
	iters: 1146, epoch: 18 | train_loss : 0.0008
	speed: 0.116942s/iter; left time: 7240.807724s
	iters: 1528, epoch: 18 | train_loss : 0.0014
	speed: 0.116294s/iter; left time: 7156.290331s
	iters: 1910, epoch: 18 | train_loss : 0.0020
	speed: 0.117267s/iter; left time: 7171.366927s
data: {'predict': array([163.42004109, 163.42509278, 163.40635271, ..., 149.16045829,
       149.28111794, 149.32520393]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 03:08:04] [32mIntermediate result: 0.026611927896738052  (Index 17)[0m
Epoch: 18 | cost time: 653.3611662387848 | valid_loss: 0.026611927896738052 | valid_loss_true: 1.614906766033443
Pretest loss in this epoch: 3.948299283024585
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0014
	speed: 1.213772s/iter; left time: 73762.151818s
	iters: 764, epoch: 19 | train_loss : 0.0009
	speed: 0.135650s/iter; left time: 8191.738905s
	iters: 1146, epoch: 19 | train_loss : 0.0011
	speed: 0.134341s/iter; left time: 8061.378194s
	iters: 1528, epoch: 19 | train_loss : 0.0009
	speed: 0.142532s/iter; left time: 8498.474764s
	iters: 1910, epoch: 19 | train_loss : 0.0008
	speed: 0.127819s/iter; left time: 7572.380765s
data: {'predict': array([163.2551657 , 163.25772399, 163.23678103, ..., 148.81345673,
       148.93376662, 148.9783716 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-07 03:20:58] [32mIntermediate result: 0.02520102821290493  (Index 18)[0m
Epoch: 19 | cost time: 773.822760105133 | valid_loss: 0.02520102821290493 | valid_loss_true: 1.555507665745367
Pretest loss in this epoch: 4.028367366106234
Early stop with best valid_loss: 0.02520102821290493
[2024-03-07 03:20:58] [32mFinal result: 0.024295365437865257[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ› --target_cols 1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ› --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ›', target_cols='1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ›', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 03:21:04.059456: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 03:21:04.059529: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 03:21:04.061414: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 03:21:04.073825: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 03:21:05.179113: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0713
	speed: 0.124280s/iter; left time: 11827.580414s
	iters: 764, epoch: 1 | train_loss : 0.0117
	speed: 0.128565s/iter; left time: 12186.285803s
	iters: 1146, epoch: 1 | train_loss : 0.0096
	speed: 0.134776s/iter; left time: 12723.519555s
	iters: 1528, epoch: 1 | train_loss : 0.0086
	speed: 0.137009s/iter; left time: 12881.951109s
	iters: 1910, epoch: 1 | train_loss : 0.0061
	speed: 0.133517s/iter; left time: 12502.624843s
data: {'predict': array([0.55166511, 0.55216247, 0.55078777, ..., 0.33314537, 0.33363225,
       0.33415483]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:32:55] [32mIntermediate result: 0.09755130112171173  (Index 0)[0m
Epoch: 1 | cost time: 704.0651462078094 | valid_loss: 0.09755130112171173 | valid_loss_true: 0.02485473700760788
Pretest loss in this epoch: 0.03307944737194797
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0069
	speed: 1.307156s/iter; left time: 121902.797538s
	iters: 764, epoch: 2 | train_loss : 0.0082
	speed: 0.114259s/iter; left time: 10611.899080s
	iters: 1146, epoch: 2 | train_loss : 0.0118
	speed: 0.117257s/iter; left time: 10845.570195s
	iters: 1528, epoch: 2 | train_loss : 0.0099
	speed: 0.131266s/iter; left time: 12091.136229s
	iters: 1910, epoch: 2 | train_loss : 0.0070
	speed: 0.137309s/iter; left time: 12595.388589s
data: {'predict': array([0.55512516, 0.55480517, 0.55199717, ..., 0.34057766, 0.34127683,
       0.34211595]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:42:28] [32mIntermediate result: 0.08950461447238922  (Index 1)[0m
Epoch: 2 | cost time: 572.1308681964874 | valid_loss: 0.08950461447238922 | valid_loss_true: 0.023490997575386054
Pretest loss in this epoch: 0.03213749675286165
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0082
	speed: 0.981345s/iter; left time: 89642.932896s
	iters: 764, epoch: 3 | train_loss : 0.0093
	speed: 0.131382s/iter; left time: 11951.127670s
	iters: 1146, epoch: 3 | train_loss : 0.0070
	speed: 0.131002s/iter; left time: 11866.517066s
	iters: 1528, epoch: 3 | train_loss : 0.0115
	speed: 0.119867s/iter; left time: 10812.081069s
	iters: 1910, epoch: 3 | train_loss : 0.0060
	speed: 0.112544s/iter; left time: 10108.629099s
data: {'predict': array([0.55133665, 0.55081945, 0.54755863, ..., 0.34236591, 0.34301497,
       0.34382304]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 03:54:10] [32mIntermediate result: 0.09153502434492111  (Index 2)[0m
Epoch: 3 | cost time: 702.7744796276093 | valid_loss: 0.09153502434492111 | valid_loss_true: 0.023787454261929155
Pretest loss in this epoch: 0.030207623239020306
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0044
	speed: 1.323516s/iter; left time: 118369.999248s
	iters: 764, epoch: 4 | train_loss : 0.0058
	speed: 0.104654s/iter; left time: 9319.877720s
	iters: 1146, epoch: 4 | train_loss : 0.0063
	speed: 0.134026s/iter; left time: 11884.326134s
	iters: 1528, epoch: 4 | train_loss : 0.0049
	speed: 0.136911s/iter; left time: 12087.890287s
	iters: 1910, epoch: 4 | train_loss : 0.0132
	speed: 0.132725s/iter; left time: 11667.608427s
data: {'predict': array([0.56622098, 0.56615194, 0.56289773, ..., 0.34384876, 0.34444092,
       0.34524407]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:06:54] [32mIntermediate result: 0.09835042804479599  (Index 3)[0m
Epoch: 4 | cost time: 763.4253904819489 | valid_loss: 0.09835042804479599 | valid_loss_true: 0.02508708913732033
Pretest loss in this epoch: 0.03333923407798152
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0071
	speed: 1.488961s/iter; left time: 130321.343381s
	iters: 764, epoch: 5 | train_loss : 0.0096
	speed: 0.112300s/iter; left time: 9786.158597s
	iters: 1146, epoch: 5 | train_loss : 0.0061
	speed: 0.119098s/iter; left time: 10333.031676s
	iters: 1528, epoch: 5 | train_loss : 0.0093
	speed: 0.128128s/iter; left time: 11067.610883s
	iters: 1910, epoch: 5 | train_loss : 0.0272
	speed: 0.122348s/iter; left time: 10521.573644s
data: {'predict': array([0.55023461, 0.55030186, 0.54712604, ..., 0.34173218, 0.34224313,
       0.34302371]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:19:43] [32mIntermediate result: 0.09028658270835876  (Index 4)[0m
Epoch: 5 | cost time: 769.5209097862244 | valid_loss: 0.09028658270835876 | valid_loss_true: 0.023728772628922184
Pretest loss in this epoch: 0.029402588647889635
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0048
	speed: 1.553149s/iter; left time: 132971.329041s
	iters: 764, epoch: 6 | train_loss : 0.0062
	speed: 0.109632s/iter; left time: 9344.186297s
	iters: 1146, epoch: 6 | train_loss : 0.0045
	speed: 0.113834s/iter; left time: 9658.833468s
	iters: 1528, epoch: 6 | train_loss : 0.0039
	speed: 0.127602s/iter; left time: 10778.296587s
	iters: 1910, epoch: 6 | train_loss : 0.0071
	speed: 0.132411s/iter; left time: 11133.926985s
data: {'predict': array([0.55821233, 0.55827773, 0.55470856, ..., 0.33952288, 0.33997125,
       0.34074687]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:31:21] [32mIntermediate result: 0.0907215029001236  (Index 5)[0m
Epoch: 6 | cost time: 697.4275043010712 | valid_loss: 0.0907215029001236 | valid_loss_true: 0.023985779995760365
Pretest loss in this epoch: 0.03115217601857
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0179
	speed: 1.349320s/iter; left time: 112942.125461s
	iters: 764, epoch: 7 | train_loss : 0.0068
	speed: 0.121375s/iter; left time: 10113.102260s
	iters: 1146, epoch: 7 | train_loss : 0.0067
	speed: 0.111662s/iter; left time: 9261.172428s
	iters: 1528, epoch: 7 | train_loss : 0.0079
	speed: 0.115816s/iter; left time: 9561.425603s
	iters: 1910, epoch: 7 | train_loss : 0.0083
	speed: 0.115706s/iter; left time: 9508.136090s
data: {'predict': array([0.56113425, 0.56129052, 0.55793546, ..., 0.34464361, 0.34504288,
       0.34572793]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:42:18] [32mIntermediate result: 0.09307216107845306  (Index 6)[0m
Epoch: 7 | cost time: 657.5202708244324 | valid_loss: 0.09307216107845306 | valid_loss_true: 0.024335199338432235
Pretest loss in this epoch: 0.03095259652553268
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0058
	speed: 1.235823s/iter; left time: 101080.461130s
	iters: 764, epoch: 8 | train_loss : 0.0046
	speed: 0.097075s/iter; left time: 7902.877974s
	iters: 1146, epoch: 8 | train_loss : 0.0050
	speed: 0.127766s/iter; left time: 10352.616219s
	iters: 1528, epoch: 8 | train_loss : 0.0035
	speed: 0.127363s/iter; left time: 10271.338916s
	iters: 1910, epoch: 8 | train_loss : 0.0088
	speed: 0.117551s/iter; left time: 9435.132727s
data: {'predict': array([0.55572895, 0.55587749, 0.55225105, ..., 0.3437256 , 0.34410504,
       0.34487783]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 04:54:03] [32mIntermediate result: 0.08948230743408203  (Index 7)[0m
Epoch: 8 | cost time: 704.682297706604 | valid_loss: 0.08948230743408203 | valid_loss_true: 0.023667223108622692
Pretest loss in this epoch: 0.029705774398703012
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0060
	speed: 1.370871s/iter; left time: 109506.561080s
	iters: 764, epoch: 9 | train_loss : 0.0042
	speed: 0.076669s/iter; left time: 6095.108699s
	iters: 1146, epoch: 9 | train_loss : 0.0054
	speed: 0.080680s/iter; left time: 6383.175280s
	iters: 1528, epoch: 9 | train_loss : 0.0062
	speed: 0.128089s/iter; left time: 10085.111576s
	iters: 1910, epoch: 9 | train_loss : 0.0052
	speed: 0.130826s/iter; left time: 10250.635752s
data: {'predict': array([0.55464975, 0.55486109, 0.55122321, ..., 0.34237972, 0.34277405,
       0.34356643]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:07:19] [32mIntermediate result: 0.08930584788322449  (Index 8)[0m
Epoch: 9 | cost time: 795.8896043300629 | valid_loss: 0.08930584788322449 | valid_loss_true: 0.023607012661477775
Pretest loss in this epoch: 0.030024050987743547
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0064
	speed: 1.686507s/iter; left time: 131496.986293s
	iters: 764, epoch: 10 | train_loss : 0.0083
	speed: 0.113501s/iter; left time: 8806.331096s
	iters: 1146, epoch: 10 | train_loss : 0.0066
	speed: 0.119691s/iter; left time: 9240.873219s
	iters: 1528, epoch: 10 | train_loss : 0.0051
	speed: 0.132937s/iter; left time: 10212.769066s
	iters: 1910, epoch: 10 | train_loss : 0.0059
	speed: 0.130879s/iter; left time: 10004.619281s
data: {'predict': array([0.55615   , 0.55626268, 0.55249175, ..., 0.3427287 , 0.34311523,
       0.34394123]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:18:54] [32mIntermediate result: 0.08953709900379181  (Index 9)[0m
Epoch: 10 | cost time: 694.6185953617096 | valid_loss: 0.08953709900379181 | valid_loss_true: 0.023730987462050435
Pretest loss in this epoch: 0.029742364511345497
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0036
	speed: 1.339187s/iter; left time: 101857.260239s
	iters: 764, epoch: 11 | train_loss : 0.0041
	speed: 0.109855s/iter; left time: 8313.526470s
	iters: 1146, epoch: 11 | train_loss : 0.0057
	speed: 0.113477s/iter; left time: 8544.262493s
	iters: 1528, epoch: 11 | train_loss : 0.0060
	speed: 0.109666s/iter; left time: 8215.434670s
	iters: 1910, epoch: 11 | train_loss : 0.0094
	speed: 0.109147s/iter; left time: 8134.848505s
data: {'predict': array([0.55497995, 0.55503194, 0.55092547, ..., 0.33959282, 0.33997294,
       0.34078484]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:29:10] [32mIntermediate result: 0.08991911262273788  (Index 10)[0m
Epoch: 11 | cost time: 615.9239013195038 | valid_loss: 0.08991911262273788 | valid_loss_true: 0.023800875270635152
Pretest loss in this epoch: 0.029893921657046796
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0059
	speed: 1.168862s/iter; left time: 86668.792918s
	iters: 764, epoch: 12 | train_loss : 0.0043
	speed: 0.131024s/iter; left time: 9665.125631s
	iters: 1146, epoch: 12 | train_loss : 0.0059
	speed: 0.127856s/iter; left time: 9382.607233s
	iters: 1528, epoch: 12 | train_loss : 0.0062
	speed: 0.129187s/iter; left time: 9430.909127s
	iters: 1910, epoch: 12 | train_loss : 0.0052
	speed: 0.112446s/iter; left time: 8165.850670s
data: {'predict': array([0.55630347, 0.55635123, 0.55224667, ..., 0.34327078, 0.34365043,
       0.34447189]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:38:37] [32mIntermediate result: 0.08968034386634827  (Index 11)[0m
Epoch: 12 | cost time: 567.4338018894196 | valid_loss: 0.08968034386634827 | valid_loss_true: 0.023694535728713318
Pretest loss in this epoch: 0.029963699795896137
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0059
	speed: 0.944069s/iter; left time: 68196.706929s
	iters: 764, epoch: 13 | train_loss : 0.0044
	speed: 0.070576s/iter; left time: 5071.222019s
	iters: 1146, epoch: 13 | train_loss : 0.0077
	speed: 0.105723s/iter; left time: 7556.318634s
	iters: 1528, epoch: 13 | train_loss : 0.0050
	speed: 0.105328s/iter; left time: 7487.888247s
	iters: 1910, epoch: 13 | train_loss : 0.0040
	speed: 0.103479s/iter; left time: 7316.880656s
data: {'predict': array([0.55481099, 0.55502272, 0.55094845, ..., 0.34178547, 0.34215412,
       0.34298061]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:47:20] [32mIntermediate result: 0.08944830298423767  (Index 12)[0m
Epoch: 13 | cost time: 523.3194744586945 | valid_loss: 0.08944830298423767 | valid_loss_true: 0.02370078998839706
Pretest loss in this epoch: 0.029821550170973155
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0222
	speed: 0.982702s/iter; left time: 69109.468194s
	iters: 764, epoch: 14 | train_loss : 0.0096
	speed: 0.071974s/iter; left time: 5034.152320s
	iters: 1146, epoch: 14 | train_loss : 0.0040
	speed: 0.069364s/iter; left time: 4825.093080s
	iters: 1528, epoch: 14 | train_loss : 0.0089
	speed: 0.074193s/iter; left time: 5132.695802s
	iters: 1910, epoch: 14 | train_loss : 0.0060
	speed: 0.106744s/iter; left time: 7343.755964s
data: {'predict': array([0.5539126 , 0.55411428, 0.54993129, ..., 0.33900884, 0.33939433,
       0.34022139]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 05:56:44] [32mIntermediate result: 0.09062660485506058  (Index 13)[0m
Epoch: 14 | cost time: 563.5541381835938 | valid_loss: 0.09062660485506058 | valid_loss_true: 0.02389998053260057
Pretest loss in this epoch: 0.029598103571166493
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0056
	speed: 1.151741s/iter; left time: 78796.326594s
	iters: 764, epoch: 15 | train_loss : 0.0054
	speed: 0.071115s/iter; left time: 4838.142768s
	iters: 1146, epoch: 15 | train_loss : 0.0073
	speed: 0.069479s/iter; left time: 4700.318416s
	iters: 1528, epoch: 15 | train_loss : 0.0086
	speed: 0.100050s/iter; left time: 6730.233934s
	iters: 1910, epoch: 15 | train_loss : 0.0059
	speed: 0.107953s/iter; left time: 7220.624329s
data: {'predict': array([0.55738129, 0.55756872, 0.55336432, ..., 0.34313335, 0.34350674,
       0.34435087]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:05:04] [32mIntermediate result: 0.09019152075052261  (Index 14)[0m
Epoch: 15 | cost time: 499.86710238456726 | valid_loss: 0.09019152075052261 | valid_loss_true: 0.023910444133294483
Pretest loss in this epoch: 0.030261145441589168
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0070
	speed: 0.994668s/iter; left time: 66149.428609s
	iters: 764, epoch: 16 | train_loss : 0.0267
	speed: 0.069165s/iter; left time: 4573.297186s
	iters: 1146, epoch: 16 | train_loss : 0.0057
	speed: 0.067522s/iter; left time: 4438.883537s
	iters: 1528, epoch: 16 | train_loss : 0.0039
	speed: 0.065031s/iter; left time: 4250.268226s
	iters: 1910, epoch: 16 | train_loss : 0.0047
	speed: 0.069428s/iter; left time: 4511.155482s
data: {'predict': array([0.55575659, 0.55593394, 0.55169112, ..., 0.34084598, 0.34124191,
       0.34210035]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:13:14] [32mIntermediate result: 0.0898497998714447  (Index 15)[0m
Epoch: 16 | cost time: 490.4324812889099 | valid_loss: 0.0898497998714447 | valid_loss_true: 0.02381220844531383
Pretest loss in this epoch: 0.029706108103222537
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0091
	speed: 1.017451s/iter; left time: 65720.243676s
	iters: 764, epoch: 17 | train_loss : 0.0081
	speed: 0.106572s/iter; left time: 6843.106524s
	iters: 1146, epoch: 17 | train_loss : 0.0055
	speed: 0.082180s/iter; left time: 5245.487105s
	iters: 1528, epoch: 17 | train_loss : 0.0078
	speed: 0.067216s/iter; left time: 4264.634268s
	iters: 1910, epoch: 17 | train_loss : 0.0040
	speed: 0.069869s/iter; left time: 4406.290902s
data: {'predict': array([0.55371474, 0.55386619, 0.54965376, ..., 0.3458281 , 0.34620562,
       0.34702022]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:20:53] [32mIntermediate result: 0.08909367024898529  (Index 16)[0m
Epoch: 17 | cost time: 459.15127968788147 | valid_loss: 0.08909367024898529 | valid_loss_true: 0.02353982592776281
Pretest loss in this epoch: 0.02933830071375397
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-16.pth
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0062
	speed: 0.871122s/iter; left time: 54603.640378s
	iters: 764, epoch: 18 | train_loss : 0.0045
	speed: 0.105388s/iter; left time: 6565.696764s
	iters: 1146, epoch: 18 | train_loss : 0.0054
	speed: 0.105500s/iter; left time: 6532.321890s
	iters: 1528, epoch: 18 | train_loss : 0.0092
	speed: 0.099846s/iter; left time: 6144.129129s
	iters: 1910, epoch: 18 | train_loss : 0.0148
	speed: 0.062946s/iter; left time: 3849.383311s
data: {'predict': array([0.55477745, 0.55495305, 0.55072914, ..., 0.34165486, 0.34203209,
       0.34289317]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:27:42] [32mIntermediate result: 0.0898703783750534  (Index 17)[0m
Epoch: 18 | cost time: 408.4083390235901 | valid_loss: 0.0898703783750534 | valid_loss_true: 0.02378702505621896
Pretest loss in this epoch: 0.029464275260913962
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0079
	speed: 0.690163s/iter; left time: 41941.920181s
	iters: 764, epoch: 19 | train_loss : 0.0050
	speed: 0.107251s/iter; left time: 6476.791194s
	iters: 1146, epoch: 19 | train_loss : 0.0060
	speed: 0.106852s/iter; left time: 6411.880528s
	iters: 1528, epoch: 19 | train_loss : 0.0079
	speed: 0.106862s/iter; left time: 6371.664473s
	iters: 1910, epoch: 19 | train_loss : 0.0053
	speed: 0.104326s/iter; left time: 6180.580767s
data: {'predict': array([0.55504945, 0.55515196, 0.55083175, ..., 0.34108918, 0.34146231,
       0.34227409]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:35:24] [32mIntermediate result: 0.08974244445562363  (Index 18)[0m
Epoch: 19 | cost time: 462.3173348903656 | valid_loss: 0.08974244445562363 | valid_loss_true: 0.023778199454119745
Pretest loss in this epoch: 0.029560006786154693
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0059
	speed: 0.754141s/iter; left time: 44388.735986s
	iters: 764, epoch: 20 | train_loss : 0.0055
	speed: 0.087660s/iter; left time: 5126.158849s
	iters: 1146, epoch: 20 | train_loss : 0.0045
	speed: 0.107103s/iter; left time: 6222.258289s
	iters: 1528, epoch: 20 | train_loss : 0.0048
	speed: 0.103578s/iter; left time: 5977.878873s
	iters: 1910, epoch: 20 | train_loss : 0.0064
	speed: 0.106296s/iter; left time: 6094.137263s
data: {'predict': array([0.55458284, 0.55472816, 0.55047631, ..., 0.34117516, 0.34155999,
       0.34241312]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:43:37] [32mIntermediate result: 0.08949167281389236  (Index 19)[0m
Epoch: 20 | cost time: 492.8260815143585 | valid_loss: 0.08949167281389236 | valid_loss_true: 0.02370800350059041
Pretest loss in this epoch: 0.029417877096206583
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0080
	speed: 0.881747s/iter; left time: 50214.635985s
	iters: 764, epoch: 21 | train_loss : 0.0127
	speed: 0.066742s/iter; left time: 3775.410822s
	iters: 1146, epoch: 21 | train_loss : 0.0067
	speed: 0.066489s/iter; left time: 3735.685971s
	iters: 1528, epoch: 21 | train_loss : 0.0033
	speed: 0.083405s/iter; left time: 4654.246868s
	iters: 1910, epoch: 21 | train_loss : 0.0073
	speed: 0.105804s/iter; left time: 5863.790442s
data: {'predict': array([0.55551682, 0.5556366 , 0.55130346, ..., 0.34272149, 0.34310884,
       0.34394884]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 06:52:27] [32mIntermediate result: 0.08946334570646286  (Index 20)[0m
Epoch: 21 | cost time: 529.7423522472382 | valid_loss: 0.08946334570646286 | valid_loss_true: 0.02372347504192559
Pretest loss in this epoch: 0.029589086504294274
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0087
	speed: 1.081191s/iter; left time: 59506.571256s
	iters: 764, epoch: 22 | train_loss : 0.0047
	speed: 0.064792s/iter; left time: 3541.298579s
	iters: 1146, epoch: 22 | train_loss : 0.0048
	speed: 0.066531s/iter; left time: 3610.887795s
	iters: 1528, epoch: 22 | train_loss : 0.0060
	speed: 0.068499s/iter; left time: 3691.544524s
	iters: 1910, epoch: 22 | train_loss : 0.0060
	speed: 0.067505s/iter; left time: 3612.213732s
data: {'predict': array([0.55442547, 0.55460779, 0.55033243, ..., 0.34152544, 0.3419043 ,
       0.34276819]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 07:00:30] [32mIntermediate result: 0.08954806625843048  (Index 21)[0m
Epoch: 22 | cost time: 483.55846786499023 | valid_loss: 0.08954806625843048 | valid_loss_true: 0.023726855222356152
Pretest loss in this epoch: 0.02943714461758713
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0047
	speed: 1.021460s/iter; left time: 54267.131887s
	iters: 764, epoch: 23 | train_loss : 0.0103
	speed: 0.107697s/iter; left time: 5680.500489s
	iters: 1146, epoch: 23 | train_loss : 0.0055
	speed: 0.085974s/iter; left time: 4501.881263s
	iters: 1528, epoch: 23 | train_loss : 0.0159
	speed: 0.065944s/iter; left time: 3427.839836s
	iters: 1910, epoch: 23 | train_loss : 0.0083
	speed: 0.069307s/iter; left time: 3576.169940s
data: {'predict': array([0.55462316, 0.55476637, 0.5504142 , ..., 0.34055681, 0.34093834,
       0.34179054]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 07:07:56] [32mIntermediate result: 0.08969839662313461  (Index 22)[0m
Epoch: 23 | cost time: 446.31797528266907 | valid_loss: 0.08969839662313461 | valid_loss_true: 0.023780442720234718
Pretest loss in this epoch: 0.029486158082394836
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 0.0047
	speed: 0.837613s/iter; left time: 42899.198355s
	iters: 764, epoch: 24 | train_loss : 0.0038
	speed: 0.111994s/iter; left time: 5693.118225s
	iters: 1146, epoch: 24 | train_loss : 0.0067
	speed: 0.106045s/iter; left time: 5350.188113s
	iters: 1528, epoch: 24 | train_loss : 0.0075
	speed: 0.108848s/iter; left time: 5449.997895s
	iters: 1910, epoch: 24 | train_loss : 0.0050
	speed: 0.071923s/iter; left time: 3573.687852s
data: {'predict': array([0.55674324, 0.55688518, 0.55246168, ..., 0.34083759, 0.3412262 ,
       0.34208285]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 07:14:59] [32mIntermediate result: 0.0899144634604454  (Index 23)[0m
Epoch: 24 | cost time: 422.58185291290283 | valid_loss: 0.0899144634604454 | valid_loss_true: 0.02387430011987679
Pretest loss in this epoch: 0.029949695672733777
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 0.0074
	speed: 0.710055s/iter; left time: 35009.237704s
	iters: 764, epoch: 25 | train_loss : 0.0052
	speed: 0.106911s/iter; left time: 5230.417731s
	iters: 1146, epoch: 25 | train_loss : 0.0036
	speed: 0.101827s/iter; left time: 4942.761343s
	iters: 1528, epoch: 25 | train_loss : 0.0416
	speed: 0.104328s/iter; left time: 5024.349290s
	iters: 1910, epoch: 25 | train_loss : 0.0070
	speed: 0.104426s/iter; left time: 4989.176812s
data: {'predict': array([0.55521024, 0.55533349, 0.55095836, ..., 0.34151876, 0.34190514,
       0.34276591]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-07 07:22:42] [32mIntermediate result: 0.08957068622112274  (Index 24)[0m
Epoch: 25 | cost time: 462.6411666870117 | valid_loss: 0.08957068622112274 | valid_loss_true: 0.023753771731875654
Pretest loss in this epoch: 0.029432428927110593
Early stop with best valid_loss: 0.08957068622112274
[2024-03-07 07:22:42] [32mFinal result: 0.08909367024898529[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --target_cols 1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦', target_cols='1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 07:22:47.246966: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 07:22:47.247042: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 07:22:47.248725: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 07:22:47.256714: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 07:22:48.266318: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0105
	speed: 0.087800s/iter; left time: 8355.799328s
	iters: 764, epoch: 1 | train_loss : 0.0079
	speed: 0.103904s/iter; left time: 9848.730653s
	iters: 1146, epoch: 1 | train_loss : 0.0120
	speed: 0.104731s/iter; left time: 9887.131401s
	iters: 1528, epoch: 1 | train_loss : 0.0028
	speed: 0.104926s/iter; left time: 9865.414116s
	iters: 1910, epoch: 1 | train_loss : 0.0039
	speed: 0.109715s/iter; left time: 10273.848019s
data: {'predict': array([137.67597044, 137.71086539, 137.74264054, ..., 132.13230011,
       132.15837766, 132.15337752]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 07:30:48] [32mIntermediate result: 0.02484229952096939  (Index 0)[0m
Epoch: 1 | cost time: 475.2035496234894 | valid_loss: 0.02484229952096939 | valid_loss_true: 1.306352310587435
Pretest loss in this epoch: 4.1456845538971265
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0023
	speed: 0.809172s/iter; left time: 75461.803929s
	iters: 764, epoch: 2 | train_loss : 0.0046
	speed: 0.066027s/iter; left time: 6132.316957s
	iters: 1146, epoch: 2 | train_loss : 0.0023
	speed: 0.077901s/iter; left time: 7205.397620s
	iters: 1528, epoch: 2 | train_loss : 0.0025
	speed: 0.106197s/iter; left time: 9781.996579s
	iters: 1910, epoch: 2 | train_loss : 0.0021
	speed: 0.100937s/iter; left time: 9258.945296s
data: {'predict': array([138.41989319, 138.46781395, 138.5194365 , ..., 133.07818774,
       133.11294484, 133.09344146]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 07:39:39] [32mIntermediate result: 0.038087718188762665  (Index 1)[0m
Epoch: 2 | cost time: 530.9232125282288 | valid_loss: 0.038087718188762665 | valid_loss_true: 1.837079702507442
Pretest loss in this epoch: 3.3073312827828194
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0029
	speed: 1.036256s/iter; left time: 94658.861668s
	iters: 764, epoch: 3 | train_loss : 0.0016
	speed: 0.069566s/iter; left time: 6328.088467s
	iters: 1146, epoch: 3 | train_loss : 0.0046
	speed: 0.067596s/iter; left time: 6123.081363s
	iters: 1528, epoch: 3 | train_loss : 0.0022
	speed: 0.067959s/iter; left time: 6129.964438s
	iters: 1910, epoch: 3 | train_loss : 0.0013
	speed: 0.105787s/iter; left time: 9501.638164s
data: {'predict': array([137.67013145, 137.72429649, 137.78468931, ..., 132.25632455,
       132.29562466, 132.26416289]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 07:49:09] [32mIntermediate result: 0.02448197267949581  (Index 2)[0m
Epoch: 3 | cost time: 569.7807128429413 | valid_loss: 0.02448197267949581 | valid_loss_true: 1.2944300213177649
Pretest loss in this epoch: 3.142671143241686
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0021
	speed: 1.180995s/iter; left time: 105623.428794s
	iters: 764, epoch: 4 | train_loss : 0.0014
	speed: 0.069512s/iter; left time: 6190.295492s
	iters: 1146, epoch: 4 | train_loss : 0.0013
	speed: 0.071599s/iter; left time: 6348.850915s
	iters: 1528, epoch: 4 | train_loss : 0.0011
	speed: 0.082058s/iter; left time: 7244.899525s
	iters: 1910, epoch: 4 | train_loss : 0.0036
	speed: 0.107466s/iter; left time: 9447.091493s
data: {'predict': array([137.83681141, 137.89061828, 137.95109829, ..., 132.74177401,
       132.78154774, 132.74144884]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 07:58:23] [32mIntermediate result: 0.028321828693151474  (Index 3)[0m
Epoch: 4 | cost time: 553.6743702888489 | valid_loss: 0.028321828693151474 | valid_loss_true: 1.3860159150396076
Pretest loss in this epoch: 3.1281487318297674
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0019
	speed: 1.122590s/iter; left time: 98254.718328s
	iters: 764, epoch: 5 | train_loss : 0.0030
	speed: 0.073047s/iter; left time: 6365.536251s
	iters: 1146, epoch: 5 | train_loss : 0.0022
	speed: 0.070486s/iter; left time: 6115.476194s
	iters: 1528, epoch: 5 | train_loss : 0.0017
	speed: 0.080913s/iter; left time: 6989.200262s
	iters: 1910, epoch: 5 | train_loss : 0.0135
	speed: 0.106592s/iter; left time: 9166.580402s
data: {'predict': array([137.2059043 , 137.25560409, 137.31102152, ..., 132.22533052,
       132.26344067, 132.21934896]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:07:45] [32mIntermediate result: 0.020810939371585846  (Index 4)[0m
Epoch: 5 | cost time: 562.1608340740204 | valid_loss: 0.020810939371585846 | valid_loss_true: 1.0643697000124608
Pretest loss in this epoch: 3.2448783822163794
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0010
	speed: 1.135837s/iter; left time: 97243.519482s
	iters: 764, epoch: 6 | train_loss : 0.0014
	speed: 0.070388s/iter; left time: 5999.327628s
	iters: 1146, epoch: 6 | train_loss : 0.0022
	speed: 0.069158s/iter; left time: 5868.065872s
	iters: 1528, epoch: 6 | train_loss : 0.0013
	speed: 0.082880s/iter; left time: 7000.749555s
	iters: 1910, epoch: 6 | train_loss : 0.0052
	speed: 0.108907s/iter; left time: 9157.556305s
data: {'predict': array([137.45152261, 137.50378373, 137.56229385, ..., 132.15943329,
       132.20046295, 132.14797798]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:17:03] [32mIntermediate result: 0.022137584164738655  (Index 5)[0m
Epoch: 6 | cost time: 557.5540297031403 | valid_loss: 0.022137584164738655 | valid_loss_true: 1.157598011353687
Pretest loss in this epoch: 3.0244969115024776
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0048
	speed: 1.127933s/iter; left time: 94411.337482s
	iters: 764, epoch: 7 | train_loss : 0.0013
	speed: 0.066569s/iter; left time: 5546.556752s
	iters: 1146, epoch: 7 | train_loss : 0.0072
	speed: 0.075611s/iter; left time: 6271.081807s
	iters: 1528, epoch: 7 | train_loss : 0.0078
	speed: 0.105075s/iter; left time: 8674.707266s
	iters: 1910, epoch: 7 | train_loss : 0.0009
	speed: 0.107611s/iter; left time: 8842.920711s
data: {'predict': array([137.43755191, 137.48644819, 137.54054253, ..., 132.39256421,
       132.43146139, 132.37736115]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:25:46] [32mIntermediate result: 0.022160861641168594  (Index 6)[0m
Epoch: 7 | cost time: 523.0661811828613 | valid_loss: 0.022160861641168594 | valid_loss_true: 1.1371018458784967
Pretest loss in this epoch: 3.027709957061312
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0006
	speed: 1.013769s/iter; left time: 82918.200224s
	iters: 764, epoch: 8 | train_loss : 0.0011
	speed: 0.069010s/iter; left time: 5618.109939s
	iters: 1146, epoch: 8 | train_loss : 0.0010
	speed: 0.077861s/iter; left time: 6308.897601s
	iters: 1528, epoch: 8 | train_loss : 0.0006
	speed: 0.107392s/iter; left time: 8660.752871s
	iters: 1910, epoch: 8 | train_loss : 0.0027
	speed: 0.103360s/iter; left time: 8296.095012s
data: {'predict': array([137.40099811, 137.45109376, 137.5068399 , ..., 132.1490183 ,
       132.19029655, 132.12913085]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:34:36] [32mIntermediate result: 0.021334165707230568  (Index 7)[0m
Epoch: 8 | cost time: 530.6060402393341 | valid_loss: 0.021334165707230568 | valid_loss_true: 1.1237254180245184
Pretest loss in this epoch: 2.9785802166274777
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0010
	speed: 1.032249s/iter; left time: 82457.088805s
	iters: 764, epoch: 9 | train_loss : 0.0124
	speed: 0.071666s/iter; left time: 5697.361721s
	iters: 1146, epoch: 9 | train_loss : 0.0008
	speed: 0.091881s/iter; left time: 7269.319790s
	iters: 1528, epoch: 9 | train_loss : 0.0021
	speed: 0.106666s/iter; left time: 8398.373268s
	iters: 1910, epoch: 9 | train_loss : 0.0010
	speed: 0.106799s/iter; left time: 8368.045586s
data: {'predict': array([137.03963199, 137.08875683, 137.1418568 , ..., 131.83349582,
       131.87216561, 131.80848688]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:43:21] [32mIntermediate result: 0.0195942185819149  (Index 8)[0m
Epoch: 9 | cost time: 524.5718016624451 | valid_loss: 0.0195942185819149 | valid_loss_true: 1.0326315966621036
Pretest loss in this epoch: 2.9753825586109683
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0129
	speed: 1.001297s/iter; left time: 78071.102968s
	iters: 764, epoch: 10 | train_loss : 0.0010
	speed: 0.072277s/iter; left time: 5607.832898s
	iters: 1146, epoch: 10 | train_loss : 0.0216
	speed: 0.095299s/iter; left time: 7357.650634s
	iters: 1528, epoch: 10 | train_loss : 0.0009
	speed: 0.106716s/iter; left time: 8198.352763s
	iters: 1910, epoch: 10 | train_loss : 0.0025
	speed: 0.104579s/iter; left time: 7994.256206s
data: {'predict': array([136.91548267, 136.95883449, 137.00715818, ..., 132.02717819,
       132.06507156, 132.00453971]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 08:52:04] [32mIntermediate result: 0.019622202962636948  (Index 9)[0m
Epoch: 10 | cost time: 522.7397241592407 | valid_loss: 0.019622202962636948 | valid_loss_true: 1.0179570352169804
Pretest loss in this epoch: 3.196307772471473
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0150
	speed: 0.984966s/iter; left time: 74915.560778s
	iters: 764, epoch: 11 | train_loss : 0.0112
	speed: 0.068719s/iter; left time: 5200.428074s
	iters: 1146, epoch: 11 | train_loss : 0.0007
	speed: 0.073037s/iter; left time: 5499.330143s
	iters: 1528, epoch: 11 | train_loss : 0.0009
	speed: 0.069577s/iter; left time: 5212.259105s
	iters: 1910, epoch: 11 | train_loss : 0.0008
	speed: 0.069290s/iter; left time: 5164.271698s
data: {'predict': array([137.13724428, 137.18187324, 137.2310617 , ..., 131.91374547,
       131.95389268, 131.88681729]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:00:57] [32mIntermediate result: 0.019621005281805992  (Index 10)[0m
Epoch: 11 | cost time: 533.1918876171112 | valid_loss: 0.019621005281805992 | valid_loss_true: 1.0411411037673417
Pretest loss in this epoch: 2.9495484194139205
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0010
	speed: 1.150133s/iter; left time: 85280.095559s
	iters: 764, epoch: 12 | train_loss : 0.0017
	speed: 0.074849s/iter; left time: 5521.294541s
	iters: 1146, epoch: 12 | train_loss : 0.0012
	speed: 0.056982s/iter; left time: 4181.535656s
	iters: 1528, epoch: 12 | train_loss : 0.0045
	speed: 0.058363s/iter; left time: 4260.640431s
	iters: 1910, epoch: 12 | train_loss : 0.0008
	speed: 0.057507s/iter; left time: 4176.177244s
data: {'predict': array([137.59554643, 137.64233378, 137.69487531, ..., 132.3508253 ,
       132.39239809, 132.32029193]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:06:14] [32mIntermediate result: 0.023823009803891182  (Index 11)[0m
Epoch: 12 | cost time: 317.03907346725464 | valid_loss: 0.023823009803891182 | valid_loss_true: 1.1961715958233041
Pretest loss in this epoch: 3.024722366238212
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0012
	speed: 0.546441s/iter; left time: 39473.246717s
	iters: 764, epoch: 13 | train_loss : 0.0009
	speed: 0.066202s/iter; left time: 4756.919877s
	iters: 1146, epoch: 13 | train_loss : 0.0008
	speed: 0.067864s/iter; left time: 4850.446294s
	iters: 1528, epoch: 13 | train_loss : 0.0009
	speed: 0.069737s/iter; left time: 4957.687442s
	iters: 1910, epoch: 13 | train_loss : 0.0008
	speed: 0.064086s/iter; left time: 4531.487934s
data: {'predict': array([137.16040704, 137.20369524, 137.25125312, ..., 132.04495201,
       132.08312697, 132.01321456]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:11:24] [32mIntermediate result: 0.019690779969096184  (Index 12)[0m
Epoch: 13 | cost time: 310.50049328804016 | valid_loss: 0.019690779969096184 | valid_loss_true: 1.0367858310180393
Pretest loss in this epoch: 3.1069633219457184
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0031
	speed: 0.542222s/iter; left time: 38132.329692s
	iters: 764, epoch: 14 | train_loss : 0.0031
	speed: 0.071663s/iter; left time: 5012.371828s
	iters: 1146, epoch: 14 | train_loss : 0.0009
	speed: 0.069333s/iter; left time: 4822.942169s
	iters: 1528, epoch: 14 | train_loss : 0.0013
	speed: 0.069809s/iter; left time: 4829.378971s
	iters: 1910, epoch: 14 | train_loss : 0.0008
	speed: 0.072560s/iter; left time: 4991.992338s
data: {'predict': array([137.27954561, 137.32274192, 137.37029509, ..., 132.11765432,
       132.15616035, 132.08346039]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:16:39] [32mIntermediate result: 0.020119821652770042  (Index 13)[0m
Epoch: 14 | cost time: 314.5479476451874 | valid_loss: 0.020119821652770042 | valid_loss_true: 1.0625429962154394
Pretest loss in this epoch: 2.992759658151973
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0009
	speed: 0.538371s/iter; left time: 36832.628394s
	iters: 764, epoch: 15 | train_loss : 0.0010
	speed: 0.057469s/iter; left time: 3909.786888s
	iters: 1146, epoch: 15 | train_loss : 0.0008
	speed: 0.057253s/iter; left time: 3873.219705s
	iters: 1528, epoch: 15 | train_loss : 0.0048
	speed: 0.056428s/iter; left time: 3795.874483s
	iters: 1910, epoch: 15 | train_loss : 0.0008
	speed: 0.056113s/iter; left time: 3753.206665s
data: {'predict': array([137.44148934, 137.48173788, 137.52663545, ..., 132.26868469,
       132.3076667 , 132.23579146]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:21:30] [32mIntermediate result: 0.02163669280707836  (Index 14)[0m
Epoch: 15 | cost time: 290.93194818496704 | valid_loss: 0.02163669280707836 | valid_loss_true: 1.1138321362985464
Pretest loss in this epoch: 3.1269586288412627
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0008
	speed: 0.530007s/iter; left time: 35247.576753s
	iters: 764, epoch: 16 | train_loss : 0.0035
	speed: 0.055030s/iter; left time: 3638.715542s
	iters: 1146, epoch: 16 | train_loss : 0.0007
	speed: 0.057545s/iter; left time: 3783.000076s
	iters: 1528, epoch: 16 | train_loss : 0.0007
	speed: 0.055816s/iter; left time: 3648.000593s
	iters: 1910, epoch: 16 | train_loss : 0.0008
	speed: 0.060473s/iter; left time: 3929.272005s
data: {'predict': array([137.34204265, 137.38385578, 137.43047349, ..., 132.10700016,
       132.14636036, 132.07189079]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:26:20] [32mIntermediate result: 0.02062920480966568  (Index 15)[0m
Epoch: 16 | cost time: 290.51853346824646 | valid_loss: 0.02062920480966568 | valid_loss_true: 1.0803884351829474
Pretest loss in this epoch: 3.1104613557261014
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0109
	speed: 0.542082s/iter; left time: 35014.697476s
	iters: 764, epoch: 17 | train_loss : 0.0012
	speed: 0.067537s/iter; left time: 4336.597550s
	iters: 1146, epoch: 17 | train_loss : 0.0012
	speed: 0.069458s/iter; left time: 4433.402832s
	iters: 1528, epoch: 17 | train_loss : 0.0008
	speed: 0.070068s/iter; left time: 4445.630801s
	iters: 1910, epoch: 17 | train_loss : 0.0005
	speed: 0.070123s/iter; left time: 4422.310595s
data: {'predict': array([137.36323787, 137.40319421, 137.44796219, ..., 132.29706673,
       132.33546083, 132.26245337]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-07 09:31:31] [32mIntermediate result: 0.02091040462255478  (Index 16)[0m
Epoch: 17 | cost time: 310.26464080810547 | valid_loss: 0.02091040462255478 | valid_loss_true: 1.082200808636834
Pretest loss in this epoch: 3.0284423359697072
Early stop with best valid_loss: 0.02091040462255478
[2024-03-07 09:31:31] [32mFinal result: 0.0195942185819149[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆå‡ºæ–™æ¸©åº¦ --target_cols 1æ•ˆå‡ºæ–™æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/fullreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/fullreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆå‡ºæ–™æ¸©åº¦', target_cols='1æ•ˆå‡ºæ–™æ¸©åº¦', timestamp_feature='none', seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-07 09:31:36.149916: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-07 09:31:36.149971: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-07 09:31:36.151734: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-07 09:31:36.159655: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-07 09:31:37.124156: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
	iters: 382, epoch: 1 | train_loss : 0.0034
	speed: 0.062690s/iter; left time: 5966.159544s
	iters: 764, epoch: 1 | train_loss : 0.0012
	speed: 0.057435s/iter; left time: 5444.050596s
	iters: 1146, epoch: 1 | train_loss : 0.0006
	speed: 0.057238s/iter; left time: 5403.571736s
	iters: 1528, epoch: 1 | train_loss : 0.0004
	speed: 0.056218s/iter; left time: 5285.757255s
	iters: 1910, epoch: 1 | train_loss : 0.0003
	speed: 0.055741s/iter; left time: 5219.649286s
data: {'predict': array([148.74946341, 148.74946341, 148.74946341, ..., 148.5833799 ,
       148.58741253, 148.58216598]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:36:35] [32mIntermediate result: 0.0006398609257303178  (Index 0)[0m
Epoch: 1 | cost time: 292.10055136680603 | valid_loss: 0.0006398609257303178 | valid_loss_true: 0.001203412190079689
Pretest loss in this epoch: 14.367793154875764
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0002
	speed: 0.545740s/iter; left time: 50894.600745s
	iters: 764, epoch: 2 | train_loss : 0.0001
	speed: 0.065366s/iter; left time: 6070.898627s
	iters: 1146, epoch: 2 | train_loss : 0.0001
	speed: 0.068770s/iter; left time: 6360.810863s
	iters: 1528, epoch: 2 | train_loss : 0.0001
	speed: 0.069684s/iter; left time: 6418.764220s
	iters: 1910, epoch: 2 | train_loss : 0.0001
	speed: 0.068387s/iter; left time: 6273.129866s
data: {'predict': array([148.74755806, 148.74755806, 148.74755806, ..., 148.63014855,
       148.6331211 , 148.62926406]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:41:41] [32mIntermediate result: 0.0009591339621692896  (Index 1)[0m
Epoch: 2 | cost time: 305.3175804615021 | valid_loss: 0.0009591339621692896 | valid_loss_true: 0.0007019396871328354
Pretest loss in this epoch: 14.393022193945518
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0001
	speed: 0.530622s/iter; left time: 48470.716759s
	iters: 764, epoch: 3 | train_loss : 0.0000
	speed: 0.068579s/iter; left time: 6238.327144s
	iters: 1146, epoch: 3 | train_loss : 0.0000
	speed: 0.058538s/iter; left time: 5302.592769s
	iters: 1528, epoch: 3 | train_loss : 0.0000
	speed: 0.058494s/iter; left time: 5276.182382s
	iters: 1910, epoch: 3 | train_loss : 0.0000
	speed: 0.057519s/iter; left time: 5166.264102s
data: {'predict': array([148.74829799, 148.74829799, 148.74829799, ..., 148.66250601,
       148.66470899, 148.66189074]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:46:43] [32mIntermediate result: 0.0002316670143045485  (Index 2)[0m
Epoch: 3 | cost time: 302.51500272750854 | valid_loss: 0.0002316670143045485 | valid_loss_true: 3.798864781856537e-05
Pretest loss in this epoch: 14.410727491937385
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0000
	speed: 0.538092s/iter; left time: 48124.823102s
	iters: 764, epoch: 4 | train_loss : 0.0000
	speed: 0.058041s/iter; left time: 5168.746441s
	iters: 1146, epoch: 4 | train_loss : 0.0000
	speed: 0.057373s/iter; left time: 5087.384916s
	iters: 1528, epoch: 4 | train_loss : 0.0000
	speed: 0.057941s/iter; left time: 5115.646807s
	iters: 1910, epoch: 4 | train_loss : 0.0000
	speed: 0.058667s/iter; left time: 5157.269177s
data: {'predict': array([148.74866935, 148.74866935, 148.74866935, ..., 148.68526847,
       148.68686412, 148.68486444]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:51:39] [32mIntermediate result: 0.0004263525188434869  (Index 3)[0m
Epoch: 4 | cost time: 295.24780225753784 | valid_loss: 0.0004263525188434869 | valid_loss_true: 0.00040934979915618896
Pretest loss in this epoch: 14.423949550769072
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0000
	speed: 0.541054s/iter; left time: 47355.733741s
	iters: 764, epoch: 5 | train_loss : 0.0000
	speed: 0.059788s/iter; left time: 5210.068854s
	iters: 1146, epoch: 5 | train_loss : 0.0000
	speed: 0.063320s/iter; left time: 5493.673771s
	iters: 1528, epoch: 5 | train_loss : 0.0000
	speed: 0.058018s/iter; left time: 5011.494423s
	iters: 1910, epoch: 5 | train_loss : 0.0000
	speed: 0.058453s/iter; left time: 5026.807280s
data: {'predict': array([148.74862888, 148.74862888, 148.74862888, ..., 148.70080384,
       148.70194177, 148.7005431 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 09:56:35] [32mIntermediate result: 0.000373297167243436  (Index 4)[0m
Epoch: 5 | cost time: 296.93184542655945 | valid_loss: 0.000373297167243436 | valid_loss_true: 0.00036888010799884796
Pretest loss in this epoch: 14.43377785232129
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0000
	speed: 0.541661s/iter; left time: 46373.736192s
	iters: 764, epoch: 6 | train_loss : 0.0000
	speed: 0.068620s/iter; left time: 5848.599484s
	iters: 1146, epoch: 6 | train_loss : 0.0000
	speed: 0.058184s/iter; left time: 4936.926558s
	iters: 1528, epoch: 6 | train_loss : 0.0000
	speed: 0.057042s/iter; left time: 4818.187559s
	iters: 1910, epoch: 6 | train_loss : 0.0000
	speed: 0.059306s/iter; left time: 4986.837267s
data: {'predict': array([148.74849811, 148.74849811, 148.74849811, ..., 148.71343579,
       148.71421312, 148.71327755]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:01:34] [32mIntermediate result: 0.00022128954879008234  (Index 5)[0m
Epoch: 6 | cost time: 298.7716853618622 | valid_loss: 0.00022128954879008234 | valid_loss_true: 0.00023810938000679016
Pretest loss in this epoch: 14.442599989718092
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0000
	speed: 0.534339s/iter; left time: 44725.781897s
	iters: 764, epoch: 7 | train_loss : 0.0000
	speed: 0.057077s/iter; left time: 4755.721373s
	iters: 1146, epoch: 7 | train_loss : 0.0000
	speed: 0.058682s/iter; left time: 4867.050402s
	iters: 1528, epoch: 7 | train_loss : 0.0000
	speed: 0.058852s/iter; left time: 4858.638001s
	iters: 1910, epoch: 7 | train_loss : 0.0000
	speed: 0.061233s/iter; left time: 5031.826389s
data: {'predict': array([148.7483758 , 148.7483758 , 148.7483758 , ..., 148.7220782 ,
       148.7226067 , 148.72198351]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:06:31] [32mIntermediate result: 0.00013101816875860095  (Index 6)[0m
Epoch: 7 | cost time: 296.7257385253906 | valid_loss: 0.00013101816875860095 | valid_loss_true: 0.00011580251157283783
Pretest loss in this epoch: 14.447838911064222
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0000
	speed: 0.542214s/iter; left time: 44348.728316s
	iters: 764, epoch: 8 | train_loss : 0.0000
	speed: 0.060300s/iter; left time: 4909.012690s
	iters: 1146, epoch: 8 | train_loss : 0.0000
	speed: 0.057377s/iter; left time: 4649.157272s
	iters: 1528, epoch: 8 | train_loss : 0.0000
	speed: 0.058673s/iter; left time: 4731.723316s
	iters: 1910, epoch: 8 | train_loss : 0.0000
	speed: 0.057680s/iter; left time: 4629.636602s
data: {'predict': array([148.74828441, 148.74828441, 148.74828441, ..., 148.72775966,
       148.72812282, 148.72770564]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:11:27] [32mIntermediate result: 4.183830606052652e-05  (Index 7)[0m
Epoch: 8 | cost time: 295.93925976753235 | valid_loss: 4.183830606052652e-05 | valid_loss_true: 2.4411827325820923e-05
Pretest loss in this epoch: 14.45189302995074
Chepoint Saved at:  ./checkpoints/fullreg/transformer/alumina_transformer/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0000
	speed: 0.541545s/iter; left time: 43259.119780s
	iters: 764, epoch: 9 | train_loss : 0.0000
	speed: 0.060479s/iter; left time: 4808.051675s
	iters: 1146, epoch: 9 | train_loss : 0.0000
	speed: 0.057662s/iter; left time: 4562.028718s
	iters: 1528, epoch: 9 | train_loss : 0.0000
	speed: 0.059861s/iter; left time: 4713.128438s
	iters: 1910, epoch: 9 | train_loss : 0.0000
	speed: 0.058030s/iter; left time: 4546.821404s
data: {'predict': array([148.74841807, 148.74841807, 148.74841807, ..., 148.7321827 ,
       148.73243932, 148.73214923]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:16:23] [32mIntermediate result: 0.00015011895447969437  (Index 8)[0m
Epoch: 9 | cost time: 295.61788296699524 | valid_loss: 0.00015011895447969437 | valid_loss_true: 0.00015806593000888824
Pretest loss in this epoch: 14.455700600577169
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0000
	speed: 0.538031s/iter; left time: 41950.254937s
	iters: 764, epoch: 10 | train_loss : 0.0000
	speed: 0.055959s/iter; left time: 4341.741518s
	iters: 1146, epoch: 10 | train_loss : 0.0000
	speed: 0.058414s/iter; left time: 4509.908672s
	iters: 1528, epoch: 10 | train_loss : 0.0000
	speed: 0.060198s/iter; left time: 4624.665294s
	iters: 1910, epoch: 10 | train_loss : 0.0000
	speed: 0.059308s/iter; left time: 4533.657843s
data: {'predict': array([148.7485382 , 148.7485382 , 148.7485382 , ..., 148.73446703,
       148.73466578, 148.73444433]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:21:19] [32mIntermediate result: 0.00028924326761625707  (Index 9)[0m
Epoch: 10 | cost time: 296.03304147720337 | valid_loss: 0.00028924326761625707 | valid_loss_true: 0.0002781953662633896
Pretest loss in this epoch: 14.457891445496248
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0000
	speed: 0.542970s/iter; left time: 41297.755952s
	iters: 764, epoch: 11 | train_loss : 0.0000
	speed: 0.060816s/iter; left time: 4602.373964s
	iters: 1146, epoch: 11 | train_loss : 0.0000
	speed: 0.059627s/iter; left time: 4489.593579s
	iters: 1528, epoch: 11 | train_loss : 0.0000
	speed: 0.060152s/iter; left time: 4506.151499s
	iters: 1910, epoch: 11 | train_loss : 0.0000
	speed: 0.057931s/iter; left time: 4317.637128s
data: {'predict': array([148.74852706, 148.74852706, 148.74852706, ..., 148.73616447,
       148.73633271, 148.73614537]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:26:16] [32mIntermediate result: 0.0002850413729902357  (Index 10)[0m
Epoch: 11 | cost time: 297.011510848999 | valid_loss: 0.0002850413729902357 | valid_loss_true: 0.00026705674827098846
Pretest loss in this epoch: 14.459540973736207
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0000
	speed: 0.542736s/iter; left time: 40242.808951s
	iters: 764, epoch: 12 | train_loss : 0.0000
	speed: 0.058101s/iter; left time: 4285.869846s
	iters: 1146, epoch: 12 | train_loss : 0.0000
	speed: 0.059945s/iter; left time: 4398.987101s
	iters: 1528, epoch: 12 | train_loss : 0.0000
	speed: 0.059583s/iter; left time: 4349.698386s
	iters: 1910, epoch: 12 | train_loss : 0.0000
	speed: 0.059472s/iter; left time: 4318.881598s
data: {'predict': array([148.74830315, 148.74830315, 148.74830315, ..., 148.73653146,
       148.73668793, 148.73651318]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:31:13] [32mIntermediate result: 5.77090831939131e-05  (Index 11)[0m
Epoch: 12 | cost time: 297.351149559021 | valid_loss: 5.77090831939131e-05 | valid_loss_true: 4.315376281738281e-05
Pretest loss in this epoch: 14.460037513208283
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0000
	speed: 0.539378s/iter; left time: 38963.018933s
	iters: 764, epoch: 13 | train_loss : 0.0000
	speed: 0.055268s/iter; left time: 3971.303168s
	iters: 1146, epoch: 13 | train_loss : 0.0000
	speed: 0.057082s/iter; left time: 4079.854766s
	iters: 1528, epoch: 13 | train_loss : 0.0000
	speed: 0.058007s/iter; left time: 4123.752077s
	iters: 1910, epoch: 13 | train_loss : 0.0000
	speed: 0.058119s/iter; left time: 4109.562802s
data: {'predict': array([148.74845314, 148.74845314, 148.74845314, ..., 148.7373844 ,
       148.73753276, 148.73736614]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:36:06] [32mIntermediate result: 0.00020721180771943182  (Index 12)[0m
Epoch: 13 | cost time: 293.1327826976776 | valid_loss: 0.00020721180771943182 | valid_loss_true: 0.0001931414008140564
Pretest loss in this epoch: 14.46080138887971
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0000
	speed: 0.534320s/iter; left time: 37576.598193s
	iters: 764, epoch: 14 | train_loss : 0.0000
	speed: 0.058771s/iter; left time: 4110.682481s
	iters: 1146, epoch: 14 | train_loss : 0.0000
	speed: 0.059460s/iter; left time: 4136.164524s
	iters: 1528, epoch: 14 | train_loss : 0.0000
	speed: 0.062552s/iter; left time: 4327.381442s
	iters: 1910, epoch: 14 | train_loss : 0.0000
	speed: 0.056993s/iter; left time: 3920.989955s
data: {'predict': array([148.74838392, 148.74838392, 148.74838392, ..., 148.73764978,
       148.7377949 , 148.73763009]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:41:03] [32mIntermediate result: 0.00013745056639891118  (Index 13)[0m
Epoch: 14 | cost time: 296.53764057159424 | valid_loss: 0.00013745056639891118 | valid_loss_true: 0.00012391991913318634
Pretest loss in this epoch: 14.461092914960775
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0000
	speed: 0.541193s/iter; left time: 37025.737050s
	iters: 764, epoch: 15 | train_loss : 0.0000
	speed: 0.064110s/iter; left time: 4361.618014s
	iters: 1146, epoch: 15 | train_loss : 0.0000
	speed: 0.060836s/iter; left time: 4115.640639s
	iters: 1528, epoch: 15 | train_loss : 0.0000
	speed: 0.059045s/iter; left time: 3971.878555s
	iters: 1910, epoch: 15 | train_loss : 0.0000
	speed: 0.058120s/iter; left time: 3887.479691s
data: {'predict': array([148.74839751, 148.74839751, 148.74839751, ..., 148.73808066,
       148.73822307, 148.73805942]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:46:05] [32mIntermediate result: 0.0001557166106067598  (Index 14)[0m
Epoch: 15 | cost time: 302.0397686958313 | valid_loss: 0.0001557166106067598 | valid_loss_true: 0.00013751164078712463
Pretest loss in this epoch: 14.461492128893019
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0000
	speed: 0.546553s/iter; left time: 36347.977239s
	iters: 764, epoch: 16 | train_loss : 0.0000
	speed: 0.060151s/iter; left time: 3977.320371s
	iters: 1146, epoch: 16 | train_loss : 0.0000
	speed: 0.057781s/iter; left time: 3798.533225s
	iters: 1528, epoch: 16 | train_loss : 0.0000
	speed: 0.057005s/iter; left time: 3725.750518s
	iters: 1910, epoch: 16 | train_loss : 0.0000
	speed: 0.057394s/iter; left time: 3729.239698s
data: {'predict': array([148.74834857, 148.74834857, 148.74834857, ..., 148.73827167,
       148.73841245, 148.73824962]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-07 10:51:02] [32mIntermediate result: 0.00010252931679133326  (Index 15)[0m
Epoch: 16 | cost time: 296.84870290756226 | valid_loss: 0.00010252931679133326 | valid_loss_true: 8.856505155563354e-05
Pretest loss in this epoch: 14.461685052649113
Early stop with best valid_loss: 0.00010252931679133326
[2024-03-07 10:51:02] [32mFinal result: 4.183830606052652e-05[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
