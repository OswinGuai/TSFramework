python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½æ¸© --target_cols 1æ•ˆè’¸å‘å™¨æ±½æ¸© --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/randseries/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/randseries/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½æ¸©', target_cols='1æ•ˆè’¸å‘å™¨æ±½æ¸©', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-10 11:54:47.738469: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-10 11:54:47.738557: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-10 11:54:47.740439: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-10 11:54:47.749761: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-10 11:54:48.724141: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½æ¸©
	iters: 382, epoch: 1 | train_loss : 1.2314
	speed: 0.040498s/iter; left time: 3854.166889s
	iters: 764, epoch: 1 | train_loss : 1.4469
	speed: 0.033687s/iter; left time: 3193.135033s
	iters: 1146, epoch: 1 | train_loss : 1.0681
	speed: 0.032650s/iter; left time: 3082.357909s
	iters: 1528, epoch: 1 | train_loss : 1.4038
	speed: 0.032251s/iter; left time: 3032.297432s
	iters: 1910, epoch: 1 | train_loss : 1.4391
	speed: 0.030205s/iter; left time: 2828.394682s
data: {'predict': array([140.18517474, 137.89452201, 135.7907524 , ..., 145.81915512,
       143.01704994, 143.98185399]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 11:58:28] [32mIntermediate result: 0.4999808967113495  (Index 0)[0m
Epoch: 1 | cost time: 211.76782846450806 | valid_loss: 0.4999808967113495 | valid_loss_true: 24.13276294148893
Pretest loss in this epoch: 69.34016837733049
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 1.1176
	speed: 0.423405s/iter; left time: 39485.872297s
	iters: 764, epoch: 2 | train_loss : 0.6456
	speed: 0.033463s/iter; left time: 3107.863157s
	iters: 1146, epoch: 2 | train_loss : 1.3223
	speed: 0.033343s/iter; left time: 3084.055377s
	iters: 1528, epoch: 2 | train_loss : 0.8346
	speed: 0.032367s/iter; left time: 2981.386899s
	iters: 1910, epoch: 2 | train_loss : 0.9274
	speed: 0.032004s/iter; left time: 2935.702302s
data: {'predict': array([138.13632081, 136.00171076, 133.870307  , ..., 144.51571188,
       142.15624849, 142.59841288]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:01:57] [32mIntermediate result: 0.5632694363594055  (Index 1)[0m
Epoch: 2 | cost time: 209.12018251419067 | valid_loss: 0.5632694363594055 | valid_loss_true: 25.83000827869098
Pretest loss in this epoch: 68.61205975459471
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0731
	speed: 0.413414s/iter; left time: 37764.106785s
	iters: 764, epoch: 3 | train_loss : 1.1368
	speed: 0.031673s/iter; left time: 2881.161594s
	iters: 1146, epoch: 3 | train_loss : 0.9631
	speed: 0.031998s/iter; left time: 2898.466995s
	iters: 1528, epoch: 3 | train_loss : 1.0107
	speed: 0.031575s/iter; left time: 2848.061905s
	iters: 1910, epoch: 3 | train_loss : 0.7090
	speed: 0.030793s/iter; left time: 2765.791838s
data: {'predict': array([137.38032476, 134.78182772, 133.20920721, ..., 144.06399059,
       141.35926524, 141.82270119]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:05:25] [32mIntermediate result: 0.5595057010650635  (Index 2)[0m
Epoch: 3 | cost time: 208.0032389163971 | valid_loss: 0.5595057010650635 | valid_loss_true: 26.467338901841853
Pretest loss in this epoch: 68.35454376037308
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.9121
	speed: 0.430719s/iter; left time: 38521.754833s
	iters: 764, epoch: 4 | train_loss : 1.0851
	speed: 0.042774s/iter; left time: 3809.176073s
	iters: 1146, epoch: 4 | train_loss : 1.0087
	speed: 0.040632s/iter; left time: 3602.959346s
	iters: 1528, epoch: 4 | train_loss : 1.1830
	speed: 0.040580s/iter; left time: 3582.784223s
	iters: 1910, epoch: 4 | train_loss : 1.0255
	speed: 0.038059s/iter; left time: 3345.675205s
data: {'predict': array([136.43631612, 133.80856337, 131.83990688, ..., 142.70815681,
       140.95703702, 140.87289286]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:09:23] [32mIntermediate result: 0.5859230160713196  (Index 3)[0m
Epoch: 4 | cost time: 238.03199076652527 | valid_loss: 0.5859230160713196 | valid_loss_true: 27.35921632244903
Pretest loss in this epoch: 68.00563097384554
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 1.4906
	speed: 0.458445s/iter; left time: 40125.437281s
	iters: 764, epoch: 5 | train_loss : 0.6992
	speed: 0.039948s/iter; left time: 3481.185928s
	iters: 1146, epoch: 5 | train_loss : 1.1734
	speed: 0.041113s/iter; left time: 3566.994619s
	iters: 1528, epoch: 5 | train_loss : 1.2629
	speed: 0.040973s/iter; left time: 3539.189720s
	iters: 1910, epoch: 5 | train_loss : 0.9321
	speed: 0.040597s/iter; left time: 3491.186023s
data: {'predict': array([138.70249961, 136.16464963, 134.38353689, ..., 144.7865664 ,
       142.81106431, 142.84893792]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:13:23] [32mIntermediate result: 0.5348397493362427  (Index 4)[0m
Epoch: 5 | cost time: 239.59090495109558 | valid_loss: 0.5348397493362427 | valid_loss_true: 25.31777395144336
Pretest loss in this epoch: 68.82577582135072
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.1077
	speed: 0.464407s/iter; left time: 39759.768972s
	iters: 764, epoch: 6 | train_loss : 1.1580
	speed: 0.038926s/iter; left time: 3317.710595s
	iters: 1146, epoch: 6 | train_loss : 1.0099
	speed: 0.039983s/iter; left time: 3392.528619s
	iters: 1528, epoch: 6 | train_loss : 1.0738
	speed: 0.040492s/iter; left time: 3420.279922s
	iters: 1910, epoch: 6 | train_loss : 0.8928
	speed: 0.041733s/iter; left time: 3509.149989s
data: {'predict': array([137.45074952, 134.82315657, 132.97569749, ..., 143.63721892,
       141.67986668, 142.17534889]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:17:22] [32mIntermediate result: 0.5670701861381531  (Index 5)[0m
Epoch: 6 | cost time: 239.67448687553406 | valid_loss: 0.5670701861381531 | valid_loss_true: 26.363736341230325
Pretest loss in this epoch: 68.39596478057193
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 1.1709
	speed: 0.465944s/iter; left time: 39000.899082s
	iters: 764, epoch: 7 | train_loss : 0.8249
	speed: 0.042172s/iter; left time: 3513.781390s
	iters: 1146, epoch: 7 | train_loss : 0.9571
	speed: 0.040787s/iter; left time: 3382.833898s
	iters: 1528, epoch: 7 | train_loss : 0.8054
	speed: 0.041457s/iter; left time: 3422.584270s
	iters: 1910, epoch: 7 | train_loss : 1.0441
	speed: 0.042302s/iter; left time: 3476.147357s
data: {'predict': array([137.81799206, 135.51455655, 133.70948909, ..., 143.56280513,
       142.01429824, 142.37711491]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:21:23] [32mIntermediate result: 0.5403131246566772  (Index 6)[0m
Epoch: 7 | cost time: 240.94464659690857 | valid_loss: 0.5403131246566772 | valid_loss_true: 26.046957231671517
Pretest loss in this epoch: 68.52455453503349
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 1.7951
	speed: 0.468983s/iter; left time: 38359.062527s
	iters: 764, epoch: 8 | train_loss : 1.0738
	speed: 0.039768s/iter; left time: 3237.472835s
	iters: 1146, epoch: 8 | train_loss : 0.9272
	speed: 0.040466s/iter; left time: 3278.905671s
	iters: 1528, epoch: 8 | train_loss : 1.1458
	speed: 0.039482s/iter; left time: 3184.040909s
	iters: 1910, epoch: 8 | train_loss : 1.3599
	speed: 0.039286s/iter; left time: 3153.273341s
data: {'predict': array([136.95404211, 135.32920026, 133.49820136, ..., 142.23191039,
       141.36003949, 141.45916386]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:25:23] [32mIntermediate result: 0.5589951872825623  (Index 7)[0m
Epoch: 8 | cost time: 239.4385221004486 | valid_loss: 0.5589951872825623 | valid_loss_true: 26.78144284996432
Pretest loss in this epoch: 68.23299395191457
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.8426
	speed: 0.463157s/iter; left time: 36997.431033s
	iters: 764, epoch: 9 | train_loss : 1.1420
	speed: 0.038804s/iter; left time: 3084.853243s
	iters: 1146, epoch: 9 | train_loss : 1.1842
	speed: 0.040202s/iter; left time: 3180.680329s
	iters: 1528, epoch: 9 | train_loss : 0.9854
	speed: 0.040813s/iter; left time: 3213.384413s
	iters: 1910, epoch: 9 | train_loss : 0.7675
	speed: 0.041170s/iter; left time: 3225.796514s
data: {'predict': array([136.90730124, 136.33870906, 134.12704985, ..., 141.103441  ,
       141.72619928, 141.28367032]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-10 12:29:21] [32mIntermediate result: 0.5613594055175781  (Index 8)[0m
Epoch: 9 | cost time: 238.47508311271667 | valid_loss: 0.5613594055175781 | valid_loss_true: 26.529782910852504
Pretest loss in this epoch: 68.34254340059094
Early stop with best valid_loss: 0.5613594055175781
[2024-03-10 12:29:21] [32mFinal result: 0.4999808967113495[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ› --target_cols 1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ› --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/randseries/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/randseries/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ›', target_cols='1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ›', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-10 12:29:27.245020: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-10 12:29:27.245092: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-10 12:29:27.246868: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-10 12:29:27.255973: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-10 12:29:28.280817: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆè’¸å‘å™¨æ±½å®¤åŽ‹åŠ›
	iters: 382, epoch: 1 | train_loss : 1.1726
	speed: 0.048564s/iter; left time: 4621.749090s
	iters: 764, epoch: 1 | train_loss : 1.4535
	speed: 0.039277s/iter; left time: 3722.965914s
	iters: 1146, epoch: 1 | train_loss : 1.2467
	speed: 0.039889s/iter; left time: 3765.717319s
	iters: 1528, epoch: 1 | train_loss : 1.2487
	speed: 0.039349s/iter; left time: 3699.666005s
	iters: 1910, epoch: 1 | train_loss : 1.3391
	speed: 0.038054s/iter; left time: 3563.374698s
data: {'predict': array([0.39959699, 0.38949078, 0.38153948, ..., 0.42297924, 0.41158574,
       0.4149079 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:33:29] [32mIntermediate result: 0.5991419553756714  (Index 0)[0m
Epoch: 1 | cost time: 234.28233242034912 | valid_loss: 0.5991419553756714 | valid_loss_true: 0.12043797531726949
Pretest loss in this epoch: 0.3037517784140708
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 1.0409
	speed: 0.455354s/iter; left time: 42465.370936s
	iters: 764, epoch: 2 | train_loss : 0.7710
	speed: 0.040946s/iter; left time: 3802.911296s
	iters: 1146, epoch: 2 | train_loss : 1.1588
	speed: 0.043218s/iter; left time: 3997.366820s
	iters: 1528, epoch: 2 | train_loss : 0.9758
	speed: 0.042431s/iter; left time: 3908.359259s
	iters: 1910, epoch: 2 | train_loss : 0.9924
	speed: 0.039472s/iter; left time: 3620.795943s
data: {'predict': array([0.38203031, 0.37260997, 0.36421963, ..., 0.4090522 , 0.39995001,
       0.40155873]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:37:27] [32mIntermediate result: 0.6958521604537964  (Index 1)[0m
Epoch: 2 | cost time: 237.3537254333496 | valid_loss: 0.6958521604537964 | valid_loss_true: 0.13498176528586733
Pretest loss in this epoch: 0.30054361783134076
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0845
	speed: 0.454626s/iter; left time: 41528.758313s
	iters: 764, epoch: 3 | train_loss : 1.1663
	speed: 0.041919s/iter; left time: 3813.139170s
	iters: 1146, epoch: 3 | train_loss : 1.0797
	speed: 0.040846s/iter; left time: 3699.934972s
	iters: 1528, epoch: 3 | train_loss : 1.0106
	speed: 0.040556s/iter; left time: 3658.200778s
	iters: 1910, epoch: 3 | train_loss : 0.8546
	speed: 0.041731s/iter; left time: 3748.231975s
data: {'predict': array([0.38608433, 0.37506172, 0.36795381, ..., 0.41388248, 0.4021849 ,
       0.40451153]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:41:25] [32mIntermediate result: 0.6657378673553467  (Index 2)[0m
Epoch: 3 | cost time: 238.62394952774048 | valid_loss: 0.6657378673553467 | valid_loss_true: 0.13117924198911654
Pretest loss in this epoch: 0.3012721200043364
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.9500
	speed: 0.462033s/iter; left time: 41322.385256s
	iters: 764, epoch: 4 | train_loss : 1.0206
	speed: 0.040633s/iter; left time: 3618.527903s
	iters: 1146, epoch: 4 | train_loss : 1.0426
	speed: 0.039494s/iter; left time: 3501.976896s
	iters: 1528, epoch: 4 | train_loss : 1.1236
	speed: 0.041307s/iter; left time: 3646.991831s
	iters: 1910, epoch: 4 | train_loss : 1.1781
	speed: 0.041014s/iter; left time: 3605.455399s
data: {'predict': array([0.38427962, 0.37365893, 0.36526156, ..., 0.41095945, 0.40280303,
       0.40293447]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:45:24] [32mIntermediate result: 0.6780411601066589  (Index 3)[0m
Epoch: 4 | cost time: 238.9115080833435 | valid_loss: 0.6780411601066589 | valid_loss_true: 0.13236033802555827
Pretest loss in this epoch: 0.3010405529033114
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 1.3268
	speed: 0.459911s/iter; left time: 40253.712737s
	iters: 764, epoch: 5 | train_loss : 0.9679
	speed: 0.040553s/iter; left time: 3533.874397s
	iters: 1146, epoch: 5 | train_loss : 1.2753
	speed: 0.040264s/iter; left time: 3493.320954s
	iters: 1528, epoch: 5 | train_loss : 1.1513
	speed: 0.040532s/iter; left time: 3501.112423s
	iters: 1910, epoch: 5 | train_loss : 0.9285
	speed: 0.040636s/iter; left time: 3494.547005s
data: {'predict': array([0.39192438, 0.38157935, 0.3735655 , ..., 0.41759767, 0.4087336 ,
       0.40868751]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:49:20] [32mIntermediate result: 0.6402226090431213  (Index 4)[0m
Epoch: 5 | cost time: 235.27467513084412 | valid_loss: 0.6402226090431213 | valid_loss_true: 0.1264191132524504
Pretest loss in this epoch: 0.3022859672195447
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.0337
	speed: 0.454446s/iter; left time: 38906.916169s
	iters: 764, epoch: 6 | train_loss : 1.2714
	speed: 0.040868s/iter; left time: 3483.220380s
	iters: 1146, epoch: 6 | train_loss : 1.0753
	speed: 0.040032s/iter; left time: 3396.752943s
	iters: 1528, epoch: 6 | train_loss : 1.0064
	speed: 0.041254s/iter; left time: 3484.676129s
	iters: 1910, epoch: 6 | train_loss : 0.8329
	speed: 0.040615s/iter; left time: 3415.178923s
data: {'predict': array([0.38740175, 0.37684329, 0.36746996, ..., 0.41269126, 0.40470677,
       0.40611958]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:53:16] [32mIntermediate result: 0.6682828068733215  (Index 5)[0m
Epoch: 6 | cost time: 236.77606058120728 | valid_loss: 0.6682828068733215 | valid_loss_true: 0.12986328688283574
Pretest loss in this epoch: 0.30153260162235246
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 1.0501
	speed: 0.461495s/iter; left time: 38628.482083s
	iters: 764, epoch: 7 | train_loss : 0.9258
	speed: 0.040959s/iter; left time: 3412.720758s
	iters: 1146, epoch: 7 | train_loss : 1.0286
	speed: 0.039860s/iter; left time: 3305.945292s
	iters: 1528, epoch: 7 | train_loss : 0.8477
	speed: 0.038824s/iter; left time: 3205.188818s
	iters: 1910, epoch: 7 | train_loss : 1.0049
	speed: 0.038104s/iter; left time: 3131.168393s
data: {'predict': array([0.38992293, 0.38141287, 0.36941787, ..., 0.41286277, 0.40654071,
       0.4067181 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 12:57:13] [32mIntermediate result: 0.6409372687339783  (Index 6)[0m
Epoch: 7 | cost time: 237.09491968154907 | valid_loss: 0.6409372687339783 | valid_loss_true: 0.12805203504940438
Pretest loss in this epoch: 0.3019099181671137
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 1.4756
	speed: 0.459158s/iter; left time: 37555.464860s
	iters: 764, epoch: 8 | train_loss : 1.1314
	speed: 0.039510s/iter; left time: 3216.514826s
	iters: 1146, epoch: 8 | train_loss : 1.0811
	speed: 0.041950s/iter; left time: 3399.143809s
	iters: 1528, epoch: 8 | train_loss : 1.1018
	speed: 0.038933s/iter; left time: 3139.753523s
	iters: 1910, epoch: 8 | train_loss : 1.2890
	speed: 0.038595s/iter; left time: 3097.808756s
data: {'predict': array([0.38566874, 0.38186812, 0.36471764, ..., 0.4057511 , 0.40223974,
       0.39981543]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 13:01:09] [32mIntermediate result: 0.6639348268508911  (Index 7)[0m
Epoch: 8 | cost time: 235.10711884498596 | valid_loss: 0.6639348268508911 | valid_loss_true: 0.13194650058667445
Pretest loss in this epoch: 0.3011031014412612
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.9681
	speed: 0.456470s/iter; left time: 36463.300625s
	iters: 764, epoch: 9 | train_loss : 1.0546
	speed: 0.039819s/iter; left time: 3165.568718s
	iters: 1146, epoch: 9 | train_loss : 1.0681
	speed: 0.042029s/iter; left time: 3325.230225s
	iters: 1528, epoch: 9 | train_loss : 0.8661
	speed: 0.040632s/iter; left time: 3199.185937s
	iters: 1910, epoch: 9 | train_loss : 0.9962
	speed: 0.037204s/iter; left time: 2915.068561s
data: {'predict': array([0.38664828, 0.38580139, 0.36362275, ..., 0.4015744 , 0.40309404,
       0.39676537]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-10 13:05:03] [32mIntermediate result: 0.66739422082901  (Index 8)[0m
Epoch: 9 | cost time: 234.80644249916077 | valid_loss: 0.66739422082901 | valid_loss_true: 0.13158205059186676
Pretest loss in this epoch: 0.30120851902317447
Early stop with best valid_loss: 0.66739422082901
[2024-03-10 13:05:03] [32mFinal result: 0.5991419553756714[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --target_cols 1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/randseries/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/randseries/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦', target_cols='1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-10 13:05:09.860784: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-10 13:05:09.860845: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-10 13:05:09.862508: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-10 13:05:09.870822: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-10 13:05:10.915138: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆåŽŸæ¶²æ¢çƒ­å‰æ¸©åº¦
	iters: 382, epoch: 1 | train_loss : 1.1895
	speed: 0.048095s/iter; left time: 4577.174769s
	iters: 764, epoch: 1 | train_loss : 1.4208
	speed: 0.044017s/iter; left time: 4172.205809s
	iters: 1146, epoch: 1 | train_loss : 0.9939
	speed: 0.039357s/iter; left time: 3715.482147s
	iters: 1528, epoch: 1 | train_loss : 1.4395
	speed: 0.036390s/iter; left time: 3421.510877s
	iters: 1910, epoch: 1 | train_loss : 1.3915
	speed: 0.038199s/iter; left time: 3576.980726s
data: {'predict': array([122.50293843, 120.62423288, 118.8150047 , ..., 127.23657141,
       124.8636853 , 125.74039569]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:09:12] [32mIntermediate result: 0.47144362330436707  (Index 0)[0m
Epoch: 1 | cost time: 233.33273935317993 | valid_loss: 0.47144362330436707 | valid_loss_true: 19.064155277376667
Pretest loss in this epoch: 56.70463325676505
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 1.1995
	speed: 0.451739s/iter; left time: 42128.242988s
	iters: 764, epoch: 2 | train_loss : 0.6444
	speed: 0.040780s/iter; left time: 3787.482182s
	iters: 1146, epoch: 2 | train_loss : 1.4074
	speed: 0.040829s/iter; left time: 3776.405722s
	iters: 1528, epoch: 2 | train_loss : 0.7408
	speed: 0.040855s/iter; left time: 3763.226116s
	iters: 1910, epoch: 2 | train_loss : 0.8905
	speed: 0.041572s/iter; left time: 3813.444019s
data: {'predict': array([121.34927698, 119.55077336, 117.80067045, ..., 126.61467434,
       124.63445058, 125.04115197]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:13:08] [32mIntermediate result: 0.5217811465263367  (Index 1)[0m
Epoch: 2 | cost time: 235.8590841293335 | valid_loss: 0.5217811465263367 | valid_loss_true: 19.943803146126772
Pretest loss in this epoch: 56.28223705470414
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0395
	speed: 0.452395s/iter; left time: 41324.953181s
	iters: 764, epoch: 3 | train_loss : 1.1057
	speed: 0.039892s/iter; left time: 3628.778453s
	iters: 1146, epoch: 3 | train_loss : 0.9081
	speed: 0.040792s/iter; left time: 3695.026309s
	iters: 1528, epoch: 3 | train_loss : 1.0738
	speed: 0.038793s/iter; left time: 3499.189991s
	iters: 1910, epoch: 3 | train_loss : 0.6415
	speed: 0.040903s/iter; left time: 3673.902855s
data: {'predict': array([120.66348056, 118.49530651, 117.20505404, ..., 126.22240019,
       123.97699702, 124.33358509]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:17:00] [32mIntermediate result: 0.5191803574562073  (Index 2)[0m
Epoch: 3 | cost time: 232.50147676467896 | valid_loss: 0.5191803574562073 | valid_loss_true: 20.536387450863685
Pretest loss in this epoch: 56.01085990528762
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.8696
	speed: 0.450767s/iter; left time: 40314.805087s
	iters: 764, epoch: 4 | train_loss : 1.1036
	speed: 0.040233s/iter; left time: 3582.915177s
	iters: 1146, epoch: 4 | train_loss : 1.0427
	speed: 0.040291s/iter; left time: 3572.709710s
	iters: 1528, epoch: 4 | train_loss : 1.1428
	speed: 0.041504s/iter; left time: 3664.424518s
	iters: 1910, epoch: 4 | train_loss : 0.9354
	speed: 0.039479s/iter; left time: 3470.544383s
data: {'predict': array([119.59277103, 117.36726834, 115.78551036, ..., 124.85541693,
       123.35734023, 123.2577875 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:20:56] [32mIntermediate result: 0.5522110462188721  (Index 3)[0m
Epoch: 4 | cost time: 235.57948660850525 | valid_loss: 0.5522110462188721 | valid_loss_true: 21.56576016374729
Pretest loss in this epoch: 55.55663484538542
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 1.5155
	speed: 0.452427s/iter; left time: 39598.681666s
	iters: 764, epoch: 5 | train_loss : 0.6234
	speed: 0.039341s/iter; left time: 3428.325428s
	iters: 1146, epoch: 5 | train_loss : 1.1884
	speed: 0.039149s/iter; left time: 3396.589473s
	iters: 1528, epoch: 5 | train_loss : 1.2350
	speed: 0.040542s/iter; left time: 3501.994907s
	iters: 1910, epoch: 5 | train_loss : 0.9288
	speed: 0.043513s/iter; left time: 3741.973373s
data: {'predict': array([121.60422195, 119.48341845, 118.04045227, ..., 126.69251581,
       124.99189812, 125.07319751]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:24:53] [32mIntermediate result: 0.49790406227111816  (Index 4)[0m
Epoch: 5 | cost time: 236.96377158164978 | valid_loss: 0.49790406227111816 | valid_loss_true: 19.732588672474748
Pretest loss in this epoch: 56.38172808685411
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 1.1142
	speed: 0.461727s/iter; left time: 39530.270106s
	iters: 764, epoch: 6 | train_loss : 1.1679
	speed: 0.040594s/iter; left time: 3459.946468s
	iters: 1146, epoch: 6 | train_loss : 0.9708
	speed: 0.040181s/iter; left time: 3409.344627s
	iters: 1528, epoch: 6 | train_loss : 1.1100
	speed: 0.040408s/iter; left time: 3413.212332s
	iters: 1910, epoch: 6 | train_loss : 0.9489
	speed: 0.038687s/iter; left time: 3253.016775s
data: {'predict': array([120.60067867, 118.39372924, 116.9639174 , ..., 125.79342026,
       124.05567382, 124.59001072]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:28:51] [32mIntermediate result: 0.5298537611961365  (Index 5)[0m
Epoch: 6 | cost time: 238.02587747573853 | valid_loss: 0.5298537611961365 | valid_loss_true: 20.56976366552452
Pretest loss in this epoch: 55.99580475921054
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 1.1829
	speed: 0.459262s/iter; left time: 38441.611706s
	iters: 764, epoch: 7 | train_loss : 0.7618
	speed: 0.038334s/iter; left time: 3194.047510s
	iters: 1146, epoch: 7 | train_loss : 0.9096
	speed: 0.038631s/iter; left time: 3204.047657s
	iters: 1528, epoch: 7 | train_loss : 0.8144
	speed: 0.039291s/iter; left time: 3243.721107s
	iters: 1910, epoch: 7 | train_loss : 0.9894
	speed: 0.038809s/iter; left time: 3189.166749s
data: {'predict': array([120.7798687 , 118.83241418, 117.49843372, ..., 125.63683483,
       124.20831769, 124.69646869]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:32:45] [32mIntermediate result: 0.5067093372344971  (Index 6)[0m
Epoch: 7 | cost time: 233.98105716705322 | valid_loss: 0.5067093372344971 | valid_loss_true: 20.417111801338955
Pretest loss in this epoch: 56.06590182063474
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 1.9080
	speed: 0.456855s/iter; left time: 37367.054552s
	iters: 764, epoch: 8 | train_loss : 1.0373
	speed: 0.040237s/iter; left time: 3275.699696s
	iters: 1146, epoch: 8 | train_loss : 0.9018
	speed: 0.039953s/iter; left time: 3237.307760s
	iters: 1528, epoch: 8 | train_loss : 1.1588
	speed: 0.038579s/iter; left time: 3111.227556s
	iters: 1910, epoch: 8 | train_loss : 1.4069
	speed: 0.035591s/iter; left time: 2856.683591s
data: {'predict': array([120.2915021 , 118.80407927, 117.63528793, ..., 124.77486626,
       123.81146165, 124.25412186]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:36:40] [32mIntermediate result: 0.5199390649795532  (Index 7)[0m
Epoch: 8 | cost time: 234.9805555343628 | valid_loss: 0.5199390649795532 | valid_loss_true: 20.81385644155148
Pretest loss in this epoch: 55.89002261565731
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.7890
	speed: 0.463120s/iter; left time: 36994.460593s
	iters: 764, epoch: 9 | train_loss : 1.1495
	speed: 0.039788s/iter; left time: 3163.109457s
	iters: 1146, epoch: 9 | train_loss : 1.2484
	speed: 0.042740s/iter; left time: 3381.453063s
	iters: 1528, epoch: 9 | train_loss : 1.0707
	speed: 0.039414s/iter; left time: 3103.294864s
	iters: 1910, epoch: 9 | train_loss : 0.6219
	speed: 0.037142s/iter; left time: 2910.210229s
data: {'predict': array([120.10877433, 119.43028814, 118.33215943, ..., 123.83736659,
       123.97242279, 124.317671  ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-10 13:40:34] [32mIntermediate result: 0.5244573950767517  (Index 8)[0m
Epoch: 9 | cost time: 233.61949586868286 | valid_loss: 0.5244573950767517 | valid_loss_true: 20.68290499057386
Pretest loss in this epoch: 55.95706145166534
Early stop with best valid_loss: 0.5244573950767517
[2024-03-10 13:40:34] [32mFinal result: 0.47144362330436707[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_patchtst --model_name alumina_patchtst --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆå‡ºæ–™æ¸©åº¦ --target_cols 1æ•ˆå‡ºæ–™æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/randseries/patchtst --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_patchtst/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_patchtst/STANDALONE', log_path='log', checkpoints='./checkpoints/randseries/patchtst', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆå‡ºæ–™æ¸©åº¦', target_cols='1æ•ˆå‡ºæ–™æ¸©åº¦', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_patchtst', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-10 13:40:40.849761: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-10 13:40:40.849824: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-10 13:40:40.851566: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-10 13:40:40.859844: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-10 13:40:41.919487: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  Rand0,Rand1,Rand2,Rand3,Rand4,Rand5,Rand6,Rand7,Rand8,Rand9,1æ•ˆå‡ºæ–™æ¸©åº¦
	iters: 382, epoch: 1 | train_loss : 0.0410
	speed: 0.046164s/iter; left time: 4393.424860s
	iters: 764, epoch: 1 | train_loss : 0.0461
	speed: 0.038975s/iter; left time: 3694.318273s
	iters: 1146, epoch: 1 | train_loss : 0.0304
	speed: 0.040724s/iter; left time: 3844.550376s
	iters: 1528, epoch: 1 | train_loss : 0.0428
	speed: 0.040309s/iter; left time: 3789.957945s
	iters: 1910, epoch: 1 | train_loss : 0.0304
	speed: 0.040025s/iter; left time: 3747.985191s
data: {'predict': array([148.8375868 , 148.77932776, 148.74698454, ..., 148.98573092,
       148.92267654, 148.93288417]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 13:44:44] [32mIntermediate result: 0.18699496984481812  (Index 0)[0m
Epoch: 1 | cost time: 234.11155891418457 | valid_loss: 0.18699496984481812 | valid_loss_true: 0.18683706805693337
Pretest loss in this epoch: 14.47229245594988
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0321
	speed: 0.451644s/iter; left time: 42119.419466s
	iters: 764, epoch: 2 | train_loss : 0.0360
	speed: 0.039339s/iter; left time: 3653.622011s
	iters: 1146, epoch: 2 | train_loss : 0.0353
	speed: 0.040784s/iter; left time: 3772.278654s
	iters: 1528, epoch: 2 | train_loss : 0.0306
	speed: 0.040422s/iter; left time: 3723.322076s
	iters: 1910, epoch: 2 | train_loss : 0.0367
	speed: 0.041391s/iter; left time: 3796.810807s
data: {'predict': array([148.83309052, 148.77046287, 148.74350119, ..., 148.96827596,
       148.91829037, 148.92311151]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 13:48:43] [32mIntermediate result: 0.1861717849969864  (Index 1)[0m
Epoch: 2 | cost time: 239.44432926177979 | valid_loss: 0.1861717849969864 | valid_loss_true: 0.18642124010500366
Pretest loss in this epoch: 14.470315862097804
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0333
	speed: 0.466022s/iter; left time: 42569.721293s
	iters: 764, epoch: 3 | train_loss : 0.0346
	speed: 0.040645s/iter; left time: 3697.288283s
	iters: 1146, epoch: 3 | train_loss : 0.0388
	speed: 0.041470s/iter; left time: 3756.499987s
	iters: 1528, epoch: 3 | train_loss : 0.0236
	speed: 0.038313s/iter; left time: 3455.867196s
	iters: 1910, epoch: 3 | train_loss : 0.0339
	speed: 0.044069s/iter; left time: 3958.244157s
data: {'predict': array([148.89186851, 148.70432378, 148.78595546, ..., 148.84868197,
       148.90101697, 148.80105885]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 13:52:45] [32mIntermediate result: 0.16801483929157257  (Index 2)[0m
Epoch: 3 | cost time: 241.89392805099487 | valid_loss: 0.16801483929157257 | valid_loss_true: 0.16796006436466485
Pretest loss in this epoch: 14.466790893956057
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0245
	speed: 0.465865s/iter; left time: 41665.095197s
	iters: 764, epoch: 4 | train_loss : 0.0234
	speed: 0.043965s/iter; left time: 3915.302142s
	iters: 1146, epoch: 4 | train_loss : 0.0270
	speed: 0.042452s/iter; left time: 3764.313281s
	iters: 1528, epoch: 4 | train_loss : 0.0269
	speed: 0.040852s/iter; left time: 3606.786431s
	iters: 1910, epoch: 4 | train_loss : 0.0226
	speed: 0.040503s/iter; left time: 3560.504318s
data: {'predict': array([148.88848376, 148.81387215, 148.83333201, ..., 148.83100546,
       148.87306357, 148.79862874]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 13:56:43] [32mIntermediate result: 0.16052532196044922  (Index 3)[0m
Epoch: 4 | cost time: 238.3603446483612 | valid_loss: 0.16052532196044922 | valid_loss_true: 0.16091224708403715
Pretest loss in this epoch: 14.484949003546436
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0324
	speed: 0.459790s/iter; left time: 40243.143031s
	iters: 764, epoch: 5 | train_loss : 0.0279
	speed: 0.040748s/iter; left time: 3550.941973s
	iters: 1146, epoch: 5 | train_loss : 0.0257
	speed: 0.039558s/iter; left time: 3432.093801s
	iters: 1528, epoch: 5 | train_loss : 0.0295
	speed: 0.039285s/iter; left time: 3393.403551s
	iters: 1910, epoch: 5 | train_loss : 0.0215
	speed: 0.040102s/iter; left time: 3448.663396s
data: {'predict': array([148.85928613, 148.82507102, 148.80720958, ..., 148.80605633,
       148.81975682, 148.79366102]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:00:40] [32mIntermediate result: 0.15570387244224548  (Index 4)[0m
Epoch: 5 | cost time: 236.25523114204407 | valid_loss: 0.15570387244224548 | valid_loss_true: 0.1554565176765649
Pretest loss in this epoch: 14.471291741364231
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0267
	speed: 0.456149s/iter; left time: 39052.714850s
	iters: 764, epoch: 6 | train_loss : 0.0157
	speed: 0.039137s/iter; left time: 3335.703628s
	iters: 1146, epoch: 6 | train_loss : 0.0170
	speed: 0.041263s/iter; left time: 3501.171524s
	iters: 1528, epoch: 6 | train_loss : 0.0302
	speed: 0.038489s/iter; left time: 3251.105065s
	iters: 1910, epoch: 6 | train_loss : 0.0233
	speed: 0.040516s/iter; left time: 3406.825921s
data: {'predict': array([148.87887531, 148.83109214, 148.81645634, ..., 148.81707152,
       148.8483947 , 148.80234388]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:04:35] [32mIntermediate result: 0.15436336398124695  (Index 5)[0m
Epoch: 6 | cost time: 234.98746395111084 | valid_loss: 0.15436336398124695 | valid_loss_true: 0.15436659888981732
Pretest loss in this epoch: 14.477942226172983
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0239
	speed: 0.455945s/iter; left time: 38163.958064s
	iters: 764, epoch: 7 | train_loss : 0.0275
	speed: 0.038747s/iter; left time: 3228.417451s
	iters: 1146, epoch: 7 | train_loss : 0.0256
	speed: 0.039455s/iter; left time: 3272.384388s
	iters: 1528, epoch: 7 | train_loss : 0.0261
	speed: 0.039801s/iter; left time: 3285.854686s
	iters: 1910, epoch: 7 | train_loss : 0.0210
	speed: 0.039438s/iter; left time: 3240.818257s
data: {'predict': array([148.85221128, 148.8341044 , 148.81065561, ..., 148.80776442,
       148.83539664, 148.79277072]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:08:29] [32mIntermediate result: 0.1526390165090561  (Index 6)[0m
Epoch: 7 | cost time: 234.43002581596375 | valid_loss: 0.1526390165090561 | valid_loss_true: 0.15252777031438505
Pretest loss in this epoch: 14.473033883322731
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0322
	speed: 0.457002s/iter; left time: 37379.094161s
	iters: 764, epoch: 8 | train_loss : 0.0226
	speed: 0.039303s/iter; left time: 3199.693310s
	iters: 1146, epoch: 8 | train_loss : 0.0285
	speed: 0.043079s/iter; left time: 3490.579258s
	iters: 1528, epoch: 8 | train_loss : 0.0261
	speed: 0.037731s/iter; left time: 3042.886209s
	iters: 1910, epoch: 8 | train_loss : 0.0211
	speed: 0.040556s/iter; left time: 3255.187348s
data: {'predict': array([148.86223866, 148.85831169, 148.82505369, ..., 148.82010365,
       148.83870675, 148.80515315]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:12:25] [32mIntermediate result: 0.1520584523677826  (Index 7)[0m
Epoch: 8 | cost time: 235.4039077758789 | valid_loss: 0.1520584523677826 | valid_loss_true: 0.15200443769271677
Pretest loss in this epoch: 14.480284486863063
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0210
	speed: 0.456597s/iter; left time: 36473.462789s
	iters: 764, epoch: 9 | train_loss : 0.0261
	speed: 0.040141s/iter; left time: 3191.197208s
	iters: 1146, epoch: 9 | train_loss : 0.0197
	speed: 0.038946s/iter; left time: 3081.316760s
	iters: 1528, epoch: 9 | train_loss : 0.0251
	speed: 0.036770s/iter; left time: 2895.111101s
	iters: 1910, epoch: 9 | train_loss : 0.0261
	speed: 0.038942s/iter; left time: 3051.229079s
data: {'predict': array([148.87951798, 148.84838237, 148.8336777 , ..., 148.81896893,
       148.84059282, 148.79585853]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:16:16] [32mIntermediate result: 0.15147452056407928  (Index 8)[0m
Epoch: 9 | cost time: 231.85096979141235 | valid_loss: 0.15147452056407928 | valid_loss_true: 0.151360570622363
Pretest loss in this epoch: 14.480498139686121
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0322
	speed: 0.450997s/iter; left time: 35164.262706s
	iters: 764, epoch: 10 | train_loss : 0.0321
	speed: 0.040239s/iter; left time: 3122.056961s
	iters: 1146, epoch: 10 | train_loss : 0.0180
	speed: 0.039394s/iter; left time: 3041.451270s
	iters: 1528, epoch: 10 | train_loss : 0.0261
	speed: 0.039148s/iter; left time: 3007.489834s
	iters: 1910, epoch: 10 | train_loss : 0.0297
	speed: 0.040082s/iter; left time: 3063.917352s
data: {'predict': array([148.86092497, 148.82732098, 148.81142402, ..., 148.81374789,
       148.82611892, 148.80147135]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:20:11] [32mIntermediate result: 0.15061859786510468  (Index 9)[0m
Epoch: 10 | cost time: 234.27659344673157 | valid_loss: 0.15061859786510468 | valid_loss_true: 0.15055919118775896
Pretest loss in this epoch: 14.472036256729984
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0261
	speed: 0.455567s/iter; left time: 34650.005756s
	iters: 764, epoch: 11 | train_loss : 0.0219
	speed: 0.040554s/iter; left time: 3068.988891s
	iters: 1146, epoch: 11 | train_loss : 0.0235
	speed: 0.041216s/iter; left time: 3103.386650s
	iters: 1528, epoch: 11 | train_loss : 0.0313
	speed: 0.039936s/iter; left time: 2991.710757s
	iters: 1910, epoch: 11 | train_loss : 0.0236
	speed: 0.042492s/iter; left time: 3166.975595s
data: {'predict': array([148.84595014, 148.82340392, 148.80635607, ..., 148.80541537,
       148.82440038, 148.79791349]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:24:08] [32mIntermediate result: 0.15015900135040283  (Index 10)[0m
Epoch: 11 | cost time: 237.31192588806152 | valid_loss: 0.15015900135040283 | valid_loss_true: 0.15010210148494552
Pretest loss in this epoch: 14.469150098086065
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0255
	speed: 0.455183s/iter; left time: 33750.904213s
	iters: 764, epoch: 12 | train_loss : 0.0226
	speed: 0.043372s/iter; left time: 3199.354464s
	iters: 1146, epoch: 12 | train_loss : 0.0264
	speed: 0.042225s/iter; left time: 3098.642569s
	iters: 1528, epoch: 12 | train_loss : 0.0195
	speed: 0.038546s/iter; left time: 2813.957453s
	iters: 1910, epoch: 12 | train_loss : 0.0227
	speed: 0.040773s/iter; left time: 2960.955775s
data: {'predict': array([148.85939225, 148.83421365, 148.82379308, ..., 148.81409747,
       148.83466603, 148.81255032]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:28:03] [32mIntermediate result: 0.14995259046554565  (Index 11)[0m
Epoch: 12 | cost time: 235.42173743247986 | valid_loss: 0.14995259046554565 | valid_loss_true: 0.14990441103113944
Pretest loss in this epoch: 14.474301394194878
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-11.pth
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0272
	speed: 0.452539s/iter; left time: 32690.037216s
	iters: 764, epoch: 13 | train_loss : 0.0193
	speed: 0.037883s/iter; left time: 2722.081232s
	iters: 1146, epoch: 13 | train_loss : 0.0176
	speed: 0.041311s/iter; left time: 2952.608704s
	iters: 1528, epoch: 13 | train_loss : 0.0305
	speed: 0.042149s/iter; left time: 2996.441147s
	iters: 1910, epoch: 13 | train_loss : 0.0235
	speed: 0.040966s/iter; left time: 2896.665749s
data: {'predict': array([148.8606367 , 148.82877578, 148.82340688, ..., 148.80995848,
       148.83011513, 148.79793643]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:31:59] [32mIntermediate result: 0.1493503898382187  (Index 12)[0m
Epoch: 13 | cost time: 235.6084587574005 | valid_loss: 0.1493503898382187 | valid_loss_true: 0.14927532425766288
Pretest loss in this epoch: 14.472864649149962
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-12.pth
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0234
	speed: 0.455382s/iter; left time: 32025.227502s
	iters: 764, epoch: 14 | train_loss : 0.0284
	speed: 0.040028s/iter; left time: 2799.706192s
	iters: 1146, epoch: 14 | train_loss : 0.0180
	speed: 0.037985s/iter; left time: 2642.334343s
	iters: 1528, epoch: 14 | train_loss : 0.0273
	speed: 0.039585s/iter; left time: 2738.478940s
	iters: 1910, epoch: 14 | train_loss : 0.0201
	speed: 0.039466s/iter; left time: 2715.164674s
data: {'predict': array([148.86189049, 148.82055551, 148.82786655, ..., 148.81322526,
       148.83326129, 148.79664531]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:35:53] [32mIntermediate result: 0.14941100776195526  (Index 13)[0m
Epoch: 14 | cost time: 233.53317666053772 | valid_loss: 0.14941100776195526 | valid_loss_true: 0.1493536915806346
Pretest loss in this epoch: 14.473537652664856
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0236
	speed: 0.453777s/iter; left time: 31045.173860s
	iters: 764, epoch: 15 | train_loss : 0.0261
	speed: 0.038522s/iter; left time: 2620.768676s
	iters: 1146, epoch: 15 | train_loss : 0.0372
	speed: 0.037997s/iter; left time: 2570.524568s
	iters: 1528, epoch: 15 | train_loss : 0.0240
	speed: 0.039963s/iter; left time: 2688.238390s
	iters: 1910, epoch: 15 | train_loss : 0.0235
	speed: 0.041873s/iter; left time: 2800.775636s
data: {'predict': array([148.86316703, 148.8164449 , 148.82495327, ..., 148.81234064,
       148.83486309, 148.80906825]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:39:48] [32mIntermediate result: 0.1493023931980133  (Index 14)[0m
Epoch: 15 | cost time: 235.20883774757385 | valid_loss: 0.1493023931980133 | valid_loss_true: 0.14924729686449015
Pretest loss in this epoch: 14.476365169335793
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0202
	speed: 0.453953s/iter; left time: 30189.662810s
	iters: 764, epoch: 16 | train_loss : 0.0222
	speed: 0.041540s/iter; left time: 2746.731185s
	iters: 1146, epoch: 16 | train_loss : 0.0186
	speed: 0.041662s/iter; left time: 2738.846438s
	iters: 1528, epoch: 16 | train_loss : 0.0237
	speed: 0.040688s/iter; left time: 2659.305586s
	iters: 1910, epoch: 16 | train_loss : 0.0351
	speed: 0.040570s/iter; left time: 2636.073324s
data: {'predict': array([148.85918271, 148.81711783, 148.82364298, ..., 148.81556251,
       148.82982143, 148.80856115]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:43:44] [32mIntermediate result: 0.1491147130727768  (Index 15)[0m
Epoch: 16 | cost time: 236.46882557868958 | valid_loss: 0.1491147130727768 | valid_loss_true: 0.14910358129151316
Pretest loss in this epoch: 14.473671943636889
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-15.pth
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0225
	speed: 0.456068s/iter; left time: 29458.829729s
	iters: 764, epoch: 17 | train_loss : 0.0196
	speed: 0.040301s/iter; left time: 2587.763841s
	iters: 1146, epoch: 17 | train_loss : 0.0221
	speed: 0.039196s/iter; left time: 2501.810573s
	iters: 1528, epoch: 17 | train_loss : 0.0229
	speed: 0.040124s/iter; left time: 2545.771547s
	iters: 1910, epoch: 17 | train_loss : 0.0242
	speed: 0.039600s/iter; left time: 2497.390828s
data: {'predict': array([148.86971858, 148.81821667, 148.82928969, ..., 148.81849054,
       148.8359969 , 148.81165305]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:47:39] [32mIntermediate result: 0.1491675078868866  (Index 16)[0m
Epoch: 17 | cost time: 235.089777469635 | valid_loss: 0.1491675078868866 | valid_loss_true: 0.1491838988909912
Pretest loss in this epoch: 14.476349837829382
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0278
	speed: 0.460066s/iter; left time: 28837.837151s
	iters: 764, epoch: 18 | train_loss : 0.0205
	speed: 0.040350s/iter; left time: 2513.787131s
	iters: 1146, epoch: 18 | train_loss : 0.0237
	speed: 0.041912s/iter; left time: 2595.096525s
	iters: 1528, epoch: 18 | train_loss : 0.0239
	speed: 0.036798s/iter; left time: 2264.398254s
	iters: 1910, epoch: 18 | train_loss : 0.0227
	speed: 0.038548s/iter; left time: 2357.375167s
data: {'predict': array([148.85004698, 148.80201504, 148.81611771, ..., 148.80592115,
       148.81980301, 148.80078574]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:51:35] [32mIntermediate result: 0.14891263842582703  (Index 17)[0m
Epoch: 18 | cost time: 235.23670887947083 | valid_loss: 0.14891263842582703 | valid_loss_true: 0.1488080947979752
Pretest loss in this epoch: 14.468242695951892
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-17.pth
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0193
	speed: 0.457636s/iter; left time: 27811.023677s
	iters: 764, epoch: 19 | train_loss : 0.0209
	speed: 0.041545s/iter; left time: 2508.856693s
	iters: 1146, epoch: 19 | train_loss : 0.0253
	speed: 0.037788s/iter; left time: 2267.557724s
	iters: 1528, epoch: 19 | train_loss : 0.0255
	speed: 0.036394s/iter; left time: 2170.015958s
	iters: 1910, epoch: 19 | train_loss : 0.0212
	speed: 0.039287s/iter; left time: 2327.485239s
data: {'predict': array([148.86042979, 148.81700274, 148.82700381, ..., 148.81392487,
       148.82501418, 148.81138226]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:55:30] [32mIntermediate result: 0.14880883693695068  (Index 18)[0m
Epoch: 19 | cost time: 235.81228232383728 | valid_loss: 0.14880883693695068 | valid_loss_true: 0.1487326003348683
Pretest loss in this epoch: 14.474434617314213
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-18.pth
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0226
	speed: 0.459060s/iter; left time: 27020.294186s
	iters: 764, epoch: 20 | train_loss : 0.0219
	speed: 0.043171s/iter; left time: 2524.537539s
	iters: 1146, epoch: 20 | train_loss : 0.0207
	speed: 0.043839s/iter; left time: 2546.861278s
	iters: 1528, epoch: 20 | train_loss : 0.0276
	speed: 0.037135s/iter; left time: 2143.182050s
	iters: 1910, epoch: 20 | train_loss : 0.0241
	speed: 0.041305s/iter; left time: 2368.106433s
data: {'predict': array([148.86263218, 148.81520738, 148.8286262 , ..., 148.81377912,
       148.82893764, 148.81146534]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 14:59:25] [32mIntermediate result: 0.14866404235363007  (Index 19)[0m
Epoch: 20 | cost time: 234.99555039405823 | valid_loss: 0.14866404235363007 | valid_loss_true: 0.14865964631912074
Pretest loss in this epoch: 14.475279652046337
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-19.pth
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0244
	speed: 0.451652s/iter; left time: 25721.114398s
	iters: 764, epoch: 21 | train_loss : 0.0213
	speed: 0.041014s/iter; left time: 2320.024661s
	iters: 1146, epoch: 21 | train_loss : 0.0218
	speed: 0.041461s/iter; left time: 2329.496750s
	iters: 1528, epoch: 21 | train_loss : 0.0220
	speed: 0.040010s/iter; left time: 2232.681047s
	iters: 1910, epoch: 21 | train_loss : 0.0288
	speed: 0.040109s/iter; left time: 2222.893945s
data: {'predict': array([148.85588587, 148.81125815, 148.82458479, ..., 148.81151811,
       148.82564186, 148.81012707]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:03:20] [32mIntermediate result: 0.14847566187381744  (Index 20)[0m
Epoch: 21 | cost time: 234.86661386489868 | valid_loss: 0.14847566187381744 | valid_loss_true: 0.14844873037175677
Pretest loss in this epoch: 14.473179349317142
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-20.pth
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0263
	speed: 0.451313s/iter; left time: 24839.360948s
	iters: 764, epoch: 22 | train_loss : 0.0228
	speed: 0.039429s/iter; left time: 2155.028656s
	iters: 1146, epoch: 22 | train_loss : 0.0212
	speed: 0.041945s/iter; left time: 2276.531160s
	iters: 1528, epoch: 22 | train_loss : 0.0276
	speed: 0.037308s/iter; left time: 2010.600726s
	iters: 1910, epoch: 22 | train_loss : 0.0221
	speed: 0.036972s/iter; left time: 1978.376681s
data: {'predict': array([148.8580813 , 148.81302968, 148.82556567, ..., 148.81792929,
       148.82656476, 148.81169798]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:07:13] [32mIntermediate result: 0.14860960841178894  (Index 21)[0m
Epoch: 22 | cost time: 233.1444399356842 | valid_loss: 0.14860960841178894 | valid_loss_true: 0.1485799382007463
Pretest loss in this epoch: 14.473679316718291
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0209
	speed: 0.456181s/iter; left time: 24235.537837s
	iters: 764, epoch: 23 | train_loss : 0.0155
	speed: 0.040869s/iter; left time: 2155.640742s
	iters: 1146, epoch: 23 | train_loss : 0.0180
	speed: 0.039297s/iter; left time: 2057.706244s
	iters: 1528, epoch: 23 | train_loss : 0.0253
	speed: 0.038253s/iter; left time: 1988.441341s
	iters: 1910, epoch: 23 | train_loss : 0.0195
	speed: 0.044485s/iter; left time: 2295.378348s
data: {'predict': array([148.85028768, 148.80563706, 148.82076109, ..., 148.8088605 ,
       148.81953166, 148.80714173]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:11:09] [32mIntermediate result: 0.14844177663326263  (Index 22)[0m
Epoch: 23 | cost time: 235.76165795326233 | valid_loss: 0.14844177663326263 | valid_loss_true: 0.14836592924039785
Pretest loss in this epoch: 14.470228637144524
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-22.pth
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 0.0230
	speed: 0.452334s/iter; left time: 23166.741382s
	iters: 764, epoch: 24 | train_loss : 0.0291
	speed: 0.042382s/iter; left time: 2154.424570s
	iters: 1146, epoch: 24 | train_loss : 0.0195
	speed: 0.044418s/iter; left time: 2240.983602s
	iters: 1528, epoch: 24 | train_loss : 0.0205
	speed: 0.040543s/iter; left time: 2029.988078s
	iters: 1910, epoch: 24 | train_loss : 0.0228
	speed: 0.040127s/iter; left time: 1993.843228s
data: {'predict': array([148.85695674, 148.81089006, 148.82923136, ..., 148.8153032 ,
       148.82599834, 148.81295209]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:15:07] [32mIntermediate result: 0.14843548834323883  (Index 23)[0m
Epoch: 24 | cost time: 237.41419386863708 | valid_loss: 0.14843548834323883 | valid_loss_true: 0.14840382149992998
Pretest loss in this epoch: 14.473758909731472
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-23.pth
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 0.0231
	speed: 0.454979s/iter; left time: 22432.760966s
	iters: 764, epoch: 25 | train_loss : 0.0203
	speed: 0.039777s/iter; left time: 1945.986991s
	iters: 1146, epoch: 25 | train_loss : 0.0236
	speed: 0.037181s/iter; left time: 1804.810668s
	iters: 1528, epoch: 25 | train_loss : 0.0325
	speed: 0.039788s/iter; left time: 1916.130316s
	iters: 1910, epoch: 25 | train_loss : 0.0198
	speed: 0.040826s/iter; left time: 1950.528796s
data: {'predict': array([148.85505781, 148.80694036, 148.82773155, ..., 148.81327409,
       148.82407981, 148.80953985]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:19:03] [32mIntermediate result: 0.14832933247089386  (Index 24)[0m
Epoch: 25 | cost time: 235.83920693397522 | valid_loss: 0.14832933247089386 | valid_loss_true: 0.148283247403016
Pretest loss in this epoch: 14.47244577392044
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-24.pth
Adjusting learning rate of group 0 to 1.7198e-06.
	iters: 382, epoch: 26 | train_loss : 0.0264
	speed: 0.458660s/iter; left time: 21737.717855s
	iters: 764, epoch: 26 | train_loss : 0.0256
	speed: 0.038840s/iter; left time: 1825.952825s
	iters: 1146, epoch: 26 | train_loss : 0.0190
	speed: 0.038801s/iter; left time: 1809.308954s
	iters: 1528, epoch: 26 | train_loss : 0.0173
	speed: 0.037944s/iter; left time: 1754.831245s
	iters: 1910, epoch: 26 | train_loss : 0.0219
	speed: 0.040998s/iter; left time: 1880.407318s
data: {'predict': array([148.85291044, 148.80620185, 148.82447486, ..., 148.81264123,
       148.82257366, 148.80979928]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:22:57] [32mIntermediate result: 0.1483425796031952  (Index 25)[0m
Epoch: 26 | cost time: 234.10954904556274 | valid_loss: 0.1483425796031952 | valid_loss_true: 0.14828526826509245
Pretest loss in this epoch: 14.471322524385107
Adjusting learning rate of group 0 to 1.4618e-06.
	iters: 382, epoch: 27 | train_loss : 0.0274
	speed: 0.458928s/iter; left time: 20873.403783s
	iters: 764, epoch: 27 | train_loss : 0.0274
	speed: 0.040477s/iter; left time: 1825.553852s
	iters: 1146, epoch: 27 | train_loss : 0.0174
	speed: 0.038737s/iter; left time: 1732.296509s
	iters: 1528, epoch: 27 | train_loss : 0.0206
	speed: 0.038012s/iter; left time: 1685.344144s
	iters: 1910, epoch: 27 | train_loss : 0.0265
	speed: 0.043298s/iter; left time: 1903.165612s
data: {'predict': array([148.86010675, 148.81066311, 148.83258662, ..., 148.81744766,
       148.82891739, 148.81430297]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:26:53] [32mIntermediate result: 0.14840631186962128  (Index 26)[0m
Epoch: 27 | cost time: 236.12673020362854 | valid_loss: 0.14840631186962128 | valid_loss_true: 0.14838480926531294
Pretest loss in this epoch: 14.475416757114152
Adjusting learning rate of group 0 to 1.2425e-06.
	iters: 382, epoch: 28 | train_loss : 0.0268
	speed: 0.456218s/iter; left time: 19878.346463s
	iters: 764, epoch: 28 | train_loss : 0.0159
	speed: 0.043034s/iter; left time: 1858.626623s
	iters: 1146, epoch: 28 | train_loss : 0.0224
	speed: 0.043325s/iter; left time: 1854.652663s
	iters: 1528, epoch: 28 | train_loss : 0.0237
	speed: 0.041152s/iter; left time: 1745.930102s
	iters: 1910, epoch: 28 | train_loss : 0.0238
	speed: 0.041653s/iter; left time: 1751.255331s
data: {'predict': array([148.85802586, 148.80839946, 148.83023942, ..., 148.81590999,
       148.82695048, 148.81319082]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:30:55] [32mIntermediate result: 0.1483384668827057  (Index 27)[0m
Epoch: 28 | cost time: 242.30863976478577 | valid_loss: 0.1483384668827057 | valid_loss_true: 0.14829828803683526
Pretest loss in this epoch: 14.47417095336637
Adjusting learning rate of group 0 to 1.0562e-06.
	iters: 382, epoch: 29 | train_loss : 0.0248
	speed: 0.467739s/iter; left time: 19486.484037s
	iters: 764, epoch: 29 | train_loss : 0.0305
	speed: 0.040634s/iter; left time: 1677.313593s
	iters: 1146, epoch: 29 | train_loss : 0.0299
	speed: 0.037223s/iter; left time: 1522.325655s
	iters: 1528, epoch: 29 | train_loss : 0.0326
	speed: 0.037666s/iter; left time: 1526.029013s
	iters: 1910, epoch: 29 | train_loss : 0.0248
	speed: 0.039358s/iter; left time: 1579.553256s
data: {'predict': array([148.85556945, 148.8073771 , 148.82804451, ..., 148.81471983,
       148.82453471, 148.81196401]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:34:50] [32mIntermediate result: 0.1482665240764618  (Index 28)[0m
Epoch: 29 | cost time: 235.116215467453 | valid_loss: 0.1482665240764618 | valid_loss_true: 0.14822038693423906
Pretest loss in this epoch: 14.47316465538235
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-28.pth
Adjusting learning rate of group 0 to 8.9774e-07.
	iters: 382, epoch: 30 | train_loss : 0.0234
	speed: 0.458509s/iter; left time: 18225.713307s
	iters: 764, epoch: 30 | train_loss : 0.0197
	speed: 0.040630s/iter; left time: 1599.530874s
	iters: 1146, epoch: 30 | train_loss : 0.0289
	speed: 0.039902s/iter; left time: 1555.608832s
	iters: 1528, epoch: 30 | train_loss : 0.0242
	speed: 0.041386s/iter; left time: 1597.681895s
	iters: 1910, epoch: 30 | train_loss : 0.0315
	speed: 0.040762s/iter; left time: 1557.992499s
data: {'predict': array([148.85810177, 148.81026667, 148.8307949 , ..., 148.81765186,
       148.8270774 , 148.81474899]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:38:48] [32mIntermediate result: 0.14832976460456848  (Index 29)[0m
Epoch: 30 | cost time: 237.31282806396484 | valid_loss: 0.14832976460456848 | valid_loss_true: 0.14831505945959847
Pretest loss in this epoch: 14.474770989880442
Adjusting learning rate of group 0 to 7.6308e-07.
	iters: 382, epoch: 31 | train_loss : 0.0142
	speed: 0.458728s/iter; left time: 17357.807545s
	iters: 764, epoch: 31 | train_loss : 0.0266
	speed: 0.041492s/iter; left time: 1554.163798s
	iters: 1146, epoch: 31 | train_loss : 0.0227
	speed: 0.038449s/iter; left time: 1425.503999s
	iters: 1528, epoch: 31 | train_loss : 0.0230
	speed: 0.043013s/iter; left time: 1578.283465s
	iters: 1910, epoch: 31 | train_loss : 0.0245
	speed: 0.043977s/iter; left time: 1596.839771s
data: {'predict': array([148.85679529, 148.80820803, 148.82946964, ..., 148.81647106,
       148.82631662, 148.81386119]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:42:45] [32mIntermediate result: 0.14829502999782562  (Index 30)[0m
Epoch: 31 | cost time: 237.80840802192688 | valid_loss: 0.14829502999782562 | valid_loss_true: 0.14826341722668493
Pretest loss in this epoch: 14.473848836906823
Adjusting learning rate of group 0 to 6.4861e-07.
	iters: 382, epoch: 32 | train_loss : 0.0251
	speed: 0.456159s/iter; left time: 16388.882929s
	iters: 764, epoch: 32 | train_loss : 0.0238
	speed: 0.042939s/iter; left time: 1526.324961s
	iters: 1146, epoch: 32 | train_loss : 0.0182
	speed: 0.040375s/iter; left time: 1419.732560s
	iters: 1528, epoch: 32 | train_loss : 0.0257
	speed: 0.039472s/iter; left time: 1372.924443s
	iters: 1910, epoch: 32 | train_loss : 0.0263
	speed: 0.035952s/iter; left time: 1236.756769s
data: {'predict': array([148.85440645, 148.80623113, 148.82704181, ..., 148.81459414,
       148.824422  , 148.81188868]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:46:40] [32mIntermediate result: 0.14825329184532166  (Index 31)[0m
Epoch: 32 | cost time: 235.04474925994873 | valid_loss: 0.14825329184532166 | valid_loss_true: 0.14821232851807625
Pretest loss in this epoch: 14.47250139683449
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-31.pth
Adjusting learning rate of group 0 to 5.5132e-07.
	iters: 382, epoch: 33 | train_loss : 0.0183
	speed: 0.456389s/iter; left time: 15524.982011s
	iters: 764, epoch: 33 | train_loss : 0.0199
	speed: 0.039435s/iter; left time: 1326.383052s
	iters: 1146, epoch: 33 | train_loss : 0.0227
	speed: 0.039955s/iter; left time: 1328.631044s
	iters: 1528, epoch: 33 | train_loss : 0.0258
	speed: 0.039581s/iter; left time: 1301.073160s
	iters: 1910, epoch: 33 | train_loss : 0.0278
	speed: 0.040785s/iter; left time: 1325.074063s
data: {'predict': array([148.85771751, 148.80898874, 148.83051328, ..., 148.8166431 ,
       148.82692304, 148.81400293]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:50:36] [32mIntermediate result: 0.14828266203403473  (Index 32)[0m
Epoch: 33 | cost time: 235.92126035690308 | valid_loss: 0.14828266203403473 | valid_loss_true: 0.14825791166740218
Pretest loss in this epoch: 14.474283961410341
Adjusting learning rate of group 0 to 4.6862e-07.
	iters: 382, epoch: 34 | train_loss : 0.0279
	speed: 0.458167s/iter; left time: 14709.908138s
	iters: 764, epoch: 34 | train_loss : 0.0269
	speed: 0.041095s/iter; left time: 1303.685038s
	iters: 1146, epoch: 34 | train_loss : 0.0181
	speed: 0.038528s/iter; left time: 1207.560084s
	iters: 1528, epoch: 34 | train_loss : 0.0199
	speed: 0.041568s/iter; left time: 1286.943839s
	iters: 1910, epoch: 34 | train_loss : 0.0220
	speed: 0.040261s/iter; left time: 1231.112144s
data: {'predict': array([148.85698962, 148.80853712, 148.8296163 , ..., 148.81618392,
       148.82639231, 148.81382851]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:54:35] [32mIntermediate result: 0.14824919402599335  (Index 33)[0m
Epoch: 34 | cost time: 238.40973377227783 | valid_loss: 0.14824919402599335 | valid_loss_true: 0.14822295420600234
Pretest loss in this epoch: 14.4739781191882
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-33.pth
Adjusting learning rate of group 0 to 3.9833e-07.
	iters: 382, epoch: 35 | train_loss : 0.0210
	speed: 0.462183s/iter; left time: 13955.623088s
	iters: 764, epoch: 35 | train_loss : 0.0337
	speed: 0.040277s/iter; left time: 1200.781044s
	iters: 1146, epoch: 35 | train_loss : 0.0219
	speed: 0.039480s/iter; left time: 1161.924187s
	iters: 1528, epoch: 35 | train_loss : 0.0273
	speed: 0.043263s/iter; left time: 1256.742691s
	iters: 1910, epoch: 35 | train_loss : 0.0212
	speed: 0.039008s/iter; left time: 1118.235773s
data: {'predict': array([148.85468357, 148.80582301, 148.8275278 , ..., 148.8141425 ,
       148.82450259, 148.81168617]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 15:58:29] [32mIntermediate result: 0.14821651577949524  (Index 34)[0m
Epoch: 35 | cost time: 234.03212928771973 | valid_loss: 0.14821651577949524 | valid_loss_true: 0.1481714953967362
Pretest loss in this epoch: 14.472636017187506
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-34.pth
Adjusting learning rate of group 0 to 3.3858e-07.
	iters: 382, epoch: 36 | train_loss : 0.0326
	speed: 0.451728s/iter; left time: 12776.672000s
	iters: 764, epoch: 36 | train_loss : 0.0214
	speed: 0.040854s/iter; left time: 1139.918364s
	iters: 1146, epoch: 36 | train_loss : 0.0249
	speed: 0.040869s/iter; left time: 1124.707118s
	iters: 1528, epoch: 36 | train_loss : 0.0206
	speed: 0.041309s/iter; left time: 1121.044548s
	iters: 1910, epoch: 36 | train_loss : 0.0224
	speed: 0.041034s/iter; left time: 1097.910182s
data: {'predict': array([148.85592926, 148.80652836, 148.82911142, ..., 148.81491307,
       148.82560558, 148.81269998]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:02:28] [32mIntermediate result: 0.1482255905866623  (Index 35)[0m
Epoch: 36 | cost time: 239.3687572479248 | valid_loss: 0.1482255905866623 | valid_loss_true: 0.14818645424053484
Pretest loss in this epoch: 14.473334131974966
Adjusting learning rate of group 0 to 2.8779e-07.
	iters: 382, epoch: 37 | train_loss : 0.0233
	speed: 0.462691s/iter; left time: 12202.551965s
	iters: 764, epoch: 37 | train_loss : 0.0231
	speed: 0.039854s/iter; left time: 1035.857231s
	iters: 1146, epoch: 37 | train_loss : 0.0271
	speed: 0.041191s/iter; left time: 1054.851256s
	iters: 1528, epoch: 37 | train_loss : 0.0278
	speed: 0.037027s/iter; left time: 934.085753s
	iters: 1910, epoch: 37 | train_loss : 0.0282
	speed: 0.038568s/iter; left time: 958.232331s
data: {'predict': array([148.85709449, 148.80750966, 148.83028278, ..., 148.81582096,
       148.8264395 , 148.81357288]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:06:26] [32mIntermediate result: 0.1482415795326233  (Index 36)[0m
Epoch: 37 | cost time: 238.27725744247437 | valid_loss: 0.1482415795326233 | valid_loss_true: 0.14821102905565678
Pretest loss in this epoch: 14.474014320263072
Adjusting learning rate of group 0 to 2.4462e-07.
	iters: 382, epoch: 38 | train_loss : 0.0228
	speed: 0.467158s/iter; left time: 11427.625085s
	iters: 764, epoch: 38 | train_loss : 0.0226
	speed: 0.041441s/iter; left time: 997.902991s
	iters: 1146, epoch: 38 | train_loss : 0.0221
	speed: 0.040531s/iter; left time: 960.498119s
	iters: 1528, epoch: 38 | train_loss : 0.0203
	speed: 0.040160s/iter; left time: 936.361058s
	iters: 1910, epoch: 38 | train_loss : 0.0248
	speed: 0.039157s/iter; left time: 898.031731s
data: {'predict': array([148.85598797, 148.80620387, 148.82926043, ..., 148.81480555,
       148.82554795, 148.81277502]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:10:25] [32mIntermediate result: 0.14821772277355194  (Index 37)[0m
Epoch: 38 | cost time: 239.01622772216797 | valid_loss: 0.14821772277355194 | valid_loss_true: 0.148181121917361
Pretest loss in this epoch: 14.47334204188205
Adjusting learning rate of group 0 to 2.0793e-07.
	iters: 382, epoch: 39 | train_loss : 0.0232
	speed: 0.462923s/iter; left time: 10439.378557s
	iters: 764, epoch: 39 | train_loss : 0.0224
	speed: 0.040983s/iter; left time: 908.552328s
	iters: 1146, epoch: 39 | train_loss : 0.0253
	speed: 0.042376s/iter; left time: 923.238737s
	iters: 1528, epoch: 39 | train_loss : 0.0193
	speed: 0.041456s/iter; left time: 887.372741s
	iters: 1910, epoch: 39 | train_loss : 0.0266
	speed: 0.040842s/iter; left time: 858.621001s
data: {'predict': array([148.85504284, 148.80529895, 148.82839594, ..., 148.81417418,
       148.82459668, 148.81204803]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:14:24] [32mIntermediate result: 0.1481991559267044  (Index 38)[0m
Epoch: 39 | cost time: 238.44478011131287 | valid_loss: 0.1481991559267044 | valid_loss_true: 0.14815869529620473
Pretest loss in this epoch: 14.47281595477593
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-38.pth
Adjusting learning rate of group 0 to 1.7674e-07.
	iters: 382, epoch: 40 | train_loss : 0.0264
	speed: 0.460344s/iter; left time: 9501.500650s
	iters: 764, epoch: 40 | train_loss : 0.0209
	speed: 0.041086s/iter; left time: 832.322786s
	iters: 1146, epoch: 40 | train_loss : 0.0271
	speed: 0.042078s/iter; left time: 836.346746s
	iters: 1528, epoch: 40 | train_loss : 0.0274
	speed: 0.040546s/iter; left time: 790.404472s
	iters: 1910, epoch: 40 | train_loss : 0.0215
	speed: 0.039043s/iter; left time: 746.194985s
data: {'predict': array([148.85486504, 148.80518747, 148.82811073, ..., 148.81417201,
       148.82432842, 148.81205716]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:18:21] [32mIntermediate result: 0.148194819688797  (Index 39)[0m
Epoch: 40 | cost time: 236.76258730888367 | valid_loss: 0.148194819688797 | valid_loss_true: 0.1481520099899499
Pretest loss in this epoch: 14.472722559281133
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-39.pth
Adjusting learning rate of group 0 to 1.5023e-07.
	iters: 382, epoch: 41 | train_loss : 0.0191
	speed: 0.453528s/iter; left time: 8494.125254s
	iters: 764, epoch: 41 | train_loss : 0.0218
	speed: 0.042016s/iter; left time: 770.860224s
	iters: 1146, epoch: 41 | train_loss : 0.0254
	speed: 0.038196s/iter; left time: 686.191456s
	iters: 1528, epoch: 41 | train_loss : 0.0259
	speed: 0.037810s/iter; left time: 664.818999s
	iters: 1910, epoch: 41 | train_loss : 0.0222
	speed: 0.040651s/iter; left time: 699.233878s
data: {'predict': array([148.85526209, 148.80535755, 148.82842464, ..., 148.81434847,
       148.82461669, 148.81226419]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:22:16] [32mIntermediate result: 0.1481945812702179  (Index 40)[0m
Epoch: 41 | cost time: 235.33806538581848 | valid_loss: 0.1481945812702179 | valid_loss_true: 0.1481537587350747
Pretest loss in this epoch: 14.472915069207334
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-40.pth
Adjusting learning rate of group 0 to 1.2770e-07.
	iters: 382, epoch: 42 | train_loss : 0.0241
	speed: 0.460694s/iter; left time: 7747.944917s
	iters: 764, epoch: 42 | train_loss : 0.0252
	speed: 0.040939s/iter; left time: 672.869992s
	iters: 1146, epoch: 42 | train_loss : 0.0219
	speed: 0.039036s/iter; left time: 626.684434s
	iters: 1528, epoch: 42 | train_loss : 0.0192
	speed: 0.037970s/iter; left time: 595.070563s
	iters: 1910, epoch: 42 | train_loss : 0.0192
	speed: 0.042548s/iter; left time: 650.557410s
data: {'predict': array([148.85527502, 148.80537571, 148.82851525, ..., 148.8142687 ,
       148.82466422, 148.81226258]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:26:12] [32mIntermediate result: 0.14818675816059113  (Index 41)[0m
Epoch: 42 | cost time: 235.67831897735596 | valid_loss: 0.14818675816059113 | valid_loss_true: 0.14814666490629413
Pretest loss in this epoch: 14.472989097485904
Chepoint Saved at:  ./checkpoints/randseries/patchtst/alumina_patchtst/STANDALONE/checkpoint-41.pth
Adjusting learning rate of group 0 to 1.0854e-07.
	iters: 382, epoch: 43 | train_loss : 0.0205
	speed: 0.453715s/iter; left time: 6763.524246s
	iters: 764, epoch: 43 | train_loss : 0.0202
	speed: 0.043084s/iter; left time: 625.790882s
	iters: 1146, epoch: 43 | train_loss : 0.0272
	speed: 0.043585s/iter; left time: 616.422747s
	iters: 1528, epoch: 43 | train_loss : 0.0282
	speed: 0.040248s/iter; left time: 553.857849s
	iters: 1910, epoch: 43 | train_loss : 0.0222
	speed: 0.041675s/iter; left time: 557.564744s
data: {'predict': array([148.85624839, 148.80620223, 148.82944557, ..., 148.81501307,
       148.82542345, 148.81299504]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:30:12] [32mIntermediate result: 0.1482025682926178  (Index 42)[0m
Epoch: 43 | cost time: 240.3299479484558 | valid_loss: 0.1482025682926178 | valid_loss_true: 0.1481669888719973
Pretest loss in this epoch: 14.473513421970864
Adjusting learning rate of group 0 to 9.2260e-08.
	iters: 382, epoch: 44 | train_loss : 0.0223
	speed: 0.464148s/iter; left time: 6032.073284s
	iters: 764, epoch: 44 | train_loss : 0.0258
	speed: 0.041381s/iter; left time: 521.982787s
	iters: 1146, epoch: 44 | train_loss : 0.0289
	speed: 0.039098s/iter; left time: 478.251447s
	iters: 1528, epoch: 44 | train_loss : 0.0226
	speed: 0.039236s/iter; left time: 464.942193s
	iters: 1910, epoch: 44 | train_loss : 0.0226
	speed: 0.040690s/iter; left time: 466.629801s
data: {'predict': array([148.8557666 , 148.80572646, 148.82895045, ..., 148.81463599,
       148.82503132, 148.81259357]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:34:10] [32mIntermediate result: 0.14819303154945374  (Index 43)[0m
Epoch: 44 | cost time: 238.47800040245056 | valid_loss: 0.14819303154945374 | valid_loss_true: 0.14815521993997563
Pretest loss in this epoch: 14.47322122500125
Adjusting learning rate of group 0 to 7.8421e-08.
	iters: 382, epoch: 45 | train_loss : 0.0234
	speed: 0.462314s/iter; left time: 5124.751738s
	iters: 764, epoch: 45 | train_loss : 0.0293
	speed: 0.041101s/iter; left time: 439.909101s
	iters: 1146, epoch: 45 | train_loss : 0.0172
	speed: 0.040880s/iter; left time: 421.925383s
	iters: 1528, epoch: 45 | train_loss : 0.0241
	speed: 0.039315s/iter; left time: 390.750324s
	iters: 1910, epoch: 45 | train_loss : 0.0244
	speed: 0.039914s/iter; left time: 381.461547s
data: {'predict': array([148.85606795, 148.80599228, 148.82912887, ..., 148.81489348,
       148.82527372, 148.8128256 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:37:56] [32mIntermediate result: 0.14819996058940887  (Index 44)[0m
Epoch: 45 | cost time: 225.8000612258911 | valid_loss: 0.14819996058940887 | valid_loss_true: 0.14816352171465608
Pretest loss in this epoch: 14.473347954758728
Adjusting learning rate of group 0 to 6.6658e-08.
	iters: 382, epoch: 46 | train_loss : 0.0200
	speed: 0.420257s/iter; left time: 3855.433891s
	iters: 764, epoch: 46 | train_loss : 0.0289
	speed: 0.030864s/iter; left time: 271.360324s
	iters: 1146, epoch: 46 | train_loss : 0.0292
	speed: 0.030181s/iter; left time: 253.822077s
	iters: 1528, epoch: 46 | train_loss : 0.0288
	speed: 0.030948s/iter; left time: 248.448999s
	iters: 1910, epoch: 46 | train_loss : 0.0181
	speed: 0.030594s/iter; left time: 233.919219s
data: {'predict': array([148.85606378, 148.80593582, 148.82911161, ..., 148.81485928,
       148.82525291, 148.81279677]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:41:25] [32mIntermediate result: 0.14819689095020294  (Index 45)[0m
Epoch: 46 | cost time: 208.3940544128418 | valid_loss: 0.14819689095020294 | valid_loss_true: 0.1481605070140238
Pretest loss in this epoch: 14.473336656666483
Adjusting learning rate of group 0 to 5.6659e-08.
	iters: 382, epoch: 47 | train_loss : 0.0219
	speed: 0.424340s/iter; left time: 3081.982705s
	iters: 764, epoch: 47 | train_loss : 0.0228
	speed: 0.030197s/iter; left time: 207.784947s
	iters: 1146, epoch: 47 | train_loss : 0.0222
	speed: 0.031425s/iter; left time: 204.234185s
	iters: 1528, epoch: 47 | train_loss : 0.0183
	speed: 0.030822s/iter; left time: 188.535627s
	iters: 1910, epoch: 47 | train_loss : 0.0168
	speed: 0.028774s/iter; left time: 165.017186s
data: {'predict': array([148.85596653, 148.80586341, 148.8290423 , ..., 148.8148033 ,
       148.82522172, 148.81275513]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:44:49] [32mIntermediate result: 0.14819768071174622  (Index 46)[0m
Epoch: 47 | cost time: 203.97892951965332 | valid_loss: 0.14819768071174622 | valid_loss_true: 0.14816032526112488
Pretest loss in this epoch: 14.473283360054491
Adjusting learning rate of group 0 to 4.8160e-08.
	iters: 382, epoch: 48 | train_loss : 0.0215
	speed: 0.412250s/iter; left time: 2206.360892s
	iters: 764, epoch: 48 | train_loss : 0.0215
	speed: 0.029799s/iter; left time: 148.100845s
	iters: 1146, epoch: 48 | train_loss : 0.0255
	speed: 0.032474s/iter; left time: 148.990004s
	iters: 1528, epoch: 48 | train_loss : 0.0173
	speed: 0.031939s/iter; left time: 134.335010s
	iters: 1910, epoch: 48 | train_loss : 0.0224
	speed: 0.032006s/iter; left time: 122.391821s
data: {'predict': array([148.85583837, 148.80575992, 148.82893574, ..., 148.81474867,
       148.82515911, 148.81272853]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:48:16] [32mIntermediate result: 0.14819572865962982  (Index 47)[0m
Epoch: 48 | cost time: 207.1747658252716 | valid_loss: 0.14819572865962982 | valid_loss_true: 0.14815812984230053
Pretest loss in this epoch: 14.473236788109158
Adjusting learning rate of group 0 to 4.0936e-08.
	iters: 382, epoch: 49 | train_loss : 0.0254
	speed: 0.415412s/iter; left time: 1429.431261s
	iters: 764, epoch: 49 | train_loss : 0.0226
	speed: 0.031733s/iter; left time: 97.069897s
	iters: 1146, epoch: 49 | train_loss : 0.0241
	speed: 0.031864s/iter; left time: 85.300092s
	iters: 1528, epoch: 49 | train_loss : 0.0208
	speed: 0.030233s/iter; left time: 69.384375s
	iters: 1910, epoch: 49 | train_loss : 0.0234
	speed: 0.031766s/iter; left time: 60.768363s
data: {'predict': array([148.85593643, 148.80583711, 148.82904612, ..., 148.81481702,
       148.82524067, 148.81282773]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:51:42] [32mIntermediate result: 0.14819736778736115  (Index 48)[0m
Epoch: 49 | cost time: 206.30985569953918 | valid_loss: 0.14819736778736115 | valid_loss_true: 0.14815951505557856
Pretest loss in this epoch: 14.473294814686986
Adjusting learning rate of group 0 to 3.4796e-08.
	iters: 382, epoch: 50 | train_loss : 0.0328
	speed: 0.415871s/iter; left time: 636.282512s
	iters: 764, epoch: 50 | train_loss : 0.0191
	speed: 0.030786s/iter; left time: 35.342517s
	iters: 1146, epoch: 50 | train_loss : 0.0258
	speed: 0.031908s/iter; left time: 24.441623s
	iters: 1528, epoch: 50 | train_loss : 0.0263
	speed: 0.030734s/iter; left time: 11.801688s
	iters: 1910, epoch: 50 | train_loss : 0.0223
	speed: 0.032565s/iter; left time: 0.065129s
data: {'predict': array([148.8560243 , 148.80592886, 148.82913548, ..., 148.81490191,
       148.82532708, 148.81290017]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-10 16:55:08] [32mIntermediate result: 0.148197740316391  (Index 49)[0m
Epoch: 50 | cost time: 205.72428488731384 | valid_loss: 0.148197740316391 | valid_loss_true: 0.14816171733324912
Pretest loss in this epoch: 14.473351626447027
Early stop with best valid_loss: 0.148197740316391
[2024-03-10 16:55:08] [32mFinal result: 0.14818675816059113[0m
>>>>>>>end of training : alumina_patchtst/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
