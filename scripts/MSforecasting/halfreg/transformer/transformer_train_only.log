python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸© --target_cols 1æ•ˆè’¸å‘å™¨æ±½æ¸© --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©', target_cols='1æ•ˆè’¸å‘å™¨æ±½æ¸©', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 19:10:32.454571: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 19:10:32.454644: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 19:10:32.456473: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 19:10:32.466526: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 19:10:33.602854: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©
	iters: 382, epoch: 1 | train_loss : 0.0057
	speed: 0.140998s/iter; left time: 13418.630667s
	iters: 764, epoch: 1 | train_loss : 0.0051
	speed: 0.124654s/iter; left time: 11815.553173s
	iters: 1146, epoch: 1 | train_loss : 0.0051
	speed: 0.124603s/iter; left time: 11763.191230s
	iters: 1528, epoch: 1 | train_loss : 0.0020
	speed: 0.122368s/iter; left time: 11505.386682s
	iters: 1910, epoch: 1 | train_loss : 0.0050
	speed: 0.122304s/iter; left time: 11452.622357s
data: {'predict': array([163.12100948, 163.18216292, 163.1929771 , ..., 114.65654947,
       115.13981848, 114.58577214]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:19:08] [32mIntermediate result: 0.02598412148654461  (Index 0)[0m
Epoch: 1 | cost time: 506.9586660861969 | valid_loss: 0.02598412148654461 | valid_loss_true: 1.5604297312770468
Pretest loss in this epoch: 35.76026295029232
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0090
	speed: 0.819471s/iter; left time: 76422.191164s
	iters: 764, epoch: 2 | train_loss : 0.0012
	speed: 0.122006s/iter; left time: 11331.409318s
	iters: 1146, epoch: 2 | train_loss : 0.0025
	speed: 0.129463s/iter; left time: 11974.570564s
	iters: 1528, epoch: 2 | train_loss : 0.0060
	speed: 0.129709s/iter; left time: 11947.758948s
	iters: 1910, epoch: 2 | train_loss : 0.0016
	speed: 0.120731s/iter; left time: 11074.634867s
data: {'predict': array([162.93552961, 162.9990862 , 162.98359264, ..., 110.25692313,
       110.94223739, 110.1791775 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:27:40] [32mIntermediate result: 0.024714848026633263  (Index 1)[0m
Epoch: 2 | cost time: 511.36500000953674 | valid_loss: 0.024714848026633263 | valid_loss_true: 1.5223285048328996
Pretest loss in this epoch: 31.537711510414354
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0013
	speed: 0.837997s/iter; left time: 76548.523043s
	iters: 764, epoch: 3 | train_loss : 0.0018
	speed: 0.121726s/iter; left time: 11072.837315s
	iters: 1146, epoch: 3 | train_loss : 0.0016
	speed: 0.121259s/iter; left time: 10984.043033s
	iters: 1528, epoch: 3 | train_loss : 0.0021
	speed: 0.117639s/iter; left time: 10611.179749s
	iters: 1910, epoch: 3 | train_loss : 0.0009
	speed: 0.127490s/iter; left time: 11451.019485s
data: {'predict': array([161.80069764, 161.86678431, 161.84933043, ..., 108.10600789,
       109.07126817, 107.98137683]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:35:59] [32mIntermediate result: 0.025942441076040268  (Index 2)[0m
Epoch: 3 | cost time: 498.9827196598053 | valid_loss: 0.025942441076040268 | valid_loss_true: 1.5680190123198354
Pretest loss in this epoch: 28.451312061313555
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0011
	speed: 0.832994s/iter; left time: 74499.679837s
	iters: 764, epoch: 4 | train_loss : 0.0013
	speed: 0.129464s/iter; left time: 11529.286861s
	iters: 1146, epoch: 4 | train_loss : 0.0008
	speed: 0.118661s/iter; left time: 10521.875470s
	iters: 1528, epoch: 4 | train_loss : 0.0017
	speed: 0.118555s/iter; left time: 10467.204171s
	iters: 1910, epoch: 4 | train_loss : 0.0027
	speed: 0.119472s/iter; left time: 10502.510009s
data: {'predict': array([162.22400209, 162.28145772, 162.26152172, ..., 106.18427067,
       107.35551377, 106.01864501]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:44:29] [32mIntermediate result: 0.022244904190301895  (Index 3)[0m
Epoch: 4 | cost time: 510.16456174850464 | valid_loss: 0.022244904190301895 | valid_loss_true: 1.4429763427744677
Pretest loss in this epoch: 26.30834315613376
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0007
	speed: 0.831846s/iter; left time: 72807.317491s
	iters: 764, epoch: 5 | train_loss : 0.0009
	speed: 0.120097s/iter; left time: 10465.571041s
	iters: 1146, epoch: 5 | train_loss : 0.0011
	speed: 0.121812s/iter; left time: 10568.552891s
	iters: 1528, epoch: 5 | train_loss : 0.0007
	speed: 0.129629s/iter; left time: 11197.211612s
	iters: 1910, epoch: 5 | train_loss : 0.0016
	speed: 0.126457s/iter; left time: 10874.898178s
data: {'predict': array([162.48875494, 162.54668726, 162.52764538, ..., 103.92898334,
       105.31654676, 103.7545574 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:52:55] [32mIntermediate result: 0.022336609661579132  (Index 4)[0m
Epoch: 5 | cost time: 506.267062664032 | valid_loss: 0.022336609661579132 | valid_loss_true: 1.4362500843372388
Pretest loss in this epoch: 24.213439639790156
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0019
	speed: 0.835745s/iter; left time: 71551.468270s
	iters: 764, epoch: 6 | train_loss : 0.0009
	speed: 0.112999s/iter; left time: 9631.123627s
	iters: 1146, epoch: 6 | train_loss : 0.0007
	speed: 0.117251s/iter; left time: 9948.730232s
	iters: 1528, epoch: 6 | train_loss : 0.0012
	speed: 0.122122s/iter; left time: 10315.433468s
	iters: 1910, epoch: 6 | train_loss : 0.0009
	speed: 0.119003s/iter; left time: 10006.507255s
data: {'predict': array([162.34131933, 162.40399025, 162.38549839, ..., 102.15949368,
       103.68655554, 102.0021634 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:01:10] [32mIntermediate result: 0.02198060415685177  (Index 5)[0m
Epoch: 6 | cost time: 494.53731393814087 | valid_loss: 0.02198060415685177 | valid_loss_true: 1.43010151811039
Pretest loss in this epoch: 23.1205980081126
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0010
	speed: 0.811883s/iter; left time: 67957.022599s
	iters: 764, epoch: 7 | train_loss : 0.0019
	speed: 0.130076s/iter; left time: 10838.030275s
	iters: 1146, epoch: 7 | train_loss : 0.0007
	speed: 0.128118s/iter; left time: 10625.961418s
	iters: 1528, epoch: 7 | train_loss : 0.0012
	speed: 0.124434s/iter; left time: 10272.909066s
	iters: 1910, epoch: 7 | train_loss : 0.0013
	speed: 0.120383s/iter; left time: 9892.465116s
data: {'predict': array([162.59077888, 162.65421701, 162.63928757, ..., 104.96934775,
       106.661395  , 104.8209757 ]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:09:38] [32mIntermediate result: 0.022231223061680794  (Index 6)[0m
Epoch: 7 | cost time: 508.5429058074951 | valid_loss: 0.022231223061680794 | valid_loss_true: 1.4360183130930755
Pretest loss in this epoch: 23.212171930185395
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0009
	speed: 0.839283s/iter; left time: 68646.620749s
	iters: 764, epoch: 8 | train_loss : 0.0008
	speed: 0.119899s/iter; left time: 9760.973997s
	iters: 1146, epoch: 8 | train_loss : 0.0009
	speed: 0.119761s/iter; left time: 9703.971510s
	iters: 1528, epoch: 8 | train_loss : 0.0008
	speed: 0.118061s/iter; left time: 9521.139616s
	iters: 1910, epoch: 8 | train_loss : 0.0009
	speed: 0.131250s/iter; left time: 10534.670349s
data: {'predict': array([162.96472282, 163.03755919, 163.02473674, ..., 105.57717871,
       107.37923784, 105.43400785]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:18:03] [32mIntermediate result: 0.023367496207356453  (Index 7)[0m
Epoch: 8 | cost time: 504.87350034713745 | valid_loss: 0.023367496207356453 | valid_loss_true: 1.4840531659919498
Pretest loss in this epoch: 22.739279724392624
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0009
	speed: 0.831495s/iter; left time: 66420.656567s
	iters: 764, epoch: 9 | train_loss : 0.0010
	speed: 0.127492s/iter; left time: 10135.516997s
	iters: 1146, epoch: 9 | train_loss : 0.0007
	speed: 0.116639s/iter; left time: 9228.117686s
	iters: 1528, epoch: 9 | train_loss : 0.0010
	speed: 0.122801s/iter; left time: 9668.746556s
	iters: 1910, epoch: 9 | train_loss : 0.0013
	speed: 0.122054s/iter; left time: 9563.283285s
data: {'predict': array([162.62790363, 162.70388214, 162.69014582, ..., 106.05924755,
       107.965353  , 105.89614915]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:26:28] [32mIntermediate result: 0.021998979151248932  (Index 8)[0m
Epoch: 9 | cost time: 505.22406029701233 | valid_loss: 0.021998979151248932 | valid_loss_true: 1.439838790480713
Pretest loss in this epoch: 22.513674033085277
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0010
	speed: 0.832230s/iter; left time: 64888.989595s
	iters: 764, epoch: 10 | train_loss : 0.0009
	speed: 0.118410s/iter; left time: 9187.203700s
	iters: 1146, epoch: 10 | train_loss : 0.0009
	speed: 0.124153s/iter; left time: 9585.345042s
	iters: 1528, epoch: 10 | train_loss : 0.0010
	speed: 0.127458s/iter; left time: 9791.795613s
	iters: 1910, epoch: 10 | train_loss : 0.0009
	speed: 0.126156s/iter; left time: 9643.638465s
data: {'predict': array([162.82663468, 162.90074596, 162.88261796, ..., 108.21872473,
       110.19286306, 108.05427243]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:34:56] [32mIntermediate result: 0.022661037743091583  (Index 9)[0m
Epoch: 10 | cost time: 507.69134187698364 | valid_loss: 0.022661037743091583 | valid_loss_true: 1.4596670679685129
Pretest loss in this epoch: 22.40847258785399
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0008
	speed: 0.834411s/iter; left time: 63464.467537s
	iters: 764, epoch: 11 | train_loss : 0.0008
	speed: 0.122244s/iter; left time: 9251.063141s
	iters: 1146, epoch: 11 | train_loss : 0.0006
	speed: 0.121490s/iter; left time: 9147.578774s
	iters: 1528, epoch: 11 | train_loss : 0.0007
	speed: 0.120495s/iter; left time: 9026.672593s
	iters: 1910, epoch: 11 | train_loss : 0.0007
	speed: 0.114257s/iter; left time: 8515.684737s
data: {'predict': array([162.27160536, 162.34259424, 162.31911556, ..., 107.88218477,
       109.9431158 , 107.69986961]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:43:16] [32mIntermediate result: 0.021988030523061752  (Index 10)[0m
Epoch: 11 | cost time: 499.4345073699951 | valid_loss: 0.021988030523061752 | valid_loss_true: 1.437581416574452
Pretest loss in this epoch: 22.176875230562715
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0009
	speed: 0.821809s/iter; left time: 60935.487280s
	iters: 764, epoch: 12 | train_loss : 0.0267
	speed: 0.128221s/iter; left time: 9458.379479s
	iters: 1146, epoch: 12 | train_loss : 0.0009
	speed: 0.130684s/iter; left time: 9590.139575s
	iters: 1528, epoch: 12 | train_loss : 0.0006
	speed: 0.123398s/iter; left time: 9008.291777s
	iters: 1910, epoch: 12 | train_loss : 0.0006
	speed: 0.127216s/iter; left time: 9238.402865s
data: {'predict': array([162.79532319, 162.87268099, 162.85057594, ..., 109.49407337,
       111.5457895 , 109.29757059]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 20:51:45] [32mIntermediate result: 0.022184273228049278  (Index 11)[0m
Epoch: 12 | cost time: 509.4162712097168 | valid_loss: 0.022184273228049278 | valid_loss_true: 1.4514245257181306
Pretest loss in this epoch: 22.379327742740852
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0008
	speed: 0.832781s/iter; left time: 60157.601569s
	iters: 764, epoch: 13 | train_loss : 0.0099
	speed: 0.127881s/iter; left time: 9188.919001s
	iters: 1146, epoch: 13 | train_loss : 0.0007
	speed: 0.129929s/iter; left time: 9286.419266s
	iters: 1528, epoch: 13 | train_loss : 0.0027
	speed: 0.126002s/iter; left time: 8957.575367s
	iters: 1910, epoch: 13 | train_loss : 0.0008
	speed: 0.130135s/iter; left time: 9201.709762s
data: {'predict': array([162.85368142, 162.93046099, 162.9092134 , ..., 110.28091234,
       112.34169811, 110.08694669]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 21:00:15] [32mIntermediate result: 0.022517364472150803  (Index 12)[0m
Epoch: 13 | cost time: 510.0259211063385 | valid_loss: 0.022517364472150803 | valid_loss_true: 1.4580327768201364
Pretest loss in this epoch: 22.37771727563867
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0011
	speed: 0.823040s/iter; left time: 57881.136879s
	iters: 764, epoch: 14 | train_loss : 0.0009
	speed: 0.129914s/iter; left time: 9086.718944s
	iters: 1146, epoch: 14 | train_loss : 0.0007
	speed: 0.118627s/iter; left time: 8251.925442s
	iters: 1528, epoch: 14 | train_loss : 0.0006
	speed: 0.116389s/iter; left time: 8051.816191s
	iters: 1910, epoch: 14 | train_loss : 0.0008
	speed: 0.119731s/iter; left time: 8237.270038s
data: {'predict': array([162.77817112, 162.85481248, 162.83055814, ..., 110.26939723,
       112.37973673, 110.07386474]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 21:08:37] [32mIntermediate result: 0.022451117634773254  (Index 13)[0m
Epoch: 14 | cost time: 502.4291076660156 | valid_loss: 0.022451117634773254 | valid_loss_true: 1.4456944648351424
Pretest loss in this epoch: 21.705075236629604
Early stop with best valid_loss: 0.022451117634773254
[2024-03-11 21:08:37] [32mFinal result: 0.02198060415685177[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ› --target_cols 1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ› --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›', target_cols='1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 21:08:43.664584: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 21:08:43.664663: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 21:08:43.666480: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 21:08:43.675984: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 21:08:44.914370: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›
	iters: 382, epoch: 1 | train_loss : 0.0127
	speed: 0.133037s/iter; left time: 12661.003758s
	iters: 764, epoch: 1 | train_loss : 0.0127
	speed: 0.123218s/iter; left time: 11679.460803s
	iters: 1146, epoch: 1 | train_loss : 0.0132
	speed: 0.131501s/iter; left time: 12414.355201s
	iters: 1528, epoch: 1 | train_loss : 0.0062
	speed: 0.132203s/iter; left time: 12430.126284s
	iters: 1910, epoch: 1 | train_loss : 0.0093
	speed: 0.124456s/iter; left time: 11654.230696s
data: {'predict': array([0.56089868, 0.56158527, 0.5602568 , ..., 0.33355891, 0.33752025,
       0.33243525]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:17:17] [32mIntermediate result: 0.0983288511633873  (Index 0)[0m
Epoch: 1 | cost time: 505.36140036582947 | valid_loss: 0.0983288511633873 | valid_loss_true: 0.02434837471924617
Pretest loss in this epoch: 0.1428074602240958
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0284
	speed: 0.808758s/iter; left time: 75423.145455s
	iters: 764, epoch: 2 | train_loss : 0.0074
	speed: 0.110913s/iter; left time: 10301.157776s
	iters: 1146, epoch: 2 | train_loss : 0.0108
	speed: 0.114873s/iter; left time: 10625.083510s
	iters: 1528, epoch: 2 | train_loss : 0.0274
	speed: 0.118502s/iter; left time: 10915.487233s
	iters: 1910, epoch: 2 | train_loss : 0.0068
	speed: 0.121386s/iter; left time: 11134.726788s
data: {'predict': array([0.55568262, 0.55620174, 0.55408752, ..., 0.38773338, 0.39031796,
       0.38731968]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:25:34] [32mIntermediate result: 0.08988820761442184  (Index 1)[0m
Epoch: 2 | cost time: 497.08329248428345 | valid_loss: 0.08988820761442184 | valid_loss_true: 0.02314171940728523
Pretest loss in this epoch: 0.15970044681382498
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0048
	speed: 0.834530s/iter; left time: 76231.766383s
	iters: 764, epoch: 3 | train_loss : 0.0162
	speed: 0.136194s/iter; left time: 12388.851562s
	iters: 1146, epoch: 3 | train_loss : 0.0052
	speed: 0.122423s/iter; left time: 11089.470514s
	iters: 1528, epoch: 3 | train_loss : 0.0084
	speed: 0.119254s/iter; left time: 10756.829538s
	iters: 1910, epoch: 3 | train_loss : 0.0068
	speed: 0.120158s/iter; left time: 10792.507573s
data: {'predict': array([0.55585091, 0.55655349, 0.55407884, ..., 0.41325085, 0.41570321,
       0.41263957]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:34:00] [32mIntermediate result: 0.09009330719709396  (Index 2)[0m
Epoch: 3 | cost time: 505.4975645542145 | valid_loss: 0.09009330719709396 | valid_loss_true: 0.023231992049448945
Pretest loss in this epoch: 0.17747484558901389
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0066
	speed: 0.829611s/iter; left time: 74197.074154s
	iters: 764, epoch: 4 | train_loss : 0.0129
	speed: 0.121428s/iter; left time: 10813.625689s
	iters: 1146, epoch: 4 | train_loss : 0.0044
	speed: 0.124130s/iter; left time: 11006.870025s
	iters: 1528, epoch: 4 | train_loss : 0.0070
	speed: 0.129549s/iter; left time: 11437.867844s
	iters: 1910, epoch: 4 | train_loss : 0.0099
	speed: 0.132716s/iter; left time: 11666.832015s
data: {'predict': array([0.56104818, 0.56192691, 0.55936012, ..., 0.4296436 , 0.43224671,
       0.42894034]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:42:32] [32mIntermediate result: 0.09085863828659058  (Index 3)[0m
Epoch: 4 | cost time: 511.8796875476837 | valid_loss: 0.09085863828659058 | valid_loss_true: 0.02335762975585682
Pretest loss in this epoch: 0.19081075239362977
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0036
	speed: 0.828432s/iter; left time: 72508.527199s
	iters: 764, epoch: 5 | train_loss : 0.0050
	speed: 0.122603s/iter; left time: 10684.006513s
	iters: 1146, epoch: 5 | train_loss : 0.0075
	speed: 0.118297s/iter; left time: 10263.556504s
	iters: 1528, epoch: 5 | train_loss : 0.0042
	speed: 0.123254s/iter; left time: 10646.563591s
	iters: 1910, epoch: 5 | train_loss : 0.0056
	speed: 0.117358s/iter; left time: 10092.404354s
data: {'predict': array([0.56100354, 0.56192869, 0.55916718, ..., 0.43073453, 0.43328567,
       0.43016263]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:50:51] [32mIntermediate result: 0.09103719145059586  (Index 4)[0m
Epoch: 5 | cost time: 499.636922121048 | valid_loss: 0.09103719145059586 | valid_loss_true: 0.023423657766794545
Pretest loss in this epoch: 0.18509587264587146
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0064
	speed: 0.821009s/iter; left time: 70289.862276s
	iters: 764, epoch: 6 | train_loss : 0.0046
	speed: 0.127043s/iter; left time: 10828.108554s
	iters: 1146, epoch: 6 | train_loss : 0.0041
	speed: 0.142351s/iter; left time: 12078.503594s
	iters: 1528, epoch: 6 | train_loss : 0.0081
	speed: 0.119961s/iter; left time: 10132.854223s
	iters: 1910, epoch: 6 | train_loss : 0.0061
	speed: 0.117689s/iter; left time: 9896.028302s
data: {'predict': array([0.55394388, 0.5551683 , 0.55231328, ..., 0.43042916, 0.4332711 ,
       0.42990939]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 21:59:17] [32mIntermediate result: 0.08995646983385086  (Index 5)[0m
Epoch: 6 | cost time: 505.30757784843445 | valid_loss: 0.08995646983385086 | valid_loss_true: 0.023166190005494688
Pretest loss in this epoch: 0.18356465770806962
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0063
	speed: 0.825075s/iter; left time: 69061.268690s
	iters: 764, epoch: 7 | train_loss : 0.0097
	speed: 0.121411s/iter; left time: 10116.090216s
	iters: 1146, epoch: 7 | train_loss : 0.0048
	speed: 0.118433s/iter; left time: 9822.740203s
	iters: 1528, epoch: 7 | train_loss : 0.0042
	speed: 0.114844s/iter; left time: 9481.195649s
	iters: 1910, epoch: 7 | train_loss : 0.0052
	speed: 0.121725s/iter; left time: 10002.752953s
data: {'predict': array([0.55896973, 0.56028757, 0.55722223, ..., 0.42919626, 0.43194339,
       0.42884419]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:07:26] [32mIntermediate result: 0.09022737294435501  (Index 6)[0m
Epoch: 7 | cost time: 488.92896246910095 | valid_loss: 0.09022737294435501 | valid_loss_true: 0.02345405028221449
Pretest loss in this epoch: 0.17983968240258794
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0046
	speed: 0.804760s/iter; left time: 65822.962528s
	iters: 764, epoch: 8 | train_loss : 0.0064
	speed: 0.130313s/iter; left time: 10608.764675s
	iters: 1146, epoch: 8 | train_loss : 0.0052
	speed: 0.121955s/iter; left time: 9881.729508s
	iters: 1528, epoch: 8 | train_loss : 0.0040
	speed: 0.119991s/iter; left time: 9676.815108s
	iters: 1910, epoch: 8 | train_loss : 0.0080
	speed: 0.115894s/iter; left time: 9302.084952s
data: {'predict': array([0.5528817 , 0.55422816, 0.55124962, ..., 0.43214845, 0.43474659,
       0.43188962]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:15:31] [32mIntermediate result: 0.08900555223226547  (Index 7)[0m
Epoch: 8 | cost time: 485.2786955833435 | valid_loss: 0.08900555223226547 | valid_loss_true: 0.023137716246214836
Pretest loss in this epoch: 0.18140156377485622
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0065
	speed: 0.776026s/iter; left time: 61989.723326s
	iters: 764, epoch: 9 | train_loss : 0.0064
	speed: 0.121673s/iter; left time: 9672.848071s
	iters: 1146, epoch: 9 | train_loss : 0.0079
	speed: 0.137125s/iter; left time: 10848.929758s
	iters: 1528, epoch: 9 | train_loss : 0.0045
	speed: 0.126428s/iter; left time: 9954.294523s
	iters: 1910, epoch: 9 | train_loss : 0.0104
	speed: 0.122890s/iter; left time: 9628.789847s
data: {'predict': array([0.55521906, 0.55670427, 0.55357683, ..., 0.42887965, 0.43152177,
       0.42869436]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:23:39] [32mIntermediate result: 0.0881553664803505  (Index 8)[0m
Epoch: 9 | cost time: 487.54521131515503 | valid_loss: 0.0881553664803505 | valid_loss_true: 0.023032661575859818
Pretest loss in this epoch: 0.17469296803791504
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0049
	speed: 0.771022s/iter; left time: 60116.597330s
	iters: 764, epoch: 10 | train_loss : 0.0090
	speed: 0.121601s/iter; left time: 9434.782689s
	iters: 1146, epoch: 10 | train_loss : 0.0094
	speed: 0.117201s/iter; left time: 9048.594191s
	iters: 1528, epoch: 10 | train_loss : 0.0048
	speed: 0.119126s/iter; left time: 9151.771523s
	iters: 1910, epoch: 10 | train_loss : 0.0058
	speed: 0.116374s/iter; left time: 8895.882936s
data: {'predict': array([0.55822939, 0.55962438, 0.55651971, ..., 0.42854835, 0.43146283,
       0.42838165]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:31:32] [32mIntermediate result: 0.0883156806230545  (Index 9)[0m
Epoch: 10 | cost time: 473.45763063430786 | valid_loss: 0.0883156806230545 | valid_loss_true: 0.023069828200825364
Pretest loss in this epoch: 0.17146713610580444
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0044
	speed: 0.759387s/iter; left time: 57758.222579s
	iters: 764, epoch: 11 | train_loss : 0.0060
	speed: 0.125093s/iter; left time: 9466.668684s
	iters: 1146, epoch: 11 | train_loss : 0.0054
	speed: 0.124629s/iter; left time: 9383.972236s
	iters: 1528, epoch: 11 | train_loss : 0.0055
	speed: 0.118721s/iter; left time: 8893.742547s
	iters: 1910, epoch: 11 | train_loss : 0.0056
	speed: 0.121198s/iter; left time: 9033.041358s
data: {'predict': array([0.55507723, 0.5562625 , 0.55309528, ..., 0.42495672, 0.42794223,
       0.4249026 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:39:17] [32mIntermediate result: 0.08760681003332138  (Index 10)[0m
Epoch: 11 | cost time: 465.0315454006195 | valid_loss: 0.08760681003332138 | valid_loss_true: 0.02292649501334347
Pretest loss in this epoch: 0.17005726529534274
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-10.pth
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0096
	speed: 0.733357s/iter; left time: 54376.970300s
	iters: 764, epoch: 12 | train_loss : 0.0056
	speed: 0.125256s/iter; left time: 9239.665616s
	iters: 1146, epoch: 12 | train_loss : 0.0061
	speed: 0.118402s/iter; left time: 8688.843320s
	iters: 1528, epoch: 12 | train_loss : 0.0056
	speed: 0.125267s/iter; left time: 9144.772296s
	iters: 1910, epoch: 12 | train_loss : 0.0051
	speed: 0.121740s/iter; left time: 8840.785163s
data: {'predict': array([0.55920555, 0.56058278, 0.55752667, ..., 0.4219872 , 0.42525583,
       0.42193586]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:47:08] [32mIntermediate result: 0.08842784911394119  (Index 11)[0m
Epoch: 12 | cost time: 470.8260324001312 | valid_loss: 0.08842784911394119 | valid_loss_true: 0.023134863088289194
Pretest loss in this epoch: 0.1642027344424049
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0049
	speed: 0.739865s/iter; left time: 53445.595568s
	iters: 764, epoch: 13 | train_loss : 0.0074
	speed: 0.127684s/iter; left time: 9174.708950s
	iters: 1146, epoch: 13 | train_loss : 0.0062
	speed: 0.119483s/iter; left time: 8539.820705s
	iters: 1528, epoch: 13 | train_loss : 0.0085
	speed: 0.116999s/iter; left time: 8317.565404s
	iters: 1910, epoch: 13 | train_loss : 0.0054
	speed: 0.116304s/iter; left time: 8223.768399s
data: {'predict': array([0.55808794, 0.55942929, 0.55627528, ..., 0.42176159, 0.42497957,
       0.42182933]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 22:54:47] [32mIntermediate result: 0.08824779838323593  (Index 12)[0m
Epoch: 13 | cost time: 459.0205764770508 | valid_loss: 0.08824779838323593 | valid_loss_true: 0.02308372529890435
Pretest loss in this epoch: 0.16281816145347816
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0091
	speed: 0.711817s/iter; left time: 50059.244136s
	iters: 764, epoch: 14 | train_loss : 0.0063
	speed: 0.114460s/iter; left time: 8005.817625s
	iters: 1146, epoch: 14 | train_loss : 0.0062
	speed: 0.113653s/iter; left time: 7905.961557s
	iters: 1528, epoch: 14 | train_loss : 0.0059
	speed: 0.117711s/iter; left time: 8143.215014s
	iters: 1910, epoch: 14 | train_loss : 0.0050
	speed: 0.113231s/iter; left time: 7790.052287s
data: {'predict': array([0.55863676, 0.55995736, 0.55684675, ..., 0.41787995, 0.42116416,
       0.41802993]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 23:02:18] [32mIntermediate result: 0.08840926736593246  (Index 13)[0m
Epoch: 14 | cost time: 451.44708156585693 | valid_loss: 0.08840926736593246 | valid_loss_true: 0.02309400723409731
Pretest loss in this epoch: 0.1599814602173718
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0051
	speed: 0.731019s/iter; left time: 50012.685004s
	iters: 764, epoch: 15 | train_loss : 0.0072
	speed: 0.117550s/iter; left time: 7997.259820s
	iters: 1146, epoch: 15 | train_loss : 0.0041
	speed: 0.120697s/iter; left time: 8165.291512s
	iters: 1528, epoch: 15 | train_loss : 0.0044
	speed: 0.118706s/iter; left time: 7985.257579s
	iters: 1910, epoch: 15 | train_loss : 0.0062
	speed: 0.121965s/iter; left time: 8157.864073s
data: {'predict': array([0.55563108, 0.55692964, 0.55371512, ..., 0.41623836, 0.41967203,
       0.41641581]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 23:13:12] [32mIntermediate result: 0.08750055730342865  (Index 14)[0m
Epoch: 15 | cost time: 653.862982749939 | valid_loss: 0.08750055730342865 | valid_loss_true: 0.022891795015471676
Pretest loss in this epoch: 0.15924281399414825
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0093
	speed: 1.273341s/iter; left time: 84682.241624s
	iters: 764, epoch: 16 | train_loss : 0.0056
	speed: 0.158877s/iter; left time: 10505.251095s
	iters: 1146, epoch: 16 | train_loss : 0.0069
	speed: 0.155856s/iter; left time: 10245.959297s
	iters: 1528, epoch: 16 | train_loss : 0.0100
	speed: 0.162396s/iter; left time: 10613.895656s
	iters: 1910, epoch: 16 | train_loss : 0.0199
	speed: 0.164917s/iter; left time: 10715.626005s
data: {'predict': array([0.55811828, 0.55941748, 0.55622811, ..., 0.4161344 , 0.41979064,
       0.41632786]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 23:25:42] [32mIntermediate result: 0.08844535797834396  (Index 15)[0m
Epoch: 16 | cost time: 749.8613893985748 | valid_loss: 0.08844535797834396 | valid_loss_true: 0.023127802289500142
Pretest loss in this epoch: 0.15945340996317744
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0078
	speed: 1.324274s/iter; left time: 85538.814200s
	iters: 764, epoch: 17 | train_loss : 0.0049
	speed: 0.149030s/iter; left time: 9569.370708s
	iters: 1146, epoch: 17 | train_loss : 0.0044
	speed: 0.144289s/iter; left time: 9209.841536s
	iters: 1528, epoch: 17 | train_loss : 0.0054
	speed: 0.159347s/iter; left time: 10110.120823s
	iters: 1910, epoch: 17 | train_loss : 0.0042
	speed: 0.166547s/iter; left time: 10503.279122s
data: {'predict': array([0.55581622, 0.55714625, 0.55398667, ..., 0.41305072, 0.41674353,
       0.41331299]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 23:38:50] [32mIntermediate result: 0.0877443477511406  (Index 16)[0m
Epoch: 17 | cost time: 787.4010419845581 | valid_loss: 0.0877443477511406 | valid_loss_true: 0.02299084616333839
Pretest loss in this epoch: 0.15651967874112516
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0042
	speed: 1.441686s/iter; left time: 90367.773581s
	iters: 764, epoch: 18 | train_loss : 0.0063
	speed: 0.163223s/iter; left time: 10168.776964s
	iters: 1146, epoch: 18 | train_loss : 0.0099
	speed: 0.166240s/iter; left time: 10293.264665s
	iters: 1528, epoch: 18 | train_loss : 0.0074
	speed: 0.143754s/iter; left time: 8846.053391s
	iters: 1910, epoch: 18 | train_loss : 0.0041
	speed: 0.143452s/iter; left time: 8772.666180s
data: {'predict': array([0.55755392, 0.55885845, 0.55550803, ..., 0.41294207, 0.41664524,
       0.41321071]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 23:49:45] [32mIntermediate result: 0.08797228336334229  (Index 17)[0m
Epoch: 18 | cost time: 655.136109828949 | valid_loss: 0.08797228336334229 | valid_loss_true: 0.023060962195940723
Pretest loss in this epoch: 0.15737889087201812
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0062
	speed: 1.086058s/iter; left time: 66000.840997s
	iters: 764, epoch: 19 | train_loss : 0.0070
	speed: 0.149163s/iter; left time: 9007.786067s
	iters: 1146, epoch: 19 | train_loss : 0.0350
	speed: 0.160189s/iter; left time: 9612.432229s
	iters: 1528, epoch: 19 | train_loss : 0.0090
	speed: 0.151706s/iter; left time: 9045.461744s
	iters: 1910, epoch: 19 | train_loss : 0.0119
	speed: 0.145220s/iter; left time: 8603.294348s
data: {'predict': array([0.55473652, 0.55611543, 0.55292651, ..., 0.41124898, 0.41499223,
       0.41153452]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-12 00:01:04] [32mIntermediate result: 0.08774828165769577  (Index 18)[0m
Epoch: 19 | cost time: 679.1119728088379 | valid_loss: 0.08774828165769577 | valid_loss_true: 0.02298259688532382
Pretest loss in this epoch: 0.15577545955305314
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0065
	speed: 1.157413s/iter; left time: 68125.357259s
	iters: 764, epoch: 20 | train_loss : 0.0107
	speed: 0.146034s/iter; left time: 8539.774635s
	iters: 1146, epoch: 20 | train_loss : 0.0063
	speed: 0.139116s/iter; left time: 8082.086117s
	iters: 1528, epoch: 20 | train_loss : 0.0088
	speed: 0.124705s/iter; left time: 7197.230318s
	iters: 1910, epoch: 20 | train_loss : 0.0118
	speed: 0.140945s/iter; left time: 8080.641109s
data: {'predict': array([0.55653141, 0.55784857, 0.5545902 , ..., 0.41077263, 0.41460154,
       0.41106923]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-12 00:10:26] [32mIntermediate result: 0.0878039002418518  (Index 19)[0m
Epoch: 20 | cost time: 561.8861150741577 | valid_loss: 0.0878039002418518 | valid_loss_true: 0.023005621464073738
Pretest loss in this epoch: 0.1545416167656575
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.0092
	speed: 0.910998s/iter; left time: 51880.445285s
	iters: 764, epoch: 21 | train_loss : 0.0050
	speed: 0.130591s/iter; left time: 7387.120263s
	iters: 1146, epoch: 21 | train_loss : 0.0086
	speed: 0.131957s/iter; left time: 7414.001476s
	iters: 1528, epoch: 21 | train_loss : 0.0059
	speed: 0.126848s/iter; left time: 7078.480722s
	iters: 1910, epoch: 21 | train_loss : 0.0050
	speed: 0.126822s/iter; left time: 7028.583094s
data: {'predict': array([0.55674116, 0.55805696, 0.55479569, ..., 0.4104716 , 0.41436154,
       0.41079563]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-12 00:19:40] [32mIntermediate result: 0.08799983561038971  (Index 20)[0m
Epoch: 21 | cost time: 554.4834179878235 | valid_loss: 0.08799983561038971 | valid_loss_true: 0.023061371602694305
Pretest loss in this epoch: 0.1546261002288794
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.0043
	speed: 0.928529s/iter; left time: 51104.363838s
	iters: 764, epoch: 22 | train_loss : 0.0066
	speed: 0.125233s/iter; left time: 6844.730031s
	iters: 1146, epoch: 22 | train_loss : 0.0044
	speed: 0.133741s/iter; left time: 7258.654999s
	iters: 1528, epoch: 22 | train_loss : 0.0056
	speed: 0.134636s/iter; left time: 7255.821317s
	iters: 1910, epoch: 22 | train_loss : 0.0056
	speed: 0.129548s/iter; left time: 6932.105453s
data: {'predict': array([0.55733436, 0.55864685, 0.55541248, ..., 0.40775066, 0.41172892,
       0.40808413]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-12 00:29:08] [32mIntermediate result: 0.08816264569759369  (Index 21)[0m
Epoch: 22 | cost time: 567.6235542297363 | valid_loss: 0.08816264569759369 | valid_loss_true: 0.023100463316047183
Pretest loss in this epoch: 0.15370534710742517
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0030
	speed: 0.975399s/iter; left time: 51820.038913s
	iters: 764, epoch: 23 | train_loss : 0.0051
	speed: 0.121908s/iter; left time: 6430.060241s
	iters: 1146, epoch: 23 | train_loss : 0.0048
	speed: 0.125612s/iter; left time: 6577.441609s
	iters: 1528, epoch: 23 | train_loss : 0.0055
	speed: 0.132265s/iter; left time: 6875.265398s
	iters: 1910, epoch: 23 | train_loss : 0.0068
	speed: 0.136944s/iter; left time: 7066.198930s
data: {'predict': array([0.5554874 , 0.55677386, 0.55347625, ..., 0.40647452, 0.41046844,
       0.40682987]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-12 00:38:25] [32mIntermediate result: 0.08788248896598816  (Index 22)[0m
Epoch: 23 | cost time: 557.6266260147095 | valid_loss: 0.08788248896598816 | valid_loss_true: 0.023014314672481304
Pretest loss in this epoch: 0.15285163762637485
Early stop with best valid_loss: 0.08788248896598816
[2024-03-12 00:38:25] [32mFinal result: 0.08750055730342865[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --target_cols 1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦', target_cols='1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-12 00:38:31.683351: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-12 00:38:31.683404: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-12 00:38:31.685057: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-12 00:38:31.695340: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 00:38:33.069647: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1æ•ˆå‡ºæ–™æ¸©åº¦,1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦
	iters: 382, epoch: 1 | train_loss : 0.0114
	speed: 0.147539s/iter; left time: 14041.156101s
	iters: 764, epoch: 1 | train_loss : 0.0086
	speed: 0.132691s/iter; left time: 12577.408098s
	iters: 1146, epoch: 1 | train_loss : 0.0043
	speed: 0.131231s/iter; left time: 12388.858693s
	iters: 1528, epoch: 1 | train_loss : 0.0022
	speed: 0.129648s/iter; left time: 12189.857536s
	iters: 1910, epoch: 1 | train_loss : 0.0032
	speed: 0.134045s/iter; left time: 12552.121332s
data: {'predict': array([137.59126968, 137.71564874, 137.78675346, ..., 126.82903824,
       126.86654636, 126.80457243]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 00:47:33] [32mIntermediate result: 0.021160725504159927  (Index 0)[0m
Epoch: 1 | cost time: 532.9645457267761 | valid_loss: 0.021160725504159927 | valid_loss_true: 1.0913808707754222
Pretest loss in this epoch: 42.610204612549104
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0097
	speed: 0.847606s/iter; left time: 79046.027645s
	iters: 764, epoch: 2 | train_loss : 0.0017
	speed: 0.116074s/iter; left time: 10780.499871s
	iters: 1146, epoch: 2 | train_loss : 0.0028
	speed: 0.129432s/iter; left time: 11971.642459s
	iters: 1528, epoch: 2 | train_loss : 0.0054
	speed: 0.125394s/iter; left time: 11550.331204s
	iters: 1910, epoch: 2 | train_loss : 0.0015
	speed: 0.121266s/iter; left time: 11123.701949s
data: {'predict': array([137.54398278, 137.65653305, 137.69956912, ..., 131.45236831,
       131.54431951, 131.40099789]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 00:56:22] [32mIntermediate result: 0.01937011629343033  (Index 1)[0m
Epoch: 2 | cost time: 528.7479529380798 | valid_loss: 0.01937011629343033 | valid_loss_true: 1.0775034153247514
Pretest loss in this epoch: 46.26710986102993
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0019
	speed: 0.898182s/iter; left time: 82046.187155s
	iters: 764, epoch: 3 | train_loss : 0.0022
	speed: 0.121202s/iter; left time: 11025.134380s
	iters: 1146, epoch: 3 | train_loss : 0.0025
	speed: 0.121960s/iter; left time: 11047.530968s
	iters: 1528, epoch: 3 | train_loss : 0.0016
	speed: 0.117013s/iter; left time: 10554.732799s
	iters: 1910, epoch: 3 | train_loss : 0.0014
	speed: 0.127351s/iter; left time: 11438.520469s
data: {'predict': array([137.09456519, 137.18245172, 137.20096543, ..., 132.96353798,
       133.04629241, 132.90234871]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:04:56] [32mIntermediate result: 0.01828160509467125  (Index 2)[0m
Epoch: 3 | cost time: 514.7149105072021 | valid_loss: 0.01828160509467125 | valid_loss_true: 0.9916061728065244
Pretest loss in this epoch: 47.80130687214154
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0012
	speed: 0.865396s/iter; left time: 77397.600671s
	iters: 764, epoch: 4 | train_loss : 0.0012
	speed: 0.129761s/iter; left time: 11555.729087s
	iters: 1146, epoch: 4 | train_loss : 0.0011
	speed: 0.129926s/iter; left time: 11520.821292s
	iters: 1528, epoch: 4 | train_loss : 0.0013
	speed: 0.125244s/iter; left time: 11057.783685s
	iters: 1910, epoch: 4 | train_loss : 0.0036
	speed: 0.127212s/iter; left time: 11182.968639s
data: {'predict': array([136.86697637, 136.95981355, 136.98595   , ..., 134.85586225,
       134.92070855, 134.78113585]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:13:18] [32mIntermediate result: 0.018945612013339996  (Index 3)[0m
Epoch: 4 | cost time: 501.6782352924347 | valid_loss: 0.018945612013339996 | valid_loss_true: 0.9874196203126194
Pretest loss in this epoch: 49.23094615437751
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0007
	speed: 0.793356s/iter; left time: 69438.446355s
	iters: 764, epoch: 5 | train_loss : 0.0011
	speed: 0.121067s/iter; left time: 10550.157054s
	iters: 1146, epoch: 5 | train_loss : 0.0015
	speed: 0.118898s/iter; left time: 10315.715802s
	iters: 1528, epoch: 5 | train_loss : 0.0009
	speed: 0.130360s/iter; left time: 11260.334992s
	iters: 1910, epoch: 5 | train_loss : 0.0014
	speed: 0.120303s/iter; left time: 10345.702766s
data: {'predict': array([137.02382217, 137.09694627, 137.10976943, ..., 134.10178489,
       134.17624502, 134.03221178]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:22:01] [32mIntermediate result: 0.018913712352514267  (Index 4)[0m
Epoch: 5 | cost time: 523.3952224254608 | valid_loss: 0.018913712352514267 | valid_loss_true: 0.9868594912053882
Pretest loss in this epoch: 47.89383595694535
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0024
	speed: 0.881494s/iter; left time: 75468.231939s
	iters: 764, epoch: 6 | train_loss : 0.0008
	speed: 0.123509s/iter; left time: 10526.938620s
	iters: 1146, epoch: 6 | train_loss : 0.0008
	speed: 0.124118s/iter; left time: 10531.441939s
	iters: 1528, epoch: 6 | train_loss : 0.0012
	speed: 0.121497s/iter; left time: 10262.647193s
	iters: 1910, epoch: 6 | train_loss : 0.0007
	speed: 0.123214s/iter; left time: 10360.610783s
data: {'predict': array([136.89474222, 136.97146915, 136.98944798, ..., 134.48738236,
       134.53999811, 134.41930789]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:30:39] [32mIntermediate result: 0.01795102283358574  (Index 5)[0m
Epoch: 6 | cost time: 517.6354355812073 | valid_loss: 0.01795102283358574 | valid_loss_true: 0.9604179932618768
Pretest loss in this epoch: 48.734882298516666
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0018
	speed: 0.825146s/iter; left time: 69067.193636s
	iters: 764, epoch: 7 | train_loss : 0.0034
	speed: 0.100677s/iter; left time: 8388.503141s
	iters: 1146, epoch: 7 | train_loss : 0.0009
	speed: 0.096829s/iter; left time: 8030.931692s
	iters: 1528, epoch: 7 | train_loss : 0.0016
	speed: 0.088006s/iter; left time: 7265.528984s
	iters: 1910, epoch: 7 | train_loss : 0.0010
	speed: 0.089049s/iter; left time: 7317.594170s
data: {'predict': array([136.82361041, 136.90627058, 136.92797006, ..., 135.35036711,
       135.37046192, 135.27725479]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:38:12] [32mIntermediate result: 0.01803465001285076  (Index 6)[0m
Epoch: 7 | cost time: 452.8580596446991 | valid_loss: 0.01803465001285076 | valid_loss_true: 0.9633228666840696
Pretest loss in this epoch: 49.473691251445885
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0017
	speed: 0.815572s/iter; left time: 66707.254277s
	iters: 764, epoch: 8 | train_loss : 0.0010
	speed: 0.091090s/iter; left time: 7415.669021s
	iters: 1146, epoch: 8 | train_loss : 0.0008
	speed: 0.095934s/iter; left time: 7773.363390s
	iters: 1528, epoch: 8 | train_loss : 0.0010
	speed: 0.090220s/iter; left time: 7275.879864s
	iters: 1910, epoch: 8 | train_loss : 0.0009
	speed: 0.097583s/iter; left time: 7832.426956s
data: {'predict': array([137.17387113, 137.26002339, 137.28613628, ..., 134.39628298,
       134.41565321, 134.31834725]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:45:56] [32mIntermediate result: 0.018090544268488884  (Index 7)[0m
Epoch: 8 | cost time: 463.6148900985718 | valid_loss: 0.018090544268488884 | valid_loss_true: 0.9744987258247124
Pretest loss in this epoch: 49.09493765741748
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0011
	speed: 0.851870s/iter; left time: 68048.201499s
	iters: 764, epoch: 9 | train_loss : 0.0018
	speed: 0.099494s/iter; left time: 7909.643517s
	iters: 1146, epoch: 9 | train_loss : 0.0012
	speed: 0.102515s/iter; left time: 8110.709501s
	iters: 1528, epoch: 9 | train_loss : 0.0010
	speed: 0.099105s/iter; left time: 7803.022828s
	iters: 1910, epoch: 9 | train_loss : 0.0007
	speed: 0.095820s/iter; left time: 7507.787544s
data: {'predict': array([136.87901605, 136.96859914, 136.99825831, ..., 135.89208463,
       135.894137  , 135.81030101]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 01:54:06] [32mIntermediate result: 0.017801864072680473  (Index 8)[0m
Epoch: 9 | cost time: 490.94453501701355 | valid_loss: 0.017801864072680473 | valid_loss_true: 0.9612952945937475
Pretest loss in this epoch: 50.378002908987504
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0126
	speed: 0.875216s/iter; left time: 68240.612669s
	iters: 764, epoch: 10 | train_loss : 0.0014
	speed: 0.094847s/iter; left time: 7358.957566s
	iters: 1146, epoch: 10 | train_loss : 0.0011
	speed: 0.101538s/iter; left time: 7839.315144s
	iters: 1528, epoch: 10 | train_loss : 0.0013
	speed: 0.099542s/iter; left time: 7647.178208s
	iters: 1910, epoch: 10 | train_loss : 0.0013
	speed: 0.095046s/iter; left time: 7265.483981s
data: {'predict': array([137.30443792, 137.39263313, 137.42253971, ..., 136.17970812,
       136.16644903, 136.1000829 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:02:37] [32mIntermediate result: 0.02048603445291519  (Index 9)[0m
Epoch: 10 | cost time: 510.4949195384979 | valid_loss: 0.02048603445291519 | valid_loss_true: 1.0480699310670893
Pretest loss in this epoch: 50.74566513261054
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.0018
	speed: 0.951091s/iter; left time: 72339.062501s
	iters: 764, epoch: 11 | train_loss : 0.0013
	speed: 0.106851s/iter; left time: 8086.189799s
	iters: 1146, epoch: 11 | train_loss : 0.0011
	speed: 0.110150s/iter; left time: 8293.761652s
	iters: 1528, epoch: 11 | train_loss : 0.0016
	speed: 0.129465s/iter; left time: 9698.592528s
	iters: 1910, epoch: 11 | train_loss : 0.0007
	speed: 0.126603s/iter; left time: 9435.882742s
data: {'predict': array([136.93404704, 137.02288081, 137.05224309, ..., 135.90660083,
       135.87712781, 135.82085621]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:12:05] [32mIntermediate result: 0.018175391480326653  (Index 10)[0m
Epoch: 11 | cost time: 568.4435534477234 | valid_loss: 0.018175391480326653 | valid_loss_true: 0.9626824582297382
Pretest loss in this epoch: 50.827523691246405
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.0009
	speed: 1.034667s/iter; left time: 76718.494786s
	iters: 764, epoch: 12 | train_loss : 0.0375
	speed: 0.103483s/iter; left time: 7633.523781s
	iters: 1146, epoch: 12 | train_loss : 0.0007
	speed: 0.102285s/iter; left time: 7506.077130s
	iters: 1528, epoch: 12 | train_loss : 0.0007
	speed: 0.110640s/iter; left time: 8076.910592s
	iters: 1910, epoch: 12 | train_loss : 0.0006
	speed: 0.109601s/iter; left time: 7959.256997s
data: {'predict': array([136.88899984, 136.98287381, 137.0165034 , ..., 136.90677602,
       136.85987556, 136.82455647]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:21:00] [32mIntermediate result: 0.017705272883176804  (Index 11)[0m
Epoch: 12 | cost time: 534.7898252010345 | valid_loss: 0.017705272883176804 | valid_loss_true: 0.9595327957283111
Pretest loss in this epoch: 52.155746332471395
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-11.pth
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.0008
	speed: 0.960609s/iter; left time: 69391.480351s
	iters: 764, epoch: 13 | train_loss : 0.0073
	speed: 0.108407s/iter; left time: 7789.601173s
	iters: 1146, epoch: 13 | train_loss : 0.0008
	speed: 0.106546s/iter; left time: 7615.163822s
	iters: 1528, epoch: 13 | train_loss : 0.0035
	speed: 0.107637s/iter; left time: 7652.021103s
	iters: 1910, epoch: 13 | train_loss : 0.0008
	speed: 0.104304s/iter; left time: 7375.197623s
data: {'predict': array([137.13994228, 137.23376912, 137.2658506 , ..., 136.95086537,
       136.89877627, 136.86706473]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:29:33] [32mIntermediate result: 0.018710585311055183  (Index 12)[0m
Epoch: 13 | cost time: 513.181898355484 | valid_loss: 0.018710585311055183 | valid_loss_true: 0.99113942453835
Pretest loss in this epoch: 52.05234304145092
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.0016
	speed: 0.920807s/iter; left time: 64756.641232s
	iters: 764, epoch: 14 | train_loss : 0.0007
	speed: 0.113517s/iter; left time: 7939.822731s
	iters: 1146, epoch: 14 | train_loss : 0.0010
	speed: 0.100373s/iter; left time: 6982.134669s
	iters: 1528, epoch: 14 | train_loss : 0.0012
	speed: 0.107985s/iter; left time: 7470.386477s
	iters: 1910, epoch: 14 | train_loss : 0.0007
	speed: 0.105035s/iter; left time: 7226.173099s
data: {'predict': array([137.15856674, 137.2517126 , 137.28554013, ..., 137.41065436,
       137.35041941, 137.32991696]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:38:41] [32mIntermediate result: 0.01984773576259613  (Index 13)[0m
Epoch: 14 | cost time: 547.1902244091034 | valid_loss: 0.01984773576259613 | valid_loss_true: 1.006056764956302
Pretest loss in this epoch: 52.806735606778254
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.0007
	speed: 1.010994s/iter; left time: 69167.175943s
	iters: 764, epoch: 15 | train_loss : 0.0024
	speed: 0.094891s/iter; left time: 6455.712578s
	iters: 1146, epoch: 15 | train_loss : 0.0007
	speed: 0.100969s/iter; left time: 6830.679238s
	iters: 1528, epoch: 15 | train_loss : 0.0005
	speed: 0.083245s/iter; left time: 5599.776604s
	iters: 1910, epoch: 15 | train_loss : 0.0009
	speed: 0.094900s/iter; left time: 6347.573430s
data: {'predict': array([137.22684033, 137.31911788, 137.35133838, ..., 136.97494828,
       136.90792944, 136.89230224]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:46:32] [32mIntermediate result: 0.018879150971770287  (Index 14)[0m
Epoch: 15 | cost time: 470.88798999786377 | valid_loss: 0.018879150971770287 | valid_loss_true: 0.9999012181413772
Pretest loss in this epoch: 52.45466436877287
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.0010
	speed: 0.816651s/iter; left time: 54310.541445s
	iters: 764, epoch: 16 | train_loss : 0.0037
	speed: 0.065885s/iter; left time: 4356.463047s
	iters: 1146, epoch: 16 | train_loss : 0.0015
	speed: 0.076512s/iter; left time: 5029.909364s
	iters: 1528, epoch: 16 | train_loss : 0.0316
	speed: 0.069214s/iter; left time: 4523.681115s
	iters: 1910, epoch: 16 | train_loss : 0.0018
	speed: 0.079104s/iter; left time: 5139.849848s
data: {'predict': array([137.35472679, 137.45204807, 137.48750618, ..., 137.59435648,
       137.51927427, 137.51432597]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 02:53:36] [32mIntermediate result: 0.020103467628359795  (Index 15)[0m
Epoch: 16 | cost time: 424.20502185821533 | valid_loss: 0.020103467628359795 | valid_loss_true: 1.043025664673461
Pretest loss in this epoch: 53.07030584372636
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.0009
	speed: 0.826595s/iter; left time: 53392.241237s
	iters: 764, epoch: 17 | train_loss : 0.0027
	speed: 0.076169s/iter; left time: 4890.910518s
	iters: 1146, epoch: 17 | train_loss : 0.0042
	speed: 0.071104s/iter; left time: 4538.468676s
	iters: 1528, epoch: 17 | train_loss : 0.0008
	speed: 0.078938s/iter; left time: 5008.382762s
	iters: 1910, epoch: 17 | train_loss : 0.0012
	speed: 0.079215s/iter; left time: 4995.709865s
data: {'predict': array([137.08146162, 137.17682715, 137.21125082, ..., 137.72773909,
       137.64725145, 137.64647857]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 03:00:09] [32mIntermediate result: 0.018174078315496445  (Index 16)[0m
Epoch: 17 | cost time: 392.8402454853058 | valid_loss: 0.018174078315496445 | valid_loss_true: 0.9769593967180069
Pretest loss in this epoch: 53.29644242087038
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.0007
	speed: 0.711052s/iter; left time: 44570.158426s
	iters: 764, epoch: 18 | train_loss : 0.0009
	speed: 0.062464s/iter; left time: 3891.504714s
	iters: 1146, epoch: 18 | train_loss : 0.0061
	speed: 0.061602s/iter; left time: 3814.291505s
	iters: 1528, epoch: 18 | train_loss : 0.0138
	speed: 0.060978s/iter; left time: 3752.364604s
	iters: 1910, epoch: 18 | train_loss : 0.0015
	speed: 0.062328s/iter; left time: 3811.601113s
data: {'predict': array([137.09552422, 137.18737174, 137.22021196, ..., 137.66965547,
       137.58999255, 137.58704713]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 03:06:17] [32mIntermediate result: 0.018474306911230087  (Index 17)[0m
Epoch: 18 | cost time: 368.5502381324768 | valid_loss: 0.018474306911230087 | valid_loss_true: 0.9763801222804908
Pretest loss in this epoch: 53.37005144550597
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.0006
	speed: 0.717703s/iter; left time: 43615.547092s
	iters: 764, epoch: 19 | train_loss : 0.0011
	speed: 0.069917s/iter; left time: 4222.235678s
	iters: 1146, epoch: 19 | train_loss : 0.0024
	speed: 0.070755s/iter; left time: 4245.798312s
	iters: 1528, epoch: 19 | train_loss : 0.0034
	speed: 0.070971s/iter; left time: 4231.641499s
	iters: 1910, epoch: 19 | train_loss : 0.0026
	speed: 0.073639s/iter; left time: 4362.623653s
data: {'predict': array([136.99907124, 137.09493867, 137.13052637, ..., 138.05478639,
       137.96866712, 137.97382513]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 03:12:43] [32mIntermediate result: 0.01831052452325821  (Index 18)[0m
Epoch: 19 | cost time: 385.9198818206787 | valid_loss: 0.01831052452325821 | valid_loss_true: 0.9690722601859381
Pretest loss in this epoch: 53.8695041890724
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.0029
	speed: 0.728378s/iter; left time: 42872.306748s
	iters: 764, epoch: 20 | train_loss : 0.0090
	speed: 0.065491s/iter; left time: 3829.759727s
	iters: 1146, epoch: 20 | train_loss : 0.0013
	speed: 0.068006s/iter; left time: 3950.903841s
	iters: 1528, epoch: 20 | train_loss : 0.0020
	speed: 0.066567s/iter; left time: 3841.836472s
	iters: 1910, epoch: 20 | train_loss : 0.0015
	speed: 0.066397s/iter; left time: 3806.679480s
data: {'predict': array([137.1677423 , 137.26483031, 137.30067014, ..., 138.35491494,
       138.26460375, 138.27402673]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-12 03:18:50] [32mIntermediate result: 0.019096896052360535  (Index 19)[0m
Epoch: 20 | cost time: 367.1321747303009 | valid_loss: 0.019096896052360535 | valid_loss_true: 0.9948223397613347
Pretest loss in this epoch: 54.103558222718426
Early stop with best valid_loss: 0.019096896052360535
[2024-03-12 03:18:50] [32mFinal result: 0.017705272883176804[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_transformer --model_name alumina_transformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦ --target_cols 1æ•ˆå‡ºæ–™æ¸©åº¦ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/transformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_transformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_transformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/transformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦', target_cols='1æ•ˆå‡ºæ–™æ¸©åº¦', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_transformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-12 03:18:57.407785: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-12 03:18:57.407850: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-12 03:18:57.409726: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-12 03:18:57.419504: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-12 03:18:58.648060: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1æ•ˆè’¸å‘å™¨æ±½æ¸©,1æ•ˆè’¸å‘å™¨æ±½å®¤å‹åŠ›,1æ•ˆåŸæ¶²æ¢çƒ­å‰æ¸©åº¦,1æ•ˆå‡ºæ–™æ¸©åº¦
	iters: 382, epoch: 1 | train_loss : 0.0011
	speed: 0.073973s/iter; left time: 7039.895368s
	iters: 764, epoch: 1 | train_loss : 0.0005
	speed: 0.064070s/iter; left time: 6072.978309s
	iters: 1146, epoch: 1 | train_loss : 0.0002
	speed: 0.062953s/iter; left time: 5943.108219s
	iters: 1528, epoch: 1 | train_loss : 0.0001
	speed: 0.061914s/iter; left time: 5821.295912s
	iters: 1910, epoch: 1 | train_loss : 0.0001
	speed: 0.059734s/iter; left time: 5593.554179s
data: {'predict': array([148.74911758, 148.74911741, 148.74914152, ..., 148.60522208,
       148.60644422, 148.60467745]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:24:40] [32mIntermediate result: 0.001407515606842935  (Index 0)[0m
Epoch: 1 | cost time: 336.1126732826233 | valid_loss: 0.001407515606842935 | valid_loss_true: 0.0013118854405458774
Pretest loss in this epoch: 14.377993440213285
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.0001
	speed: 0.627483s/iter; left time: 58517.834147s
	iters: 764, epoch: 2 | train_loss : 0.0000
	speed: 0.062957s/iter; left time: 5847.219987s
	iters: 1146, epoch: 2 | train_loss : 0.0000
	speed: 0.065505s/iter; left time: 6058.785092s
	iters: 1528, epoch: 2 | train_loss : 0.0000
	speed: 0.063881s/iter; left time: 5884.232398s
	iters: 1910, epoch: 2 | train_loss : 0.0000
	speed: 0.059359s/iter; left time: 5445.029466s
data: {'predict': array([148.74814762, 148.74815244, 148.7481626 , ..., 148.67807439,
       148.67884614, 148.67785638]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:30:58] [32mIntermediate result: 0.0002090258349198848  (Index 1)[0m
Epoch: 2 | cost time: 378.06016302108765 | valid_loss: 0.0002090258349198848 | valid_loss_true: 0.00010167142058353844
Pretest loss in this epoch: 14.42392736317947
Chepoint Saved at:  ./checkpoints/halfreg/transformer/alumina_transformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0000
	speed: 0.754210s/iter; left time: 68894.805843s
	iters: 764, epoch: 3 | train_loss : 0.0000
	speed: 0.070489s/iter; left time: 6411.990011s
	iters: 1146, epoch: 3 | train_loss : 0.0000
	speed: 0.080803s/iter; left time: 7319.361968s
	iters: 1528, epoch: 3 | train_loss : 0.0000
	speed: 0.087926s/iter; left time: 7931.009879s
	iters: 1910, epoch: 3 | train_loss : 0.0000
	speed: 0.085997s/iter; left time: 7724.193338s
data: {'predict': array([148.74895318, 148.74895582, 148.74896115, ..., 148.71021265,
       148.7106842 , 148.71010641]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:38:32] [32mIntermediate result: 0.0008800707873888314  (Index 2)[0m
Epoch: 3 | cost time: 454.38036274909973 | valid_loss: 0.0008800707873888314 | valid_loss_true: 0.0007523282355325714
Pretest loss in this epoch: 14.444688973259618
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.0000
	speed: 0.886154s/iter; left time: 79254.058263s
	iters: 764, epoch: 4 | train_loss : 0.0000
	speed: 0.104837s/iter; left time: 9336.124411s
	iters: 1146, epoch: 4 | train_loss : 0.0000
	speed: 0.109424s/iter; left time: 9702.838897s
	iters: 1528, epoch: 4 | train_loss : 0.0000
	speed: 0.101341s/iter; left time: 8947.358793s
	iters: 1910, epoch: 4 | train_loss : 0.0000
	speed: 0.104722s/iter; left time: 9205.905684s
data: {'predict': array([148.74933126, 148.74933341, 148.74933618, ..., 148.72639497,
       148.72669539, 148.7263369 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:46:55] [32mIntermediate result: 0.00118753663264215  (Index 3)[0m
Epoch: 4 | cost time: 502.19153809547424 | valid_loss: 0.00118753663264215 | valid_loss_true: 0.0010987165347380928
Pretest loss in this epoch: 14.455583633556966
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.0000
	speed: 0.894030s/iter; left time: 78249.979292s
	iters: 764, epoch: 5 | train_loss : 0.0000
	speed: 0.105574s/iter; left time: 9200.023220s
	iters: 1146, epoch: 5 | train_loss : 0.0000
	speed: 0.104723s/iter; left time: 9085.855830s
	iters: 1528, epoch: 5 | train_loss : 0.0000
	speed: 0.106587s/iter; left time: 9206.859812s
	iters: 1910, epoch: 5 | train_loss : 0.0000
	speed: 0.109066s/iter; left time: 9379.388910s
data: {'predict': array([148.74888672, 148.74888875, 148.74889059, ..., 148.73462663,
       148.7348278 , 148.7345896 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:54:50] [32mIntermediate result: 0.0006515150307677686  (Index 4)[0m
Epoch: 5 | cost time: 475.1283047199249 | valid_loss: 0.0006515150307677686 | valid_loss_true: 0.0006323012085429518
Pretest loss in this epoch: 14.461176299370338
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.0000
	speed: 0.776605s/iter; left time: 66488.284039s
	iters: 764, epoch: 6 | train_loss : 0.0000
	speed: 0.056715s/iter; left time: 4833.955413s
	iters: 1146, epoch: 6 | train_loss : 0.0000
	speed: 0.056128s/iter; left time: 4762.435441s
	iters: 1528, epoch: 6 | train_loss : 0.0000
	speed: 0.054099s/iter; left time: 4569.660844s
	iters: 1910, epoch: 6 | train_loss : 0.0000
	speed: 0.056644s/iter; left time: 4762.985778s
data: {'predict': array([148.74895004, 148.74895113, 148.74895218, ..., 148.73957206,
       148.73971284, 148.73954683]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 03:59:41] [32mIntermediate result: 0.0006871457444503903  (Index 5)[0m
Epoch: 6 | cost time: 291.10140204429626 | valid_loss: 0.0006871457444503903 | valid_loss_true: 0.0006934728240221421
Pretest loss in this epoch: 14.464566595324301
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.0000
	speed: 0.539054s/iter; left time: 45120.446674s
	iters: 764, epoch: 7 | train_loss : 0.0000
	speed: 0.055144s/iter; left time: 4594.670941s
	iters: 1146, epoch: 7 | train_loss : 0.0000
	speed: 0.054852s/iter; left time: 4549.356886s
	iters: 1528, epoch: 7 | train_loss : 0.0000
	speed: 0.057018s/iter; left time: 4707.250261s
	iters: 1910, epoch: 7 | train_loss : 0.0000
	speed: 0.056684s/iter; left time: 4658.029371s
data: {'predict': array([148.74916671, 148.74916688, 148.74916732, ..., 148.74278227,
       148.74288751, 148.7427626 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 04:04:33] [32mIntermediate result: 0.0009223127854056656  (Index 6)[0m
Epoch: 7 | cost time: 292.19387435913086 | valid_loss: 0.0009223127854056656 | valid_loss_true: 0.0009186841533569923
Pretest loss in this epoch: 14.46679064281525
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.0000
	speed: 0.545365s/iter; left time: 44606.486955s
	iters: 764, epoch: 8 | train_loss : 0.0000
	speed: 0.065699s/iter; left time: 5348.588618s
	iters: 1146, epoch: 8 | train_loss : 0.0000
	speed: 0.066716s/iter; left time: 5405.877049s
	iters: 1528, epoch: 8 | train_loss : 0.0000
	speed: 0.065577s/iter; left time: 5288.501368s
	iters: 1910, epoch: 8 | train_loss : 0.0000
	speed: 0.064248s/iter; left time: 5156.774031s
data: {'predict': array([148.74894649, 148.74894661, 148.74894686, ..., 148.74418621,
       148.74427086, 148.74416949]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 04:09:36] [32mIntermediate result: 0.0006919148727320135  (Index 7)[0m
Epoch: 8 | cost time: 302.66611981391907 | valid_loss: 0.0006919148727320135 | valid_loss_true: 0.0006968113093652695
Pretest loss in this epoch: 14.4677989899062
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.0000
	speed: 0.528726s/iter; left time: 42235.170017s
	iters: 764, epoch: 9 | train_loss : 0.0000
	speed: 0.069275s/iter; left time: 5507.264622s
	iters: 1146, epoch: 9 | train_loss : 0.0000
	speed: 0.067244s/iter; left time: 5320.118796s
	iters: 1528, epoch: 9 | train_loss : 0.0000
	speed: 0.060704s/iter; left time: 4779.498311s
	iters: 1910, epoch: 9 | train_loss : 0.0000
	speed: 0.061830s/iter; left time: 4844.533722s
data: {'predict': array([148.74904083, 148.74904096, 148.74904115, ..., 148.74543193,
       148.74549987, 148.7454174 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 04:14:41] [32mIntermediate result: 0.0007876195595599711  (Index 8)[0m
Epoch: 9 | cost time: 305.71876215934753 | valid_loss: 0.0007876195595599711 | valid_loss_true: 0.0007892573936932729
Pretest loss in this epoch: 14.46863857913003
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.0000
	speed: 0.544309s/iter; left time: 42439.776337s
	iters: 764, epoch: 10 | train_loss : 0.0000
	speed: 0.061731s/iter; left time: 4789.548236s
	iters: 1146, epoch: 10 | train_loss : 0.0000
	speed: 0.058205s/iter; left time: 4493.808316s
	iters: 1528, epoch: 10 | train_loss : 0.0000
	speed: 0.064726s/iter; left time: 4972.526818s
	iters: 1910, epoch: 10 | train_loss : 0.0000
	speed: 0.066839s/iter; left time: 5109.313542s
data: {'predict': array([148.74904397, 148.74904423, 148.74904446, ..., 148.74605771,
       148.74611832, 148.74604474]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 04:19:46] [32mIntermediate result: 0.0007828950765542686  (Index 9)[0m
Epoch: 10 | cost time: 304.57515835762024 | valid_loss: 0.0007828950765542686 | valid_loss_true: 0.000788204314955937
Pretest loss in this epoch: 14.469071013973817
Early stop with best valid_loss: 0.0007828950765542686
[2024-03-12 04:19:46] [32mFinal result: 0.0002090258349198848[0m
>>>>>>>end of training : alumina_transformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
