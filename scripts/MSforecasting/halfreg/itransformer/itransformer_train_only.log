python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏© --target_cols 1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏© --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©', target_cols='1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 19:05:53.823429: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 19:05:53.823493: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 19:05:53.825234: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 19:05:53.833569: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 19:05:54.969136: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©
	iters: 382, epoch: 1 | train_loss : 0.1793
	speed: 0.044696s/iter; left time: 4253.693129s
	iters: 764, epoch: 1 | train_loss : 0.1210
	speed: 0.034875s/iter; left time: 3305.716889s
	iters: 1146, epoch: 1 | train_loss : 0.1408
	speed: 0.032156s/iter; left time: 3035.659483s
	iters: 1528, epoch: 1 | train_loss : 0.1299
	speed: 0.033444s/iter; left time: 3144.537386s
	iters: 1910, epoch: 1 | train_loss : 0.1388
	speed: 0.034028s/iter; left time: 3186.425379s
data: {'predict': array([172.82418567, 180.99333312, 182.56145164, ..., 128.12005514,
       128.11627412, 128.21172818]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:09:54] [32mIntermediate result: 0.23884433507919312  (Index 0)[0m
Epoch: 1 | cost time: 230.19117331504822 | valid_loss: 0.23884433507919312 | valid_loss_true: 11.420541400033983
Pretest loss in this epoch: 22.04693388767694
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.1687
	speed: 0.474926s/iter; left time: 44290.624915s
	iters: 764, epoch: 2 | train_loss : 0.1157
	speed: 0.042367s/iter; left time: 3934.907830s
	iters: 1146, epoch: 2 | train_loss : 0.1202
	speed: 0.054563s/iter; left time: 5046.775344s
	iters: 1528, epoch: 2 | train_loss : 0.1455
	speed: 0.065177s/iter; left time: 6003.601876s
	iters: 1910, epoch: 2 | train_loss : 0.1070
	speed: 0.062154s/iter; left time: 5701.352100s
data: {'predict': array([184.57309832, 187.83778552, 185.45533141, ..., 128.4474426 ,
       128.44557042, 128.58782882]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:14:49] [32mIntermediate result: 0.24902473390102386  (Index 1)[0m
Epoch: 2 | cost time: 295.3531458377838 | valid_loss: 0.24902473390102386 | valid_loss_true: 11.907652547533495
Pretest loss in this epoch: 21.987792414516704
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.0957
	speed: 0.561714s/iter; left time: 51310.867274s
	iters: 764, epoch: 3 | train_loss : 0.1517
	speed: 0.055898s/iter; left time: 5084.798058s
	iters: 1146, epoch: 3 | train_loss : 0.1338
	speed: 0.054394s/iter; left time: 4927.194417s
	iters: 1528, epoch: 3 | train_loss : 0.1413
	speed: 0.055085s/iter; left time: 4968.739025s
	iters: 1910, epoch: 3 | train_loss : 0.1394
	speed: 0.055930s/iter; left time: 5023.616389s
data: {'predict': array([188.79260394, 191.8851386 , 187.70168026, ..., 128.84100381,
       128.82765321, 128.90492074]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:19:58] [32mIntermediate result: 0.25611960887908936  (Index 2)[0m
Epoch: 3 | cost time: 309.09801387786865 | valid_loss: 0.25611960887908936 | valid_loss_true: 12.228028845916045
Pretest loss in this epoch: 22.08327375824155
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.1061
	speed: 0.594748s/iter; left time: 53191.895375s
	iters: 764, epoch: 4 | train_loss : 0.1451
	speed: 0.060582s/iter; left time: 5395.102826s
	iters: 1146, epoch: 4 | train_loss : 0.1067
	speed: 0.061538s/iter; left time: 5456.695577s
	iters: 1528, epoch: 4 | train_loss : 0.0892
	speed: 0.062823s/iter; left time: 5546.634217s
	iters: 1910, epoch: 4 | train_loss : 0.1317
	speed: 0.064946s/iter; left time: 5709.242176s
data: {'predict': array([187.68181759, 191.39483924, 187.54440357, ..., 128.65095492,
       128.84321763, 129.05576787]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:25:21] [32mIntermediate result: 0.2634560167789459  (Index 3)[0m
Epoch: 4 | cost time: 322.8651497364044 | valid_loss: 0.2634560167789459 | valid_loss_true: 12.585762783973852
Pretest loss in this epoch: 22.750592541330604
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.1218
	speed: 0.591414s/iter; left time: 51763.511910s
	iters: 764, epoch: 5 | train_loss : 0.1144
	speed: 0.055623s/iter; left time: 4847.142271s
	iters: 1146, epoch: 5 | train_loss : 0.1306
	speed: 0.055787s/iter; left time: 4840.100469s
	iters: 1528, epoch: 5 | train_loss : 0.1052
	speed: 0.056264s/iter; left time: 4860.017579s
	iters: 1910, epoch: 5 | train_loss : 0.1251
	speed: 0.056531s/iter; left time: 4861.528118s
data: {'predict': array([182.04779772, 190.15141697, 188.57651209, ..., 129.11915558,
       129.27053862, 129.50664827]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:30:28] [32mIntermediate result: 0.2717081308364868  (Index 4)[0m
Epoch: 5 | cost time: 307.3040716648102 | valid_loss: 0.2717081308364868 | valid_loss_true: 12.979469975179404
Pretest loss in this epoch: 22.906553795259864
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.1079
	speed: 0.581399s/iter; left time: 49775.918096s
	iters: 764, epoch: 6 | train_loss : 0.1106
	speed: 0.062258s/iter; left time: 5306.344611s
	iters: 1146, epoch: 6 | train_loss : 0.0996
	speed: 0.060455s/iter; left time: 5129.611005s
	iters: 1528, epoch: 6 | train_loss : 0.0864
	speed: 0.055692s/iter; left time: 4704.168072s
	iters: 1910, epoch: 6 | train_loss : 0.1088
	speed: 0.052277s/iter; left time: 4395.734394s
data: {'predict': array([177.0042875 , 186.9364062 , 187.17249046, ..., 128.56798978,
       128.7315906 , 128.92796434]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:35:40] [32mIntermediate result: 0.2579789459705353  (Index 5)[0m
Epoch: 6 | cost time: 312.1180965900421 | valid_loss: 0.2579789459705353 | valid_loss_true: 12.326129466021824
Pretest loss in this epoch: 22.101784230144784
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.1323
	speed: 0.577913s/iter; left time: 48373.072083s
	iters: 764, epoch: 7 | train_loss : 0.1005
	speed: 0.066690s/iter; left time: 5556.709623s
	iters: 1146, epoch: 7 | train_loss : 0.1325
	speed: 0.063095s/iter; left time: 5233.007095s
	iters: 1528, epoch: 7 | train_loss : 0.1346
	speed: 0.061884s/iter; left time: 5108.917870s
	iters: 1910, epoch: 7 | train_loss : 0.1975
	speed: 0.060162s/iter; left time: 4943.809889s
data: {'predict': array([178.84209492, 188.43535231, 187.94798638, ..., 128.9939745 ,
       129.12498364, 129.34635742]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:41:01] [32mIntermediate result: 0.2690283954143524  (Index 6)[0m
Epoch: 7 | cost time: 320.78576016426086 | valid_loss: 0.2690283954143524 | valid_loss_true: 12.851618221230238
Pretest loss in this epoch: 22.65469322121377
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.1230
	speed: 0.591238s/iter; left time: 48358.519761s
	iters: 764, epoch: 8 | train_loss : 0.1111
	speed: 0.054401s/iter; left time: 4428.813773s
	iters: 1146, epoch: 8 | train_loss : 0.1228
	speed: 0.056988s/iter; left time: 4617.625707s
	iters: 1528, epoch: 8 | train_loss : 0.1781
	speed: 0.055187s/iter; left time: 4450.581158s
	iters: 1910, epoch: 8 | train_loss : 0.1115
	speed: 0.056352s/iter; left time: 4523.021245s
data: {'predict': array([178.25891601, 187.96059447, 187.74409645, ..., 128.94623901,
       129.04897868, 129.26157122]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:46:12] [32mIntermediate result: 0.2688862085342407  (Index 7)[0m
Epoch: 8 | cost time: 310.5314977169037 | valid_loss: 0.2688862085342407 | valid_loss_true: 12.854247705335226
Pretest loss in this epoch: 22.795098271612424
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.1038
	speed: 0.596206s/iter; left time: 47625.526777s
	iters: 764, epoch: 9 | train_loss : 0.0777
	speed: 0.062105s/iter; left time: 4937.311669s
	iters: 1146, epoch: 9 | train_loss : 0.0857
	speed: 0.062671s/iter; left time: 4958.303567s
	iters: 1528, epoch: 9 | train_loss : 0.1326
	speed: 0.064755s/iter; left time: 5098.501908s
	iters: 1910, epoch: 9 | train_loss : 0.0890
	speed: 0.061595s/iter; left time: 4826.115274s
data: {'predict': array([177.53251547, 187.88122841, 187.74886326, ..., 128.9450258 ,
       129.02977638, 129.19188547]), 'groundthuth': array([162.21235865, 162.18561936, 162.1722892 , ..., 147.54611012,
       147.65295024, 147.77320937])}
[2024-03-11 19:51:36] [32mIntermediate result: 0.26766976714134216  (Index 8)[0m
Epoch: 9 | cost time: 324.70850563049316 | valid_loss: 0.26766976714134216 | valid_loss_true: 12.791907296267109
Pretest loss in this epoch: 22.779657025915473
Early stop with best valid_loss: 0.26766976714134216
[2024-03-11 19:51:36] [32mFinal result: 0.23884433507919312[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ --target_cols 1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ', target_cols='1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 19:51:43.309617: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 19:51:43.309676: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 19:51:43.311397: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 19:51:43.323440: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 19:51:44.976753: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ
	iters: 382, epoch: 1 | train_loss : 0.2697
	speed: 0.064708s/iter; left time: 6158.180157s
	iters: 764, epoch: 1 | train_loss : 0.1823
	speed: 0.054884s/iter; left time: 5202.307986s
	iters: 1146, epoch: 1 | train_loss : 0.3039
	speed: 0.051698s/iter; left time: 4880.556586s
	iters: 1528, epoch: 1 | train_loss : 0.2829
	speed: 0.060168s/iter; left time: 5657.129778s
	iters: 1910, epoch: 1 | train_loss : 0.2516
	speed: 0.061096s/iter; left time: 5721.097297s
data: {'predict': array([0.46540721, 0.46598697, 0.46765061, ..., 0.44115825, 0.44048184,
       0.44018764]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 19:56:59] [32mIntermediate result: 0.2732711434364319  (Index 0)[0m
Epoch: 1 | cost time: 306.7881739139557 | valid_loss: 0.2732711434364319 | valid_loss_true: 0.054318338187510105
Pretest loss in this epoch: 0.11607224655486455
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.2935
	speed: 0.574832s/iter; left time: 53607.718630s
	iters: 764, epoch: 2 | train_loss : 0.1962
	speed: 0.056959s/iter; left time: 5290.092196s
	iters: 1146, epoch: 2 | train_loss : 0.2596
	speed: 0.055036s/iter; left time: 5090.496718s
	iters: 1528, epoch: 2 | train_loss : 0.2656
	speed: 0.054617s/iter; left time: 5030.847403s
	iters: 1910, epoch: 2 | train_loss : 0.2277
	speed: 0.063797s/iter; left time: 5852.101118s
data: {'predict': array([0.46601032, 0.46640353, 0.46811729, ..., 0.44166241, 0.440497  ,
       0.4402698 ]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:02:05] [32mIntermediate result: 0.2720435559749603  (Index 1)[0m
Epoch: 2 | cost time: 305.274888753891 | valid_loss: 0.2720435559749603 | valid_loss_true: 0.05411620646083057
Pretest loss in this epoch: 0.11556154548706363
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.2395
	speed: 0.580244s/iter; left time: 53003.584932s
	iters: 764, epoch: 3 | train_loss : 0.2622
	speed: 0.061753s/iter; left time: 5617.335950s
	iters: 1146, epoch: 3 | train_loss : 0.1916
	speed: 0.061989s/iter; left time: 5615.153970s
	iters: 1528, epoch: 3 | train_loss : 0.1886
	speed: 0.061509s/iter; left time: 5548.151303s
	iters: 1910, epoch: 3 | train_loss : 0.2419
	speed: 0.059676s/iter; left time: 5360.074070s
data: {'predict': array([0.46366866, 0.4634042 , 0.46565956, ..., 0.44215197, 0.44076744,
       0.44044728]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:07:28] [32mIntermediate result: 0.27161771059036255  (Index 2)[0m
Epoch: 3 | cost time: 323.7718551158905 | valid_loss: 0.27161771059036255 | valid_loss_true: 0.05406741651468529
Pretest loss in this epoch: 0.11543178995164506
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.1920
	speed: 0.590895s/iter; left time: 52847.247535s
	iters: 764, epoch: 4 | train_loss : 0.3031
	speed: 0.056738s/iter; left time: 5052.758882s
	iters: 1146, epoch: 4 | train_loss : 0.1775
	speed: 0.056552s/iter; left time: 5014.543199s
	iters: 1528, epoch: 4 | train_loss : 0.2119
	speed: 0.057466s/iter; left time: 5073.670068s
	iters: 1910, epoch: 4 | train_loss : 0.2407
	speed: 0.055516s/iter; left time: 4880.336976s
data: {'predict': array([0.46405873, 0.46331545, 0.46506169, ..., 0.44194127, 0.44040391,
       0.44042737]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:12:33] [32mIntermediate result: 0.271484911441803  (Index 3)[0m
Epoch: 4 | cost time: 304.16821002960205 | valid_loss: 0.271484911441803 | valid_loss_true: 0.054036557429469466
Pretest loss in this epoch: 0.11539749653063958
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.2761
	speed: 0.574992s/iter; left time: 50326.155691s
	iters: 764, epoch: 5 | train_loss : 0.2198
	speed: 0.063817s/iter; left time: 5561.164302s
	iters: 1146, epoch: 5 | train_loss : 0.2103
	speed: 0.062830s/iter; left time: 5451.163037s
	iters: 1528, epoch: 5 | train_loss : 0.2566
	speed: 0.056126s/iter; left time: 4848.074307s
	iters: 1910, epoch: 5 | train_loss : 0.2605
	speed: 0.055618s/iter; left time: 4783.006987s
data: {'predict': array([0.46595177, 0.46490832, 0.46579112, ..., 0.44188006, 0.44032997,
       0.44107853]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:17:51] [32mIntermediate result: 0.26978620886802673  (Index 4)[0m
Epoch: 5 | cost time: 318.20588207244873 | valid_loss: 0.26978620886802673 | valid_loss_true: 0.05382525757401841
Pretest loss in this epoch: 0.11471442150425051
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.1525
	speed: 0.591177s/iter; left time: 50613.061004s
	iters: 764, epoch: 6 | train_loss : 0.2669
	speed: 0.062032s/iter; left time: 5287.084288s
	iters: 1146, epoch: 6 | train_loss : 0.2161
	speed: 0.062355s/iter; left time: 5290.806525s
	iters: 1528, epoch: 6 | train_loss : 0.2572
	speed: 0.061050s/iter; left time: 5156.784526s
	iters: 1910, epoch: 6 | train_loss : 0.1829
	speed: 0.061897s/iter; left time: 5204.681489s
data: {'predict': array([0.46768365, 0.46725585, 0.46781316, ..., 0.4418516 , 0.44055552,
       0.44170589]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:23:09] [32mIntermediate result: 0.27027490735054016  (Index 5)[0m
Epoch: 6 | cost time: 317.89130663871765 | valid_loss: 0.27027490735054016 | valid_loss_true: 0.05394558832258214
Pretest loss in this epoch: 0.11463095054879296
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.2365
	speed: 0.583761s/iter; left time: 48862.568810s
	iters: 764, epoch: 7 | train_loss : 0.2304
	speed: 0.054475s/iter; left time: 4538.878642s
	iters: 1146, epoch: 7 | train_loss : 0.2312
	speed: 0.051740s/iter; left time: 4291.272123s
	iters: 1528, epoch: 7 | train_loss : 0.3237
	speed: 0.063746s/iter; left time: 5262.679075s
	iters: 1910, epoch: 7 | train_loss : 0.2425
	speed: 0.059722s/iter; left time: 4907.639278s
data: {'predict': array([0.46934811, 0.46866912, 0.46900822, ..., 0.4411792 , 0.4397004 ,
       0.44093747]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:28:20] [32mIntermediate result: 0.27177557349205017  (Index 6)[0m
Epoch: 7 | cost time: 311.08831453323364 | valid_loss: 0.27177557349205017 | valid_loss_true: 0.05425822898495833
Pretest loss in this epoch: 0.11491286475198446
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.2646
	speed: 0.593180s/iter; left time: 48517.357260s
	iters: 764, epoch: 8 | train_loss : 0.2277
	speed: 0.062652s/iter; left time: 5100.525230s
	iters: 1146, epoch: 8 | train_loss : 0.1955
	speed: 0.062609s/iter; left time: 5073.055581s
	iters: 1528, epoch: 8 | train_loss : 0.3344
	speed: 0.062499s/iter; left time: 5040.308761s
	iters: 1910, epoch: 8 | train_loss : 0.2307
	speed: 0.062092s/iter; left time: 4983.777007s
data: {'predict': array([0.47013927, 0.46896484, 0.46786496, ..., 0.44023724, 0.43882989,
       0.44056955]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:33:40] [32mIntermediate result: 0.27195435762405396  (Index 7)[0m
Epoch: 8 | cost time: 320.5793356895447 | valid_loss: 0.27195435762405396 | valid_loss_true: 0.05425993643846071
Pretest loss in this epoch: 0.114908621506789
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.2320
	speed: 0.581575s/iter; left time: 46456.762450s
	iters: 764, epoch: 9 | train_loss : 0.1694
	speed: 0.056088s/iter; left time: 4458.963188s
	iters: 1146, epoch: 9 | train_loss : 0.2745
	speed: 0.055798s/iter; left time: 4414.573927s
	iters: 1528, epoch: 9 | train_loss : 0.1841
	speed: 0.056153s/iter; left time: 4421.203484s
	iters: 1910, epoch: 9 | train_loss : 0.2265
	speed: 0.061029s/iter; left time: 4781.815932s
data: {'predict': array([0.47297649, 0.47243343, 0.4719584 , ..., 0.43992607, 0.43841157,
       0.44034983]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:38:47] [32mIntermediate result: 0.2717895805835724  (Index 8)[0m
Epoch: 9 | cost time: 306.9350063800812 | valid_loss: 0.2717895805835724 | valid_loss_true: 0.0542922107282642
Pretest loss in this epoch: 0.11475687022916205
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.1704
	speed: 0.572681s/iter; left time: 44651.941957s
	iters: 764, epoch: 10 | train_loss : 0.3077
	speed: 0.063644s/iter; left time: 4937.973123s
	iters: 1146, epoch: 10 | train_loss : 0.2373
	speed: 0.054494s/iter; left time: 4207.234195s
	iters: 1528, epoch: 10 | train_loss : 0.2652
	speed: 0.056458s/iter; left time: 4337.332949s
	iters: 1910, epoch: 10 | train_loss : 0.2123
	speed: 0.054202s/iter; left time: 4143.271918s
data: {'predict': array([0.47153551, 0.47081658, 0.46954158, ..., 0.43928723, 0.43806971,
       0.44029409]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:43:56] [32mIntermediate result: 0.2727848291397095  (Index 9)[0m
Epoch: 10 | cost time: 309.2004382610321 | valid_loss: 0.2727848291397095 | valid_loss_true: 0.05449131485179174
Pretest loss in this epoch: 0.11491460375068625
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.1872
	speed: 0.588154s/iter; left time: 44734.434149s
	iters: 764, epoch: 11 | train_loss : 0.1955
	speed: 0.061688s/iter; left time: 4668.373781s
	iters: 1146, epoch: 11 | train_loss : 0.2176
	speed: 0.063136s/iter; left time: 4753.853197s
	iters: 1528, epoch: 11 | train_loss : 0.2400
	speed: 0.064097s/iter; left time: 4801.673830s
	iters: 1910, epoch: 11 | train_loss : 0.1782
	speed: 0.063340s/iter; left time: 4720.815437s
data: {'predict': array([0.47267642, 0.47245627, 0.47212108, ..., 0.43939678, 0.43814654,
       0.44036603]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:49:18] [32mIntermediate result: 0.2729162871837616  (Index 10)[0m
Epoch: 11 | cost time: 321.18211674690247 | valid_loss: 0.2729162871837616 | valid_loss_true: 0.05449211676637022
Pretest loss in this epoch: 0.11485182250204526
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.1978
	speed: 0.582583s/iter; left time: 43197.385564s
	iters: 764, epoch: 12 | train_loss : 0.2815
	speed: 0.053217s/iter; left time: 3925.623158s
	iters: 1146, epoch: 12 | train_loss : 0.2632
	speed: 0.064625s/iter; left time: 4742.432927s
	iters: 1528, epoch: 12 | train_loss : 0.2724
	speed: 0.057917s/iter; left time: 4228.039938s
	iters: 1910, epoch: 12 | train_loss : 0.2974
	speed: 0.054998s/iter; left time: 3993.944580s
data: {'predict': array([0.47580912, 0.47510561, 0.47413822, ..., 0.43928658, 0.43800754,
       0.44036621]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:54:22] [32mIntermediate result: 0.27259284257888794  (Index 11)[0m
Epoch: 12 | cost time: 304.1379494667053 | valid_loss: 0.27259284257888794 | valid_loss_true: 0.05446666310729543
Pretest loss in this epoch: 0.11471463330159344
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.2241
	speed: 0.571440s/iter; left time: 41279.116929s
	iters: 764, epoch: 13 | train_loss : 0.2352
	speed: 0.060941s/iter; left time: 4378.936741s
	iters: 1146, epoch: 13 | train_loss : 0.2442
	speed: 0.060126s/iter; left time: 4297.400010s
	iters: 1528, epoch: 13 | train_loss : 0.1603
	speed: 0.059291s/iter; left time: 4215.032531s
	iters: 1910, epoch: 13 | train_loss : 0.1477
	speed: 0.053939s/iter; left time: 3814.006634s
data: {'predict': array([0.47287873, 0.47117596, 0.46931709, ..., 0.43871366, 0.43772181,
       0.44026399]), 'groundthuth': array([0.53966796, 0.53966796, 0.54068356, ..., 0.33414063, 0.33414063,
       0.33414063])}
[2024-03-11 20:59:35] [32mIntermediate result: 0.2738916575908661  (Index 12)[0m
Epoch: 13 | cost time: 313.1070373058319 | valid_loss: 0.2738916575908661 | valid_loss_true: 0.054687036704555256
Pretest loss in this epoch: 0.11480529712224392
Early stop with best valid_loss: 0.2738916575908661
[2024-03-11 20:59:35] [32mFinal result: 0.26978620886802673[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶ --target_cols 1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶', target_cols='1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 20:59:41.563789: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 20:59:41.563881: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 20:59:41.565841: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 20:59:41.575856: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 20:59:42.845002: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1ÊïàÂá∫ÊñôÊ∏©Â∫¶,1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶
	iters: 382, epoch: 1 | train_loss : 1.2432
	speed: 0.065559s/iter; left time: 6239.216391s
	iters: 764, epoch: 1 | train_loss : 0.6371
	speed: 0.059567s/iter; left time: 5646.169619s
	iters: 1146, epoch: 1 | train_loss : 0.9766
	speed: 0.061616s/iter; left time: 5816.834507s
	iters: 1528, epoch: 1 | train_loss : 1.0645
	speed: 0.065726s/iter; left time: 6179.771599s
	iters: 1910, epoch: 1 | train_loss : 0.9256
	speed: 0.062142s/iter; left time: 5819.074745s
data: {'predict': array([121.70316999, 121.70378146, 121.70434226, ..., 114.64113787,
        72.27697675,  99.27614715]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:05:07] [32mIntermediate result: 0.38193008303642273  (Index 0)[0m
Epoch: 1 | cost time: 316.20054745674133 | valid_loss: 0.38193008303642273 | valid_loss_true: 15.07114056403629
Pretest loss in this epoch: 1414.065872642926
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.7243
	speed: 0.578081s/iter; left time: 53910.701638s
	iters: 764, epoch: 2 | train_loss : 0.9293
	speed: 0.055931s/iter; left time: 5194.657833s
	iters: 1146, epoch: 2 | train_loss : 0.7231
	speed: 0.053771s/iter; left time: 4973.526937s
	iters: 1528, epoch: 2 | train_loss : 1.1230
	speed: 0.055749s/iter; left time: 5135.128897s
	iters: 1910, epoch: 2 | train_loss : 0.9387
	speed: 0.056292s/iter; left time: 5163.656881s
data: {'predict': array([125.24010663, 125.24073989, 125.2374911 , ..., 449.44543368,
       406.41165915, 410.99580221]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:10:07] [32mIntermediate result: 0.2951050102710724  (Index 1)[0m
Epoch: 2 | cost time: 300.14519739151 | valid_loss: 0.2951050102710724 | valid_loss_true: 11.639497755061408
Pretest loss in this epoch: 2887.2066722511113
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 0.7675
	speed: 0.569891s/iter; left time: 52057.812679s
	iters: 764, epoch: 3 | train_loss : 0.7058
	speed: 0.060986s/iter; left time: 5547.559885s
	iters: 1146, epoch: 3 | train_loss : 0.7758
	speed: 0.061374s/iter; left time: 5559.476624s
	iters: 1528, epoch: 3 | train_loss : 0.5601
	speed: 0.059164s/iter; left time: 5336.610343s
	iters: 1910, epoch: 3 | train_loss : 0.5873
	speed: 0.066015s/iter; left time: 5929.390757s
data: {'predict': array([128.08922776, 128.09036116, 128.08796123, ..., 697.68384417,
       517.02322996, 499.32467738]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:15:19] [32mIntermediate result: 0.22611838579177856  (Index 2)[0m
Epoch: 3 | cost time: 312.64887380599976 | valid_loss: 0.22611838579177856 | valid_loss_true: 8.913478096487946
Pretest loss in this epoch: 4281.1839486634835
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.5884
	speed: 0.573156s/iter; left time: 51260.797973s
	iters: 764, epoch: 4 | train_loss : 0.4469
	speed: 0.056625s/iter; left time: 5042.719087s
	iters: 1146, epoch: 4 | train_loss : 0.7135
	speed: 0.056575s/iter; left time: 5016.630850s
	iters: 1528, epoch: 4 | train_loss : 0.2661
	speed: 0.055073s/iter; left time: 4862.369690s
	iters: 1910, epoch: 4 | train_loss : 0.5566
	speed: 0.055126s/iter; left time: 4845.981937s
data: {'predict': array([130.39902835, 130.39898358, 130.39429683, ..., 912.49447876,
       845.51677464, 692.12523468]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:20:25] [32mIntermediate result: 0.16920089721679688  (Index 3)[0m
Epoch: 4 | cost time: 305.2753551006317 | valid_loss: 0.16920089721679688 | valid_loss_true: 6.664442368435592
Pretest loss in this epoch: 5267.828088881082
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.5137
	speed: 0.573295s/iter; left time: 50177.609014s
	iters: 764, epoch: 5 | train_loss : 0.3186
	speed: 0.059509s/iter; left time: 5185.814236s
	iters: 1146, epoch: 5 | train_loss : 0.2644
	speed: 0.056416s/iter; left time: 4894.726261s
	iters: 1528, epoch: 5 | train_loss : 0.5846
	speed: 0.056383s/iter; left time: 4870.275672s
	iters: 1910, epoch: 5 | train_loss : 0.3290
	speed: 0.056214s/iter; left time: 4834.226495s
data: {'predict': array([ 132.26520792,  132.26433726,  132.25530308, ..., 1042.61008139,
        974.51129036,  714.46206944]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:25:37] [32mIntermediate result: 0.12831835448741913  (Index 4)[0m
Epoch: 5 | cost time: 312.0249469280243 | valid_loss: 0.12831835448741913 | valid_loss_true: 5.05201676276365
Pretest loss in this epoch: 6040.852252384656
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.2401
	speed: 0.586593s/iter; left time: 50220.583312s
	iters: 764, epoch: 6 | train_loss : 0.5607
	speed: 0.056940s/iter; left time: 4853.104343s
	iters: 1146, epoch: 6 | train_loss : 0.3049
	speed: 0.065732s/iter; left time: 5577.389042s
	iters: 1528, epoch: 6 | train_loss : 0.3907
	speed: 0.063190s/iter; left time: 5337.494454s
	iters: 1910, epoch: 6 | train_loss : 0.3468
	speed: 0.059770s/iter; left time: 5025.816015s
data: {'predict': array([ 133.78715428,  133.78490752,  133.77222455, ..., 1143.00059398,
        992.46903962,  509.04815338]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:30:58] [32mIntermediate result: 0.09564357250928879  (Index 5)[0m
Epoch: 6 | cost time: 320.95355892181396 | valid_loss: 0.09564357250928879 | valid_loss_true: 3.7647829713430188
Pretest loss in this epoch: 6651.2990743911505
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.6181
	speed: 0.590014s/iter; left time: 49385.941651s
	iters: 764, epoch: 7 | train_loss : 0.4869
	speed: 0.057558s/iter; left time: 4795.794832s
	iters: 1146, epoch: 7 | train_loss : 0.2952
	speed: 0.056436s/iter; left time: 4680.714661s
	iters: 1528, epoch: 7 | train_loss : 0.4250
	speed: 0.057496s/iter; left time: 4746.660355s
	iters: 1910, epoch: 7 | train_loss : 0.2054
	speed: 0.054868s/iter; left time: 4508.750643s
data: {'predict': array([ 135.00225536,  135.01378961,  135.00183711, ..., 1225.06418583,
       1167.73078491,  756.53732523]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:36:01] [32mIntermediate result: 0.07517651468515396  (Index 6)[0m
Epoch: 7 | cost time: 302.74794125556946 | valid_loss: 0.07517651468515396 | valid_loss_true: 2.9663336836318033
Pretest loss in this epoch: 6920.932020460757
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.4874
	speed: 0.572659s/iter; left time: 46838.899969s
	iters: 764, epoch: 8 | train_loss : 0.2898
	speed: 0.063586s/iter; left time: 5176.519167s
	iters: 1146, epoch: 8 | train_loss : 0.4815
	speed: 0.060957s/iter; left time: 4939.183532s
	iters: 1528, epoch: 8 | train_loss : 0.6545
	speed: 0.060364s/iter; left time: 4868.124342s
	iters: 1910, epoch: 8 | train_loss : 0.3269
	speed: 0.064508s/iter; left time: 5177.631937s
data: {'predict': array([ 135.58204063,  135.85514911,  136.00149627, ..., 1303.24800866,
       1276.59067627,  811.84729548]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:41:17] [32mIntermediate result: 0.07406820356845856  (Index 7)[0m
Epoch: 8 | cost time: 316.41884565353394 | valid_loss: 0.07406820356845856 | valid_loss_true: 2.94948437996013
Pretest loss in this epoch: 7231.598380668099
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 0.5318
	speed: 0.577180s/iter; left time: 46105.721603s
	iters: 764, epoch: 9 | train_loss : 0.3594
	speed: 0.054316s/iter; left time: 4318.043235s
	iters: 1146, epoch: 9 | train_loss : 0.5797
	speed: 0.055959s/iter; left time: 4427.346325s
	iters: 1528, epoch: 9 | train_loss : 0.3386
	speed: 0.056830s/iter; left time: 4474.478492s
	iters: 1910, epoch: 9 | train_loss : 0.1209
	speed: 0.061748s/iter; left time: 4838.152074s
data: {'predict': array([ 135.83237279,  136.47598878,  136.77638831, ..., 1280.72311964,
       1176.39636144,  647.99303174]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:46:20] [32mIntermediate result: 0.07401113212108612  (Index 8)[0m
Epoch: 9 | cost time: 303.3950333595276 | valid_loss: 0.07401113212108612 | valid_loss_true: 2.9669226288571946
Pretest loss in this epoch: 8247.201346481928
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 0.2995
	speed: 0.560378s/iter; left time: 43692.665195s
	iters: 764, epoch: 10 | train_loss : 0.2083
	speed: 0.055499s/iter; left time: 4306.065086s
	iters: 1146, epoch: 10 | train_loss : 0.1274
	speed: 0.057481s/iter; left time: 4437.850904s
	iters: 1528, epoch: 10 | train_loss : 0.3789
	speed: 0.054152s/iter; left time: 4160.186195s
	iters: 1910, epoch: 10 | train_loss : 0.1473
	speed: 0.057911s/iter; left time: 4426.867086s
data: {'predict': array([ 136.12297704,  136.93016616,  137.22954304, ..., 1305.83130416,
       1152.12137643,  582.04992767]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:51:32] [32mIntermediate result: 0.07315459102392197  (Index 9)[0m
Epoch: 10 | cost time: 311.79389333724976 | valid_loss: 0.07315459102392197 | valid_loss_true: 2.9349904905227167
Pretest loss in this epoch: 8154.35661266247
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 0.2613
	speed: 0.597207s/iter; left time: 45422.997888s
	iters: 764, epoch: 11 | train_loss : 0.0924
	speed: 0.063306s/iter; left time: 4790.832834s
	iters: 1146, epoch: 11 | train_loss : 0.1706
	speed: 0.064755s/iter; left time: 4875.740535s
	iters: 1528, epoch: 11 | train_loss : 0.4649
	speed: 0.060249s/iter; left time: 4513.468287s
	iters: 1910, epoch: 11 | train_loss : 0.3281
	speed: 0.062094s/iter; left time: 4627.917634s
data: {'predict': array([ 136.15584435,  137.11901333,  137.40240955, ..., 1261.21659953,
       1116.91028967,  483.29919697]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 21:56:56] [32mIntermediate result: 0.0794232040643692  (Index 10)[0m
Epoch: 11 | cost time: 324.1952135562897 | valid_loss: 0.0794232040643692 | valid_loss_true: 3.195903077402729
Pretest loss in this epoch: 8957.798332154045
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.2179
	speed: 0.593402s/iter; left time: 43999.547940s
	iters: 764, epoch: 12 | train_loss : 0.3786
	speed: 0.054248s/iter; left time: 4001.640542s
	iters: 1146, epoch: 12 | train_loss : 0.2049
	speed: 0.055613s/iter; left time: 4081.097136s
	iters: 1528, epoch: 12 | train_loss : 0.2583
	speed: 0.054648s/iter; left time: 3989.404815s
	iters: 1910, epoch: 12 | train_loss : 0.2170
	speed: 0.055261s/iter; left time: 4013.035530s
data: {'predict': array([ 136.20733024,  137.21193416,  137.42848003, ..., 1228.99387142,
       1018.52382927,  327.35851892]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:01:58] [32mIntermediate result: 0.07909468561410904  (Index 11)[0m
Epoch: 12 | cost time: 301.1719789505005 | valid_loss: 0.07909468561410904 | valid_loss_true: 3.1748352341466957
Pretest loss in this epoch: 9233.372443201735
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 0.5552
	speed: 0.575243s/iter; left time: 41553.815468s
	iters: 764, epoch: 13 | train_loss : 0.1103
	speed: 0.062215s/iter; left time: 4470.467654s
	iters: 1146, epoch: 13 | train_loss : 0.1826
	speed: 0.060829s/iter; left time: 4347.646352s
	iters: 1528, epoch: 13 | train_loss : 0.2316
	speed: 0.064098s/iter; left time: 4556.770590s
	iters: 1910, epoch: 13 | train_loss : 0.2640
	speed: 0.056276s/iter; left time: 3979.197617s
data: {'predict': array([ 136.34644346,  137.33359755,  137.44567655, ..., 1219.60744535,
       1024.90289521,  337.71330378]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:07:10] [32mIntermediate result: 0.07409791648387909  (Index 12)[0m
Epoch: 13 | cost time: 312.1066448688507 | valid_loss: 0.07409791648387909 | valid_loss_true: 2.9821499959220756
Pretest loss in this epoch: 9050.680090187
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 0.4919
	speed: 0.566200s/iter; left time: 39818.596155s
	iters: 764, epoch: 14 | train_loss : 0.1928
	speed: 0.062833s/iter; left time: 4394.762862s
	iters: 1146, epoch: 14 | train_loss : 0.2655
	speed: 0.061711s/iter; left time: 4292.728549s
	iters: 1528, epoch: 14 | train_loss : 0.5103
	speed: 0.061928s/iter; left time: 4284.166527s
	iters: 1910, epoch: 14 | train_loss : 0.2998
	speed: 0.062186s/iter; left time: 4278.264200s
data: {'predict': array([ 136.28423979,  137.30485735,  137.39378537, ..., 1179.4641191 ,
        916.95514995,  290.68096332]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:12:17] [32mIntermediate result: 0.07403848320245743  (Index 13)[0m
Epoch: 14 | cost time: 307.3216586112976 | valid_loss: 0.07403848320245743 | valid_loss_true: 2.987344047362222
Pretest loss in this epoch: 9109.982309080864
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.3098
	speed: 0.555538s/iter; left time: 38007.143858s
	iters: 764, epoch: 15 | train_loss : 0.1779
	speed: 0.056486s/iter; left time: 3842.886727s
	iters: 1146, epoch: 15 | train_loss : 0.1760
	speed: 0.053696s/iter; left time: 3632.579450s
	iters: 1528, epoch: 15 | train_loss : 0.1205
	speed: 0.050797s/iter; left time: 3417.070403s
	iters: 1910, epoch: 15 | train_loss : 0.2546
	speed: 0.062754s/iter; left time: 4197.441162s
data: {'predict': array([ 136.28730655,  137.30500109,  137.36474592, ..., 1261.57596866,
       1012.69595685,  278.54742946]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:17:10] [32mIntermediate result: 0.07104887068271637  (Index 14)[0m
Epoch: 15 | cost time: 293.5576801300049 | valid_loss: 0.07104887068271637 | valid_loss_true: 2.868806805473792
Pretest loss in this epoch: 8965.353904785816
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.2787
	speed: 0.555755s/iter; left time: 36959.900043s
	iters: 764, epoch: 16 | train_loss : 0.1121
	speed: 0.060149s/iter; left time: 3977.171762s
	iters: 1146, epoch: 16 | train_loss : 0.1876
	speed: 0.061406s/iter; left time: 4036.815185s
	iters: 1528, epoch: 16 | train_loss : 0.2346
	speed: 0.060841s/iter; left time: 3976.442971s
	iters: 1910, epoch: 16 | train_loss : 0.1865
	speed: 0.061013s/iter; left time: 3964.390919s
data: {'predict': array([ 136.31361737,  137.33970281,  137.40524187, ..., 1225.56244668,
        993.74424959,  195.27136266]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:22:15] [32mIntermediate result: 0.07212960720062256  (Index 15)[0m
Epoch: 16 | cost time: 304.94327664375305 | valid_loss: 0.07212960720062256 | valid_loss_true: 2.9128778048654396
Pretest loss in this epoch: 9262.027728461406
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 0.1539
	speed: 0.543476s/iter; left time: 35104.723571s
	iters: 764, epoch: 17 | train_loss : 0.2429
	speed: 0.051972s/iter; left time: 3337.147867s
	iters: 1146, epoch: 17 | train_loss : 0.1873
	speed: 0.054203s/iter; left time: 3459.750440s
	iters: 1528, epoch: 17 | train_loss : 0.1400
	speed: 0.054801s/iter; left time: 3476.953050s
	iters: 1910, epoch: 17 | train_loss : 0.4220
	speed: 0.059925s/iter; left time: 3779.172138s
data: {'predict': array([ 136.27510428,  137.29672093,  137.35712082, ..., 1224.80284017,
        987.38207384,  154.91653191]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:27:09] [32mIntermediate result: 0.07237658649682999  (Index 16)[0m
Epoch: 17 | cost time: 293.27499175071716 | valid_loss: 0.07237658649682999 | valid_loss_true: 2.921563630443245
Pretest loss in this epoch: 9525.040498609129
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 0.1920
	speed: 0.552951s/iter; left time: 34660.048887s
	iters: 764, epoch: 18 | train_loss : 0.2070
	speed: 0.065869s/iter; left time: 4103.639008s
	iters: 1146, epoch: 18 | train_loss : 0.1842
	speed: 0.053992s/iter; left time: 3343.072941s
	iters: 1528, epoch: 18 | train_loss : 0.1615
	speed: 0.056966s/iter; left time: 3505.483908s
	iters: 1910, epoch: 18 | train_loss : 0.2791
	speed: 0.054581s/iter; left time: 3337.816507s
data: {'predict': array([ 136.25862291,  137.28867641,  137.35758974, ..., 1232.1188597 ,
       1001.79363549,  130.54989495]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:32:00] [32mIntermediate result: 0.07295409590005875  (Index 17)[0m
Epoch: 18 | cost time: 291.72742104530334 | valid_loss: 0.07295409590005875 | valid_loss_true: 2.9494094203883585
Pretest loss in this epoch: 9347.233067990559
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 0.3045
	speed: 0.532335s/iter; left time: 32350.540405s
	iters: 764, epoch: 19 | train_loss : 0.0956
	speed: 0.060417s/iter; left time: 3648.535211s
	iters: 1146, epoch: 19 | train_loss : 0.1432
	speed: 0.061387s/iter; left time: 3683.670362s
	iters: 1528, epoch: 19 | train_loss : 0.3190
	speed: 0.060730s/iter; left time: 3621.002943s
	iters: 1910, epoch: 19 | train_loss : 0.2725
	speed: 0.060784s/iter; left time: 3601.051419s
data: {'predict': array([ 136.30852298,  137.29510448,  137.27778897, ..., 1208.61433918,
        950.98671274,   64.43909534]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:36:58] [32mIntermediate result: 0.07123759388923645  (Index 18)[0m
Epoch: 19 | cost time: 297.493629693985 | valid_loss: 0.07123759388923645 | valid_loss_true: 2.8799896107604877
Pretest loss in this epoch: 9547.287999235985
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 0.1666
	speed: 0.528161s/iter; left time: 31087.572232s
	iters: 764, epoch: 20 | train_loss : 0.1265
	speed: 0.052273s/iter; left time: 3056.828237s
	iters: 1146, epoch: 20 | train_loss : 0.1793
	speed: 0.051226s/iter; left time: 2975.999800s
	iters: 1528, epoch: 20 | train_loss : 0.1927
	speed: 0.057503s/iter; left time: 3318.718127s
	iters: 1910, epoch: 20 | train_loss : 0.3830
	speed: 0.052951s/iter; left time: 3035.792250s
data: {'predict': array([ 136.28975832,  137.26318088,  137.21451552, ..., 1217.65904034,
        983.52748931,   97.9334895 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:41:33] [32mIntermediate result: 0.06858614832162857  (Index 19)[0m
Epoch: 20 | cost time: 274.6786515712738 | valid_loss: 0.06858614832162857 | valid_loss_true: 2.772544456860219
Pretest loss in this epoch: 8882.629144595387
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-19.pth
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.1512
	speed: 0.516250s/iter; left time: 29399.901449s
	iters: 764, epoch: 21 | train_loss : 0.2928
	speed: 0.059636s/iter; left time: 3373.422865s
	iters: 1146, epoch: 21 | train_loss : 0.0904
	speed: 0.063533s/iter; left time: 3569.580757s
	iters: 1528, epoch: 21 | train_loss : 0.1737
	speed: 0.063444s/iter; left time: 3540.363562s
	iters: 1910, epoch: 21 | train_loss : 0.1739
	speed: 0.055440s/iter; left time: 3072.564811s
data: {'predict': array([ 136.32054735,  137.30637718,  137.27946786, ..., 1224.87311546,
        997.67514162,   45.44357913]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:46:36] [32mIntermediate result: 0.07135923206806183  (Index 20)[0m
Epoch: 21 | cost time: 303.3815641403198 | valid_loss: 0.07135923206806183 | valid_loss_true: 2.884373557693063
Pretest loss in this epoch: 9263.366113897971
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.2442
	speed: 0.542082s/iter; left time: 29835.097789s
	iters: 764, epoch: 22 | train_loss : 0.1351
	speed: 0.054979s/iter; left time: 3004.930950s
	iters: 1146, epoch: 22 | train_loss : 0.2482
	speed: 0.063593s/iter; left time: 3451.467620s
	iters: 1528, epoch: 22 | train_loss : 0.3839
	speed: 0.062236s/iter; left time: 3354.018212s
	iters: 1910, epoch: 22 | train_loss : 0.0913
	speed: 0.070034s/iter; left time: 3747.529574s
data: {'predict': array([ 136.31531393,  137.29216614,  137.27990967, ..., 1227.10714579,
       1005.77565053,   41.13895376]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:51:31] [32mIntermediate result: 0.0713576152920723  (Index 21)[0m
Epoch: 22 | cost time: 294.5681324005127 | valid_loss: 0.0713576152920723 | valid_loss_true: 2.882578327239712
Pretest loss in this epoch: 9357.110769584582
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.0626
	speed: 0.527963s/iter; left time: 28049.098846s
	iters: 764, epoch: 23 | train_loss : 0.2210
	speed: 0.054197s/iter; left time: 2858.641437s
	iters: 1146, epoch: 23 | train_loss : 0.2937
	speed: 0.057492s/iter; left time: 3010.474036s
	iters: 1528, epoch: 23 | train_loss : 0.5053
	speed: 0.052912s/iter; left time: 2750.408775s
	iters: 1910, epoch: 23 | train_loss : 0.2164
	speed: 0.055365s/iter; left time: 2856.757224s
data: {'predict': array([ 136.31444327,  137.28051996,  137.25238062, ..., 1221.29209182,
        999.45690673,   39.51636369]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 22:56:18] [32mIntermediate result: 0.07158416509628296  (Index 22)[0m
Epoch: 23 | cost time: 287.0450143814087 | valid_loss: 0.07158416509628296 | valid_loss_true: 2.8931446581725604
Pretest loss in this epoch: 9498.570696061668
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 0.0976
	speed: 0.532542s/iter; left time: 27274.669008s
	iters: 764, epoch: 24 | train_loss : 0.3424
	speed: 0.064213s/iter; left time: 3264.197997s
	iters: 1146, epoch: 24 | train_loss : 0.3252
	speed: 0.064649s/iter; left time: 3261.649947s
	iters: 1528, epoch: 24 | train_loss : 0.1603
	speed: 0.063284s/iter; left time: 3168.624233s
	iters: 1910, epoch: 24 | train_loss : 0.2724
	speed: 0.063648s/iter; left time: 3162.518463s
data: {'predict': array([ 136.32430217,  137.29447299,  137.26654926, ..., 1239.1741368 ,
       1019.12358211,   58.58313543]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 23:01:27] [32mIntermediate result: 0.07008611410856247  (Index 23)[0m
Epoch: 24 | cost time: 309.1887273788452 | valid_loss: 0.07008611410856247 | valid_loss_true: 2.8381605705598596
Pretest loss in this epoch: 9445.300280073128
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 0.1593
	speed: 0.541733s/iter; left time: 26710.143056s
	iters: 764, epoch: 25 | train_loss : 0.2124
	speed: 0.064986s/iter; left time: 3179.302378s
	iters: 1146, epoch: 25 | train_loss : 0.0782
	speed: 0.058091s/iter; left time: 2819.775029s
	iters: 1528, epoch: 25 | train_loss : 0.1450
	speed: 0.060645s/iter; left time: 2920.596326s
	iters: 1910, epoch: 25 | train_loss : 0.1329
	speed: 0.059376s/iter; left time: 2836.800329s
data: {'predict': array([ 136.32338673,  137.29457431,  137.26557845, ..., 1232.17330043,
       1016.69863222,   62.98322057]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 23:06:13] [32mIntermediate result: 0.06970657408237457  (Index 24)[0m
Epoch: 25 | cost time: 286.4190585613251 | valid_loss: 0.06970657408237457 | valid_loss_true: 2.820728609227634
Pretest loss in this epoch: 9205.65270019955
Adjusting learning rate of group 0 to 1.7198e-06.
	iters: 382, epoch: 26 | train_loss : 0.2633
	speed: 0.511515s/iter; left time: 24242.742802s
	iters: 764, epoch: 26 | train_loss : 0.2883
	speed: 0.053700s/iter; left time: 2524.551716s
	iters: 1146, epoch: 26 | train_loss : 0.1640
	speed: 0.052611s/iter; left time: 2453.255394s
	iters: 1528, epoch: 26 | train_loss : 0.1320
	speed: 0.041088s/iter; left time: 1900.237045s
	iters: 1910, epoch: 26 | train_loss : 0.1839
	speed: 0.038204s/iter; left time: 1752.281107s
data: {'predict': array([ 136.3223794 ,  137.30047692,  137.26789826, ..., 1234.71572768,
       1024.69402981,   56.6625917 ]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 23:11:02] [32mIntermediate result: 0.06989142298698425  (Index 25)[0m
Epoch: 26 | cost time: 288.28480291366577 | valid_loss: 0.06989142298698425 | valid_loss_true: 2.829028906582106
Pretest loss in this epoch: 9424.056940672905
Adjusting learning rate of group 0 to 1.4618e-06.
	iters: 382, epoch: 27 | train_loss : 0.1714
	speed: 0.566300s/iter; left time: 25757.034832s
	iters: 764, epoch: 27 | train_loss : 0.2458
	speed: 0.051215s/iter; left time: 2309.849778s
	iters: 1146, epoch: 27 | train_loss : 0.2020
	speed: 0.050518s/iter; left time: 2259.132040s
	iters: 1528, epoch: 27 | train_loss : 0.1007
	speed: 0.045738s/iter; left time: 2027.877400s
	iters: 1910, epoch: 27 | train_loss : 0.2424
	speed: 0.044831s/iter; left time: 1970.544029s
data: {'predict': array([ 136.3200372 ,  137.29237585,  137.25434816, ..., 1227.33742555,
       1012.94373002,   38.19074704]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 23:16:24] [32mIntermediate result: 0.06994526088237762  (Index 26)[0m
Epoch: 27 | cost time: 322.0823097229004 | valid_loss: 0.06994526088237762 | valid_loss_true: 2.831178090310618
Pretest loss in this epoch: 9372.49642090009
Adjusting learning rate of group 0 to 1.2425e-06.
	iters: 382, epoch: 28 | train_loss : 0.1343
	speed: 0.653163s/iter; left time: 28459.615133s
	iters: 764, epoch: 28 | train_loss : 0.1164
	speed: 0.063505s/iter; left time: 2742.777816s
	iters: 1146, epoch: 28 | train_loss : 0.1257
	speed: 0.054871s/iter; left time: 2348.925700s
	iters: 1528, epoch: 28 | train_loss : 0.2747
	speed: 0.055404s/iter; left time: 2350.561959s
	iters: 1910, epoch: 28 | train_loss : 0.2471
	speed: 0.055392s/iter; left time: 2328.884876s
data: {'predict': array([ 136.33576102,  137.29758806,  137.25496081, ..., 1230.77820022,
       1017.77312028,   37.99967667]), 'groundthuth': array([137.04731953, 136.96717945, 136.86033975, ..., 131.46400035,
       131.25029033, 131.30372962])}
[2024-03-11 23:22:13] [32mIntermediate result: 0.0700024664402008  (Index 27)[0m
Epoch: 28 | cost time: 349.1161279678345 | valid_loss: 0.0700024664402008 | valid_loss_true: 2.831318179290963
Pretest loss in this epoch: 9260.059422730992
Early stop with best valid_loss: 0.0700024664402008
[2024-03-11 23:22:13] [32mFinal result: 0.06858614832162857[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
python -u main_nni.py --stage train_only --model_id alumina_itransformer --model_name alumina_itransformer --features MS --log_path log --trainset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv --validset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv --testset_csv_path /workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv --datetime_col dtime --feature_cols 1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶ --target_cols 1ÊïàÂá∫ÊñôÊ∏©Â∫¶ --seq_len 30 --label_len 2 --pred_len 30 --timestamp_feature none --train_epochs 50 --gpu 0 --use_nni --checkpoints ./checkpoints/halfreg/itransformer --hidden_dim 128 --d_model 128 --e_layers 1 --d_layers 1
model_id: alumina_itransformer/STANDALONE
Args in experiment:
Namespace(use_nni=True, stage='train_only', model_id='alumina_itransformer/STANDALONE', log_path='log', checkpoints='./checkpoints/halfreg/itransformer', key=None, task_name='Forecast', features='MS', embed='timeF', freq='h', trainset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_trainset.csv', validset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_validset.csv', testset_csv_path='/workspace/qiuyunzhong/TSFrameworkData/alumina_testset_new.csv', datetime_col='dtime', feature_cols='1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶', target_cols='1ÊïàÂá∫ÊñôÊ∏©Â∫¶', timestamp_feature='none', random_features=False, random_features_num=10, seq_len=30, label_len=2, pred_len=30, interval=900, model_name='alumina_itransformer', d_model=128, n_heads=8, e_layers=1, d_layers=1, d_ff=512, hidden_dim=128, factor=1, dropout=0.05, activation='gelu', output_attention=False, optimizer='Adam', fix_seed=-1, num_workers=10, train_epochs=50, batch_size=64, patience=7, lr=0.0001, gpu=0, label_loss_rate=0.5, reg_loss_rate=0.5, use_norm=1, patch_len=16, target_num=1, use_gpu=True, hpo='nni')
Performing MS Forecasting (TimeXer)
Use GPU... cuda:0
2024-03-11 23:22:20.380198: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2024-03-11 23:22:20.380509: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2024-03-11 23:22:20.382731: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2024-03-11 23:22:20.393270: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-03-11 23:22:21.996268: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
Adjusting learning rate of group 0 to 1.0000e-04.
>>>>>>>start training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
Feature Columns:  1ÊïàËí∏ÂèëÂô®Ê±ΩÊ∏©,1ÊïàËí∏ÂèëÂô®Ê±ΩÂÆ§ÂéãÂäõ,1ÊïàÂéüÊ∂≤Êç¢ÁÉ≠ÂâçÊ∏©Â∫¶,1ÊïàÂá∫ÊñôÊ∏©Â∫¶
	iters: 382, epoch: 1 | train_loss : 1.1963
	speed: 0.063998s/iter; left time: 6090.593483s
	iters: 764, epoch: 1 | train_loss : 0.6881
	speed: 0.050817s/iter; left time: 4816.815559s
	iters: 1146, epoch: 1 | train_loss : 0.9573
	speed: 0.052348s/iter; left time: 4941.943187s
	iters: 1528, epoch: 1 | train_loss : 1.1096
	speed: 0.050439s/iter; left time: 4742.442130s
	iters: 1910, epoch: 1 | train_loss : 0.9719
	speed: 0.049112s/iter; left time: 4598.904076s
data: {'predict': array([149.29078118, 149.29332868, 149.29926745, ..., 149.0282777 ,
       149.02084828, 149.02471776]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:28:19] [32mIntermediate result: 0.48496854305267334  (Index 0)[0m
Epoch: 1 | cost time: 348.7292945384979 | valid_loss: 0.48496854305267334 | valid_loss_true: 0.4857259936166006
Pretest loss in this epoch: 13.553297469695384
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-0.pth
Adjusting learning rate of group 0 to 8.5000e-05.
	iters: 382, epoch: 2 | train_loss : 0.8487
	speed: 0.711267s/iter; left time: 66331.350700s
	iters: 764, epoch: 2 | train_loss : 1.0214
	speed: 0.055212s/iter; left time: 5127.879128s
	iters: 1146, epoch: 2 | train_loss : 0.8795
	speed: 0.055038s/iter; left time: 5090.642021s
	iters: 1528, epoch: 2 | train_loss : 1.3290
	speed: 0.054806s/iter; left time: 5048.317260s
	iters: 1910, epoch: 2 | train_loss : 1.0802
	speed: 0.054213s/iter; left time: 4972.947747s
data: {'predict': array([149.30486117, 149.30118058, 149.29519818, ..., 149.03174029,
       149.01822893, 149.02644686]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:34:36] [32mIntermediate result: 0.48268336057662964  (Index 1)[0m
Epoch: 2 | cost time: 376.3306164741516 | valid_loss: 0.48268336057662964 | valid_loss_true: 0.4838093877487626
Pretest loss in this epoch: 13.56068202657866
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-1.pth
Adjusting learning rate of group 0 to 7.2250e-05.
	iters: 382, epoch: 3 | train_loss : 1.0029
	speed: 0.763750s/iter; left time: 69766.282039s
	iters: 764, epoch: 3 | train_loss : 2.2979
	speed: 0.051376s/iter; left time: 4673.411833s
	iters: 1146, epoch: 3 | train_loss : 1.1246
	speed: 0.055118s/iter; left time: 4992.729682s
	iters: 1528, epoch: 3 | train_loss : 0.9374
	speed: 0.050364s/iter; left time: 4542.879731s
	iters: 1910, epoch: 3 | train_loss : 0.7930
	speed: 0.052057s/iter; left time: 4675.748862s
data: {'predict': array([149.28163377, 149.28325448, 149.28461865, ..., 149.0227852 ,
       149.01100076, 149.01749746]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:40:49] [32mIntermediate result: 0.4765831232070923  (Index 2)[0m
Epoch: 3 | cost time: 373.05833315849304 | valid_loss: 0.4765831232070923 | valid_loss_true: 0.4770839920109894
Pretest loss in this epoch: 13.566765733492007
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-2.pth
Adjusting learning rate of group 0 to 6.1413e-05.
	iters: 382, epoch: 4 | train_loss : 0.9446
	speed: 0.769253s/iter; left time: 68798.942839s
	iters: 764, epoch: 4 | train_loss : 0.6320
	speed: 0.054827s/iter; left time: 4882.543523s
	iters: 1146, epoch: 4 | train_loss : 1.0587
	speed: 0.054946s/iter; left time: 4872.142937s
	iters: 1528, epoch: 4 | train_loss : 0.5838
	speed: 0.055454s/iter; left time: 4896.011464s
	iters: 1910, epoch: 4 | train_loss : 0.8908
	speed: 0.055726s/iter; left time: 4898.775541s
data: {'predict': array([149.32552496, 149.32289008, 149.29600898, ..., 149.0298811 ,
       149.00874294, 149.02202643]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:46:44] [32mIntermediate result: 0.4663545787334442  (Index 3)[0m
Epoch: 4 | cost time: 355.04841899871826 | valid_loss: 0.4663545787334442 | valid_loss_true: 0.46621544219425626
Pretest loss in this epoch: 13.569769116480538
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-3.pth
Adjusting learning rate of group 0 to 5.2201e-05.
	iters: 382, epoch: 5 | train_loss : 0.9247
	speed: 0.703979s/iter; left time: 61615.764575s
	iters: 764, epoch: 5 | train_loss : 0.6211
	speed: 0.060495s/iter; left time: 5271.697857s
	iters: 1146, epoch: 5 | train_loss : 0.7084
	speed: 0.058091s/iter; left time: 5040.006565s
	iters: 1528, epoch: 5 | train_loss : 1.2191
	speed: 0.053002s/iter; left time: 4578.288319s
	iters: 1910, epoch: 5 | train_loss : 0.8299
	speed: 0.054728s/iter; left time: 4706.458840s
data: {'predict': array([149.27987919, 149.28710614, 149.26335666, ..., 149.01495759,
       148.99206109, 148.99838594]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:52:38] [32mIntermediate result: 0.44744330644607544  (Index 4)[0m
Epoch: 5 | cost time: 353.85186100006104 | valid_loss: 0.44744330644607544 | valid_loss_true: 0.4469920865359392
Pretest loss in this epoch: 13.577209917603195
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-4.pth
Adjusting learning rate of group 0 to 4.4371e-05.
	iters: 382, epoch: 6 | train_loss : 0.6842
	speed: 0.704227s/iter; left time: 60291.660188s
	iters: 764, epoch: 6 | train_loss : 1.4357
	speed: 0.055918s/iter; left time: 4766.009158s
	iters: 1146, epoch: 6 | train_loss : 0.7963
	speed: 0.055346s/iter; left time: 4696.070734s
	iters: 1528, epoch: 6 | train_loss : 0.7912
	speed: 0.057332s/iter; left time: 4842.696300s
	iters: 1910, epoch: 6 | train_loss : 0.8730
	speed: 0.056497s/iter; left time: 4750.610754s
data: {'predict': array([149.26234732, 149.28468178, 149.25025825, ..., 149.01354284,
       148.98353338, 148.98900413]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-11 23:59:01] [32mIntermediate result: 0.43709543347358704  (Index 5)[0m
Epoch: 6 | cost time: 382.8327579498291 | valid_loss: 0.43709543347358704 | valid_loss_true: 0.43628697608436556
Pretest loss in this epoch: 13.587429696235645
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-5.pth
Adjusting learning rate of group 0 to 3.7715e-05.
	iters: 382, epoch: 7 | train_loss : 0.9351
	speed: 0.777825s/iter; left time: 65106.268873s
	iters: 764, epoch: 7 | train_loss : 0.8881
	speed: 0.054554s/iter; left time: 4545.492010s
	iters: 1146, epoch: 7 | train_loss : 0.7947
	speed: 0.053632s/iter; left time: 4448.164341s
	iters: 1528, epoch: 7 | train_loss : 0.9964
	speed: 0.052981s/iter; left time: 4373.961201s
	iters: 1910, epoch: 7 | train_loss : 0.6160
	speed: 0.056213s/iter; left time: 4619.300356s
data: {'predict': array([149.20437441, 149.22720633, 149.22557221, ..., 149.00486548,
       148.97851575, 148.98897902]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:04:29] [32mIntermediate result: 0.420875608921051  (Index 6)[0m
Epoch: 7 | cost time: 328.905326128006 | valid_loss: 0.420875608921051 | valid_loss_true: 0.4199426626544301
Pretest loss in this epoch: 13.585328103715486
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-6.pth
Adjusting learning rate of group 0 to 3.2058e-05.
	iters: 382, epoch: 8 | train_loss : 0.9895
	speed: 0.650939s/iter; left time: 53241.589382s
	iters: 764, epoch: 8 | train_loss : 0.7929
	speed: 0.064265s/iter; left time: 5231.801781s
	iters: 1146, epoch: 8 | train_loss : 0.9709
	speed: 0.055558s/iter; left time: 4501.731923s
	iters: 1528, epoch: 8 | train_loss : 1.1375
	speed: 0.054850s/iter; left time: 4423.455377s
	iters: 1910, epoch: 8 | train_loss : 0.8365
	speed: 0.056275s/iter; left time: 4516.833516s
data: {'predict': array([149.1703373 , 149.18790124, 149.19347591, ..., 148.98163175,
       148.96240493, 148.96816916]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:10:08] [32mIntermediate result: 0.4168955981731415  (Index 7)[0m
Epoch: 8 | cost time: 338.3255355358124 | valid_loss: 0.4168955981731415 | valid_loss_true: 0.41593902336242594
Pretest loss in this epoch: 13.591396584127885
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-7.pth
Adjusting learning rate of group 0 to 2.7249e-05.
	iters: 382, epoch: 9 | train_loss : 1.1938
	speed: 0.644091s/iter; left time: 51450.649732s
	iters: 764, epoch: 9 | train_loss : 0.8685
	speed: 0.060434s/iter; left time: 4804.479137s
	iters: 1146, epoch: 9 | train_loss : 1.2679
	speed: 0.061530s/iter; left time: 4868.064783s
	iters: 1528, epoch: 9 | train_loss : 0.9142
	speed: 0.060525s/iter; left time: 4765.447308s
	iters: 1910, epoch: 9 | train_loss : 0.6716
	speed: 0.060642s/iter; left time: 4751.517906s
data: {'predict': array([149.19020925, 149.2247524 , 149.22308058, ..., 148.99568489,
       148.97034858, 148.98487047]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:15:32] [32mIntermediate result: 0.41436266899108887  (Index 8)[0m
Epoch: 9 | cost time: 324.431423664093 | valid_loss: 0.41436266899108887 | valid_loss_true: 0.41352866062648724
Pretest loss in this epoch: 13.598110485740934
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-8.pth
Adjusting learning rate of group 0 to 2.3162e-05.
	iters: 382, epoch: 10 | train_loss : 1.0520
	speed: 0.604752s/iter; left time: 47152.512084s
	iters: 764, epoch: 10 | train_loss : 0.9571
	speed: 0.054614s/iter; left time: 4237.408294s
	iters: 1146, epoch: 10 | train_loss : 0.5850
	speed: 0.060331s/iter; left time: 4657.916638s
	iters: 1528, epoch: 10 | train_loss : 0.8686
	speed: 0.053429s/iter; left time: 4104.621684s
	iters: 1910, epoch: 10 | train_loss : 0.6397
	speed: 0.053650s/iter; left time: 4101.078927s
data: {'predict': array([149.18603812, 149.21766279, 149.2014157 , ..., 148.98230086,
       148.95551097, 148.96065857]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:21:09] [32mIntermediate result: 0.40424835681915283  (Index 9)[0m
Epoch: 10 | cost time: 336.50865721702576 | valid_loss: 0.40424835681915283 | valid_loss_true: 0.4034180598127486
Pretest loss in this epoch: 13.594305816925871
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-9.pth
Adjusting learning rate of group 0 to 1.9687e-05.
	iters: 382, epoch: 11 | train_loss : 1.1522
	speed: 0.665755s/iter; left time: 50636.631664s
	iters: 764, epoch: 11 | train_loss : 0.1871
	speed: 0.058148s/iter; left time: 4400.472450s
	iters: 1146, epoch: 11 | train_loss : 0.7493
	speed: 0.057842s/iter; left time: 4355.197740s
	iters: 1528, epoch: 11 | train_loss : 1.3371
	speed: 0.056936s/iter; left time: 4265.234040s
	iters: 1910, epoch: 11 | train_loss : 1.2169
	speed: 0.058072s/iter; left time: 4328.200954s
data: {'predict': array([149.18215088, 149.22292695, 149.20809744, ..., 148.98527032,
       148.95608565, 148.96431727]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:27:15] [32mIntermediate result: 0.40473464131355286  (Index 10)[0m
Epoch: 11 | cost time: 366.36746859550476 | valid_loss: 0.40473464131355286 | valid_loss_true: 0.40383039938339843
Pretest loss in this epoch: 13.600256731129596
Adjusting learning rate of group 0 to 1.6734e-05.
	iters: 382, epoch: 12 | train_loss : 0.7586
	speed: 0.725393s/iter; left time: 53786.413421s
	iters: 764, epoch: 12 | train_loss : 0.9545
	speed: 0.055507s/iter; left time: 4094.548438s
	iters: 1146, epoch: 12 | train_loss : 0.9928
	speed: 0.054193s/iter; left time: 3976.929471s
	iters: 1528, epoch: 12 | train_loss : 1.0704
	speed: 0.053431s/iter; left time: 3900.537176s
	iters: 1910, epoch: 12 | train_loss : 1.0987
	speed: 0.062435s/iter; left time: 4534.051572s
data: {'predict': array([149.11787925, 149.14760653, 149.16178057, ..., 148.96899594,
       148.94569526, 148.9508735 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:32:49] [32mIntermediate result: 0.3990875482559204  (Index 11)[0m
Epoch: 12 | cost time: 334.2266626358032 | valid_loss: 0.3990875482559204 | valid_loss_true: 0.398202902899133
Pretest loss in this epoch: 13.604857705992885
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-11.pth
Adjusting learning rate of group 0 to 1.4224e-05.
	iters: 382, epoch: 13 | train_loss : 1.0246
	speed: 0.655547s/iter; left time: 47354.752993s
	iters: 764, epoch: 13 | train_loss : 0.6382
	speed: 0.055142s/iter; left time: 3962.262859s
	iters: 1146, epoch: 13 | train_loss : 0.7552
	speed: 0.054850s/iter; left time: 3920.262225s
	iters: 1528, epoch: 13 | train_loss : 0.8451
	speed: 0.054169s/iter; left time: 3850.943785s
	iters: 1910, epoch: 13 | train_loss : 0.5673
	speed: 0.051585s/iter; left time: 3647.551054s
data: {'predict': array([149.13202889, 149.16555084, 149.16964842, ..., 148.97547507,
       148.94588659, 148.94913934]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:38:33] [32mIntermediate result: 0.3889547288417816  (Index 12)[0m
Epoch: 13 | cost time: 343.79732966423035 | valid_loss: 0.3889547288417816 | valid_loss_true: 0.3878282279408931
Pretest loss in this epoch: 13.59876401675193
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-12.pth
Adjusting learning rate of group 0 to 1.2091e-05.
	iters: 382, epoch: 14 | train_loss : 1.2417
	speed: 0.677617s/iter; left time: 47654.085814s
	iters: 764, epoch: 14 | train_loss : 0.4276
	speed: 0.057234s/iter; left time: 4003.173074s
	iters: 1146, epoch: 14 | train_loss : 1.0138
	speed: 0.057523s/iter; left time: 4001.442994s
	iters: 1528, epoch: 14 | train_loss : 0.9364
	speed: 0.059381s/iter; left time: 4107.950035s
	iters: 1910, epoch: 14 | train_loss : 0.6301
	speed: 0.060084s/iter; left time: 4133.651152s
data: {'predict': array([149.14018289, 149.17734436, 149.17695222, ..., 148.9775205 ,
       148.94680385, 148.95422555]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:43:53] [32mIntermediate result: 0.3926372826099396  (Index 13)[0m
Epoch: 14 | cost time: 320.15271973609924 | valid_loss: 0.3926372826099396 | valid_loss_true: 0.3915955047993401
Pretest loss in this epoch: 13.603974929260875
Adjusting learning rate of group 0 to 1.0277e-05.
	iters: 382, epoch: 15 | train_loss : 0.9963
	speed: 0.603876s/iter; left time: 41314.189242s
	iters: 764, epoch: 15 | train_loss : 0.8886
	speed: 0.053036s/iter; left time: 3608.215221s
	iters: 1146, epoch: 15 | train_loss : 0.9954
	speed: 0.060333s/iter; left time: 4081.573625s
	iters: 1528, epoch: 15 | train_loss : 0.8068
	speed: 0.057566s/iter; left time: 3872.410061s
	iters: 1910, epoch: 15 | train_loss : 0.8138
	speed: 0.055608s/iter; left time: 3719.434499s
data: {'predict': array([149.12512312, 149.16114042, 149.16667209, ..., 148.97231925,
       148.94609266, 148.95563427]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:48:56] [32mIntermediate result: 0.3837467432022095  (Index 14)[0m
Epoch: 15 | cost time: 302.7482349872589 | valid_loss: 0.3837467432022095 | valid_loss_true: 0.3826485055416461
Pretest loss in this epoch: 13.600433207458034
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-14.pth
Adjusting learning rate of group 0 to 8.7354e-06.
	iters: 382, epoch: 16 | train_loss : 0.6365
	speed: 0.574205s/iter; left time: 38186.924322s
	iters: 764, epoch: 16 | train_loss : 0.7772
	speed: 0.062473s/iter; left time: 4130.827451s
	iters: 1146, epoch: 16 | train_loss : 0.8284
	speed: 0.061709s/iter; left time: 4056.722386s
	iters: 1528, epoch: 16 | train_loss : 0.6135
	speed: 0.063347s/iter; left time: 4140.243675s
	iters: 1910, epoch: 16 | train_loss : 0.8509
	speed: 0.063220s/iter; left time: 4107.755534s
data: {'predict': array([149.12333614, 149.15573023, 149.15597577, ..., 148.97005721,
       148.9422617 , 148.95169149]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:54:26] [32mIntermediate result: 0.38646259903907776  (Index 15)[0m
Epoch: 16 | cost time: 329.6774308681488 | valid_loss: 0.38646259903907776 | valid_loss_true: 0.3853647631736123
Pretest loss in this epoch: 13.60629852948638
Adjusting learning rate of group 0 to 7.4251e-06.
	iters: 382, epoch: 17 | train_loss : 1.1874
	speed: 0.602618s/iter; left time: 38924.908362s
	iters: 764, epoch: 17 | train_loss : 1.2033
	speed: 0.054817s/iter; left time: 3519.852943s
	iters: 1146, epoch: 17 | train_loss : 0.5027
	speed: 0.056221s/iter; left time: 3588.530579s
	iters: 1528, epoch: 17 | train_loss : 0.9258
	speed: 0.053290s/iter; left time: 3381.089371s
	iters: 1910, epoch: 17 | train_loss : 0.8628
	speed: 0.061642s/iter; left time: 3887.439871s
data: {'predict': array([149.11121807, 149.14249317, 149.14760909, ..., 148.96440546,
       148.93819658, 148.94628079]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 00:59:37] [32mIntermediate result: 0.38762006163597107  (Index 16)[0m
Epoch: 17 | cost time: 310.8022954463959 | valid_loss: 0.38762006163597107 | valid_loss_true: 0.3865863530807198
Pretest loss in this epoch: 13.610478543086883
Adjusting learning rate of group 0 to 6.3113e-06.
	iters: 382, epoch: 18 | train_loss : 1.2507
	speed: 0.599520s/iter; left time: 37579.121395s
	iters: 764, epoch: 18 | train_loss : 0.6711
	speed: 0.060092s/iter; left time: 3743.744381s
	iters: 1146, epoch: 18 | train_loss : 0.6408
	speed: 0.055789s/iter; left time: 3454.324834s
	iters: 1528, epoch: 18 | train_loss : 1.0812
	speed: 0.055004s/iter; left time: 3384.714740s
	iters: 1910, epoch: 18 | train_loss : 0.9902
	speed: 0.054751s/iter; left time: 3348.257378s
data: {'predict': array([149.13267089, 149.17103509, 149.16451208, ..., 148.97253049,
       148.9425743 , 148.9537845 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:04:57] [32mIntermediate result: 0.3857685625553131  (Index 17)[0m
Epoch: 18 | cost time: 320.1755404472351 | valid_loss: 0.3857685625553131 | valid_loss_true: 0.3847556621581533
Pretest loss in this epoch: 13.609109953072794
Adjusting learning rate of group 0 to 5.3646e-06.
	iters: 382, epoch: 19 | train_loss : 1.3089
	speed: 0.608503s/iter; left time: 36979.322630s
	iters: 764, epoch: 19 | train_loss : 0.7769
	speed: 0.059299s/iter; left time: 3581.009099s
	iters: 1146, epoch: 19 | train_loss : 1.1293
	speed: 0.059817s/iter; left time: 3589.435885s
	iters: 1528, epoch: 19 | train_loss : 0.8970
	speed: 0.060196s/iter; left time: 3589.161693s
	iters: 1910, epoch: 19 | train_loss : 0.9252
	speed: 0.057765s/iter; left time: 3422.150089s
data: {'predict': array([149.10944382, 149.14351929, 149.14799712, ..., 148.9649472 ,
       148.9384746 , 148.94826423]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:10:04] [32mIntermediate result: 0.38362523913383484  (Index 18)[0m
Epoch: 19 | cost time: 307.203608751297 | valid_loss: 0.38362523913383484 | valid_loss_true: 0.38268061485619076
Pretest loss in this epoch: 13.609635945358082
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-18.pth
Adjusting learning rate of group 0 to 4.5599e-06.
	iters: 382, epoch: 20 | train_loss : 2.3893
	speed: 0.559552s/iter; left time: 32935.229939s
	iters: 764, epoch: 20 | train_loss : 0.7421
	speed: 0.061699s/iter; left time: 3608.058230s
	iters: 1146, epoch: 20 | train_loss : 1.2174
	speed: 0.055678s/iter; left time: 3234.680256s
	iters: 1528, epoch: 20 | train_loss : 1.0706
	speed: 0.057128s/iter; left time: 3297.085573s
	iters: 1910, epoch: 20 | train_loss : 1.0295
	speed: 0.053850s/iter; left time: 3087.350983s
data: {'predict': array([149.11024685, 149.14429943, 149.14648456, ..., 148.96416909,
       148.93643383, 148.94433256]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:15:05] [32mIntermediate result: 0.38163235783576965  (Index 19)[0m
Epoch: 20 | cost time: 301.3113751411438 | valid_loss: 0.38163235783576965 | valid_loss_true: 0.3806826791574415
Pretest loss in this epoch: 13.610810882201854
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-19.pth
Adjusting learning rate of group 0 to 3.8760e-06.
	iters: 382, epoch: 21 | train_loss : 0.9037
	speed: 0.567381s/iter; left time: 32311.785546s
	iters: 764, epoch: 21 | train_loss : 0.6677
	speed: 0.062090s/iter; left time: 3512.226491s
	iters: 1146, epoch: 21 | train_loss : 0.4321
	speed: 0.059811s/iter; left time: 3360.506132s
	iters: 1528, epoch: 21 | train_loss : 1.1363
	speed: 0.059825s/iter; left time: 3338.407389s
	iters: 1910, epoch: 21 | train_loss : 0.5267
	speed: 0.061920s/iter; left time: 3431.679008s
data: {'predict': array([149.10294158, 149.13588051, 149.13916797, ..., 148.96035836,
       148.93345372, 148.9402538 ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:20:35] [32mIntermediate result: 0.3791499435901642  (Index 20)[0m
Epoch: 21 | cost time: 330.1454539299011 | valid_loss: 0.3791499435901642 | valid_loss_true: 0.37823080448344415
Pretest loss in this epoch: 13.609459198140884
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-20.pth
Adjusting learning rate of group 0 to 3.2946e-06.
	iters: 382, epoch: 22 | train_loss : 0.6105
	speed: 0.617652s/iter; left time: 33994.319333s
	iters: 764, epoch: 22 | train_loss : 0.7481
	speed: 0.056506s/iter; left time: 3088.389972s
	iters: 1146, epoch: 22 | train_loss : 0.6549
	speed: 0.063873s/iter; left time: 3466.657269s
	iters: 1528, epoch: 22 | train_loss : 0.6483
	speed: 0.055279s/iter; left time: 2979.084850s
	iters: 1910, epoch: 22 | train_loss : 0.8074
	speed: 0.061147s/iter; left time: 3271.996351s
data: {'predict': array([149.10441051, 149.13852326, 149.14001579, ..., 148.96271891,
       148.93405227, 148.94123586]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:25:44] [32mIntermediate result: 0.378962904214859  (Index 21)[0m
Epoch: 22 | cost time: 308.95732283592224 | valid_loss: 0.378962904214859 | valid_loss_true: 0.3780653310410053
Pretest loss in this epoch: 13.609685861014995
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-21.pth
Adjusting learning rate of group 0 to 2.8004e-06.
	iters: 382, epoch: 23 | train_loss : 0.6532
	speed: 0.572808s/iter; left time: 30431.564869s
	iters: 764, epoch: 23 | train_loss : 0.7296
	speed: 0.056532s/iter; left time: 2981.777068s
	iters: 1146, epoch: 23 | train_loss : 0.8021
	speed: 0.056665s/iter; left time: 2967.142950s
	iters: 1528, epoch: 23 | train_loss : 1.2449
	speed: 0.057624s/iter; left time: 2995.377861s
	iters: 1910, epoch: 23 | train_loss : 0.6701
	speed: 0.057473s/iter; left time: 2965.552280s
data: {'predict': array([149.10337306, 149.13711421, 149.13989509, ..., 148.96244747,
       148.93419575, 148.94220894]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:30:57] [32mIntermediate result: 0.377951443195343  (Index 22)[0m
Epoch: 23 | cost time: 312.998868227005 | valid_loss: 0.377951443195343 | valid_loss_true: 0.37704392196990816
Pretest loss in this epoch: 13.60973821012902
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-22.pth
Adjusting learning rate of group 0 to 2.3803e-06.
	iters: 382, epoch: 24 | train_loss : 0.4073
	speed: 0.580230s/iter; left time: 29717.047060s
	iters: 764, epoch: 24 | train_loss : 1.0730
	speed: 0.048052s/iter; left time: 2442.675628s
	iters: 1146, epoch: 24 | train_loss : 0.9615
	speed: 0.047283s/iter; left time: 2385.516140s
	iters: 1528, epoch: 24 | train_loss : 1.1266
	speed: 0.046938s/iter; left time: 2350.163656s
	iters: 1910, epoch: 24 | train_loss : 0.9549
	speed: 0.047730s/iter; left time: 2371.587722s
data: {'predict': array([149.09001691, 149.1221752 , 149.13260178, ..., 148.95987878,
       148.93296123, 148.94112664]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:35:44] [32mIntermediate result: 0.37614646553993225  (Index 23)[0m
Epoch: 24 | cost time: 286.3250250816345 | valid_loss: 0.37614646553993225 | valid_loss_true: 0.3752599979993788
Pretest loss in this epoch: 13.610386175057455
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-23.pth
Adjusting learning rate of group 0 to 2.0233e-06.
	iters: 382, epoch: 25 | train_loss : 1.1439
	speed: 0.557827s/iter; left time: 27503.668185s
	iters: 764, epoch: 25 | train_loss : 0.8573
	speed: 0.045175s/iter; left time: 2210.084495s
	iters: 1146, epoch: 25 | train_loss : 0.7130
	speed: 0.046324s/iter; left time: 2248.609451s
	iters: 1528, epoch: 25 | train_loss : 0.9062
	speed: 0.044535s/iter; left time: 2144.769285s
	iters: 1910, epoch: 25 | train_loss : 0.7896
	speed: 0.046202s/iter; left time: 2207.390295s
data: {'predict': array([149.09467054, 149.12787912, 149.13536916, ..., 148.96097661,
       148.93300397, 148.94099028]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:40:21] [32mIntermediate result: 0.376486212015152  (Index 24)[0m
Epoch: 25 | cost time: 277.5110638141632 | valid_loss: 0.376486212015152 | valid_loss_true: 0.3755937515283371
Pretest loss in this epoch: 13.610563402898538
Adjusting learning rate of group 0 to 1.7198e-06.
	iters: 382, epoch: 26 | train_loss : 1.0531
	speed: 0.545383s/iter; left time: 25847.895994s
	iters: 764, epoch: 26 | train_loss : 0.7551
	speed: 0.048385s/iter; left time: 2274.691892s
	iters: 1146, epoch: 26 | train_loss : 0.8600
	speed: 0.045174s/iter; left time: 2106.443400s
	iters: 1528, epoch: 26 | train_loss : 0.8229
	speed: 0.043367s/iter; left time: 2005.639361s
	iters: 1910, epoch: 26 | train_loss : 0.6897
	speed: 0.047023s/iter; left time: 2156.740253s
data: {'predict': array([149.09209413, 149.12637148, 149.13543413, ..., 148.96147875,
       148.93351687, 148.94212154]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:45:25] [32mIntermediate result: 0.376535028219223  (Index 25)[0m
Epoch: 26 | cost time: 303.73525047302246 | valid_loss: 0.376535028219223 | valid_loss_true: 0.37566184242629
Pretest loss in this epoch: 13.611543566464826
Adjusting learning rate of group 0 to 1.4618e-06.
	iters: 382, epoch: 27 | train_loss : 0.6026
	speed: 0.609879s/iter; left time: 27739.126984s
	iters: 764, epoch: 27 | train_loss : 1.1415
	speed: 0.040682s/iter; left time: 1834.785287s
	iters: 1146, epoch: 27 | train_loss : 0.6657
	speed: 0.044878s/iter; left time: 2006.898796s
	iters: 1528, epoch: 27 | train_loss : 0.6311
	speed: 0.048186s/iter; left time: 2136.426090s
	iters: 1910, epoch: 27 | train_loss : 1.0184
	speed: 0.047672s/iter; left time: 2095.413360s
data: {'predict': array([149.09475295, 149.12937538, 149.13678525, ..., 148.96226382,
       148.9333465 , 148.941254  ]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:50:07] [32mIntermediate result: 0.3761221766471863  (Index 26)[0m
Epoch: 27 | cost time: 281.55737805366516 | valid_loss: 0.3761221766471863 | valid_loss_true: 0.37524388546953835
Pretest loss in this epoch: 13.612144021486793
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-26.pth
Adjusting learning rate of group 0 to 1.2425e-06.
	iters: 382, epoch: 28 | train_loss : 0.7857
	speed: 0.554513s/iter; left time: 24161.262222s
	iters: 764, epoch: 28 | train_loss : 0.9715
	speed: 0.045902s/iter; left time: 1982.525416s
	iters: 1146, epoch: 28 | train_loss : 0.7243
	speed: 0.041106s/iter; left time: 1759.644835s
	iters: 1528, epoch: 28 | train_loss : 1.1737
	speed: 0.043096s/iter; left time: 1828.377153s
	iters: 1910, epoch: 28 | train_loss : 1.0563
	speed: 0.045271s/iter; left time: 1903.393198s
data: {'predict': array([149.09303189, 149.12794296, 149.13533137, ..., 148.96207328,
       148.9329446 , 148.94091604]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:54:56] [32mIntermediate result: 0.37481600046157837  (Index 27)[0m
Epoch: 28 | cost time: 289.5787329673767 | valid_loss: 0.37481600046157837 | valid_loss_true: 0.3739560668773311
Pretest loss in this epoch: 13.611299733593587
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-27.pth
Adjusting learning rate of group 0 to 1.0562e-06.
	iters: 382, epoch: 29 | train_loss : 0.9742
	speed: 0.586426s/iter; left time: 24431.113309s
	iters: 764, epoch: 29 | train_loss : 1.2769
	speed: 0.048264s/iter; left time: 1992.304720s
	iters: 1146, epoch: 29 | train_loss : 1.5726
	speed: 0.048374s/iter; left time: 1978.362608s
	iters: 1528, epoch: 29 | train_loss : 0.8690
	speed: 0.047927s/iter; left time: 1941.759755s
	iters: 1910, epoch: 29 | train_loss : 1.2248
	speed: 0.048514s/iter; left time: 1947.011477s
data: {'predict': array([149.09301476, 149.12742315, 149.1347344 , ..., 148.96188212,
       148.93311782, 148.94148157]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 01:59:55] [32mIntermediate result: 0.3736884295940399  (Index 28)[0m
Epoch: 29 | cost time: 299.1027820110321 | valid_loss: 0.3736884295940399 | valid_loss_true: 0.37282779057170257
Pretest loss in this epoch: 13.610153970695883
Chepoint Saved at:  ./checkpoints/halfreg/itransformer/alumina_itransformer/STANDALONE/checkpoint-28.pth
Adjusting learning rate of group 0 to 8.9774e-07.
	iters: 382, epoch: 30 | train_loss : 0.7700
	speed: 0.582608s/iter; left time: 23158.683760s
	iters: 764, epoch: 30 | train_loss : 0.9630
	speed: 0.040788s/iter; left time: 1605.747421s
	iters: 1146, epoch: 30 | train_loss : 0.5024
	speed: 0.047502s/iter; left time: 1851.908360s
	iters: 1528, epoch: 30 | train_loss : 0.7626
	speed: 0.042264s/iter; left time: 1631.575706s
	iters: 1910, epoch: 30 | train_loss : 0.8141
	speed: 0.043654s/iter; left time: 1668.557094s
data: {'predict': array([149.08886636, 149.12267593, 149.13158134, ..., 148.96051677,
       148.93214391, 148.94032947]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:04:40] [32mIntermediate result: 0.3741415739059448  (Index 29)[0m
Epoch: 30 | cost time: 284.5123291015625 | valid_loss: 0.3741415739059448 | valid_loss_true: 0.3732895888253413
Pretest loss in this epoch: 13.611337475888943
Adjusting learning rate of group 0 to 7.6308e-07.
	iters: 382, epoch: 31 | train_loss : 0.5048
	speed: 0.575312s/iter; left time: 21769.217412s
	iters: 764, epoch: 31 | train_loss : 0.8128
	speed: 0.045703s/iter; left time: 1711.897848s
	iters: 1146, epoch: 31 | train_loss : 0.5858
	speed: 0.046432s/iter; left time: 1721.468698s
	iters: 1528, epoch: 31 | train_loss : 0.9913
	speed: 0.046287s/iter; left time: 1698.401718s
	iters: 1910, epoch: 31 | train_loss : 0.9588
	speed: 0.044578s/iter; left time: 1618.671482s
data: {'predict': array([149.08846388, 149.12292788, 149.13207273, ..., 148.96123601,
       148.93247054, 148.94090463]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:09:48] [32mIntermediate result: 0.37424734234809875  (Index 30)[0m
Epoch: 31 | cost time: 308.45685338974 | valid_loss: 0.37424734234809875 | valid_loss_true: 0.3733966418896996
Pretest loss in this epoch: 13.611737602295452
Adjusting learning rate of group 0 to 6.4861e-07.
	iters: 382, epoch: 32 | train_loss : 0.6333
	speed: 0.622933s/iter; left time: 22380.745688s
	iters: 764, epoch: 32 | train_loss : 1.1920
	speed: 0.043026s/iter; left time: 1529.386015s
	iters: 1146, epoch: 32 | train_loss : 0.5180
	speed: 0.043584s/iter; left time: 1532.594110s
	iters: 1528, epoch: 32 | train_loss : 0.9258
	speed: 0.045549s/iter; left time: 1584.278267s
	iters: 1910, epoch: 32 | train_loss : 0.6205
	speed: 0.043292s/iter; left time: 1489.248129s
data: {'predict': array([149.08821134, 149.12279407, 149.13192425, ..., 148.96149337,
       148.93252064, 148.94103444]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:14:30] [32mIntermediate result: 0.373746395111084  (Index 31)[0m
Epoch: 32 | cost time: 282.1162383556366 | valid_loss: 0.373746395111084 | valid_loss_true: 0.37289269063876884
Pretest loss in this epoch: 13.611432459950027
Adjusting learning rate of group 0 to 5.5132e-07.
	iters: 382, epoch: 33 | train_loss : 0.8858
	speed: 0.564009s/iter; left time: 19185.879181s
	iters: 764, epoch: 33 | train_loss : 0.8221
	speed: 0.045394s/iter; left time: 1526.840876s
	iters: 1146, epoch: 33 | train_loss : 0.6664
	speed: 0.044611s/iter; left time: 1483.464058s
	iters: 1528, epoch: 33 | train_loss : 0.8407
	speed: 0.045206s/iter; left time: 1485.951102s
	iters: 1910, epoch: 33 | train_loss : 0.8921
	speed: 0.045857s/iter; left time: 1489.831976s
data: {'predict': array([149.08603243, 149.12043283, 149.13049535, ..., 148.96113344,
       148.93209025, 148.94039036]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:19:50] [32mIntermediate result: 0.3740736246109009  (Index 32)[0m
Epoch: 33 | cost time: 319.30534982681274 | valid_loss: 0.3740736246109009 | valid_loss_true: 0.3732252040188504
Pretest loss in this epoch: 13.612174695853097
Adjusting learning rate of group 0 to 4.6862e-07.
	iters: 382, epoch: 34 | train_loss : 0.9714
	speed: 0.649325s/iter; left time: 20847.221579s
	iters: 764, epoch: 34 | train_loss : 0.9094
	speed: 0.041826s/iter; left time: 1326.884948s
	iters: 1146, epoch: 34 | train_loss : 1.0099
	speed: 0.039726s/iter; left time: 1245.105013s
	iters: 1528, epoch: 34 | train_loss : 0.9348
	speed: 0.040949s/iter; left time: 1267.770609s
	iters: 1910, epoch: 34 | train_loss : 0.9692
	speed: 0.042673s/iter; left time: 1304.858711s
data: {'predict': array([149.08577008, 149.12007085, 149.13013319, ..., 148.9608599 ,
       148.9319761 , 148.94039878]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:24:22] [32mIntermediate result: 0.37390920519828796  (Index 33)[0m
Epoch: 34 | cost time: 272.82161688804626 | valid_loss: 0.37390920519828796 | valid_loss_true: 0.3730584162992853
Pretest loss in this epoch: 13.612310833745225
Adjusting learning rate of group 0 to 3.9833e-07.
	iters: 382, epoch: 35 | train_loss : 0.9413
	speed: 0.551579s/iter; left time: 16654.919457s
	iters: 764, epoch: 35 | train_loss : 0.7389
	speed: 0.041918s/iter; left time: 1249.708740s
	iters: 1146, epoch: 35 | train_loss : 1.0532
	speed: 0.041670s/iter; left time: 1226.388201s
	iters: 1528, epoch: 35 | train_loss : 0.6423
	speed: 0.045486s/iter; left time: 1321.333100s
	iters: 1910, epoch: 35 | train_loss : 0.9435
	speed: 0.044370s/iter; left time: 1271.967716s
data: {'predict': array([149.08480717, 149.11897463, 149.12938444, ..., 148.96063034,
       148.93170459, 148.93996812]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:29:33] [32mIntermediate result: 0.3736967444419861  (Index 34)[0m
Epoch: 35 | cost time: 310.3519124984741 | valid_loss: 0.3736967444419861 | valid_loss_true: 0.37284276790546145
Pretest loss in this epoch: 13.612470112564836
Adjusting learning rate of group 0 to 3.3858e-07.
	iters: 382, epoch: 36 | train_loss : 0.8477
	speed: 0.641417s/iter; left time: 18141.834129s
	iters: 764, epoch: 36 | train_loss : 0.6651
	speed: 0.044702s/iter; left time: 1247.286176s
	iters: 1146, epoch: 36 | train_loss : 0.8848
	speed: 0.045982s/iter; left time: 1265.422083s
	iters: 1528, epoch: 36 | train_loss : 0.7023
	speed: 0.045441s/iter; left time: 1233.168498s
	iters: 1910, epoch: 36 | train_loss : 0.8348
	speed: 0.046125s/iter; left time: 1234.132642s
data: {'predict': array([149.08498285, 149.11928365, 149.12967012, ..., 148.96079875,
       148.93168713, 148.93985755]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:34:23] [32mIntermediate result: 0.37370774149894714  (Index 35)[0m
Epoch: 36 | cost time: 290.2998368740082 | valid_loss: 0.37370774149894714 | valid_loss_true: 0.37284994375369995
Pretest loss in this epoch: 13.612593646663445
Adjusting learning rate of group 0 to 2.8779e-07.
	iters: 382, epoch: 37 | train_loss : 1.1182
	speed: 0.572956s/iter; left time: 15110.562161s
	iters: 764, epoch: 37 | train_loss : 1.0059
	speed: 0.046330s/iter; left time: 1204.163649s
	iters: 1146, epoch: 37 | train_loss : 0.7623
	speed: 0.045927s/iter; left time: 1176.142489s
	iters: 1528, epoch: 37 | train_loss : 0.8710
	speed: 0.045117s/iter; left time: 1138.156246s
	iters: 1910, epoch: 37 | train_loss : 0.8653
	speed: 0.044898s/iter; left time: 1115.487385s
data: {'predict': array([149.08466277, 149.11882351, 149.12905691, ..., 148.96053026,
       148.93142936, 148.93952967]), 'groundthuth': array([148.74826   , 148.74826   , 148.74826   , ..., 137.70184276,
       138.71696518, 138.43647812])}
[2024-03-12 02:39:31] [32mIntermediate result: 0.3737545609474182  (Index 36)[0m
Epoch: 37 | cost time: 308.33192777633667 | valid_loss: 0.3737545609474182 | valid_loss_true: 0.3728979445090784
Pretest loss in this epoch: 13.612712971940677
Early stop with best valid_loss: 0.3737545609474182
[2024-03-12 02:39:31] [32mFinal result: 0.3736884295940399[0m
>>>>>>>end of training : alumina_itransformer/STANDALONE>>>>>>>>>>>>>>>>>>>>>>>>>>
